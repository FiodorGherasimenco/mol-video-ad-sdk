{"version":3,"sources":["webpack:///@mailonline/video-ad-sdk/webpack/universalModuleDefinition","webpack:///@mailonline/video-ad-sdk/webpack/bootstrap","webpack:///@mailonline/video-ad-sdk/./dist/main.esm.js","webpack:///@mailonline/video-ad-sdk/./demo/index.js","webpack:///@mailonline/video-ad-sdk/(webpack)/buildin/global.js"],"names":["root","factory","exports","module","define","amd","a","i","window","installedModules","__webpack_require__","moduleId","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","commonjsGlobal","global","self","runtime","undefined","Op","hasOwn","$Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","regeneratorRuntime","wrap","GenStateSuspendedStart","GenStateSuspendedYield","GenStateExecuting","GenStateCompleted","ContinueSentinel","IteratorPrototype","this","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","GeneratorFunctionPrototype","Generator","GeneratorFunction","constructor","displayName","isGeneratorFunction","genFun","ctor","mark","setPrototypeOf","__proto__","awrap","arg","__await","defineIteratorMethods","AsyncIterator","async","innerFn","outerFn","tryLocsList","iter","next","then","result","done","toString","keys","push","reverse","length","pop","Context","reset","skipTempReset","prev","sent","_sent","delegate","method","tryEntries","forEach","resetTryEntry","charAt","isNaN","slice","stop","rootRecord","completion","type","rval","dispatchException","exception","context","handle","loc","caught","record","entry","tryLoc","hasCatch","hasFinally","catchLoc","finallyLoc","Error","abrupt","finallyEntry","complete","afterLoc","finish","catch","thrown","delegateYield","iterable","resultName","nextLoc","protoGenerator","generator","_invoke","state","doneResult","delegateResult","maybeInvokeDelegate","tryCatch","makeInvokeMethod","fn","obj","err","previousPromise","callInvokeWithMethodAndArg","Promise","resolve","reject","invoke","_typeof","unwrapped","return","TypeError","info","pushTryEntry","locs","iteratorMethod","Function","g","hadRuntime","getOwnPropertyNames","indexOf","oldRuntime","runtimeModule","e","_linearTrackers","_linearTrackers$1","namespace","count","regenerator","linearEvents","clickThrough","closeLinear","error","exitFullscreen","firstQuartile","fullscreen","iconClick","iconView","impression","midpoint","mute","otherAdInteraction","pause","playerCollapse","playerExpand","progress","resume","rewind","skip","start","thirdQuartile","timeSpentViewing","unmute","acceptInvitation","adCollapse","creativeView","nonLinearEvents","close","errorMessagePatterns","RegExp","extractParseError","errorNode","node","match","content","XMLSerializer","Array","map","childNodes","serializeToString","join","exec","saneDomparserError","doc","errorMessage","parseError","documentElement","tagName","namespaceURI","nodeName","getParseError","failOnParseError","TYPE","xmlToJson","nodeType","toLowerCase","attributes","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","from","attribute","nodeValue","text","replace","trim","hasChildNodes","filter","childNode","includes","elements","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","childObj","getChildren","_ref$elements","arguments","element","childName","find","_ref2","_ref2$name","toUpperCase","getAll","childrenName","_ref3","_ref3$name","filterChildrenByName","getFirstChild","getText","firstChild","getAttributes","_ref4$attributes","getAttribute","attributeName","parser","DOMParser","parseXml","xmlText","xmlDom","parseFromString","xml2js","parseTime","durationStr","durationInMs","hourStr","parseInt","minStr","secStr","parseOffset","offset","test","isPercentage","getLinearCreative","ad","adTypeElement","creativesElement","creative","getLinearTrackingEvents","eventName","creativeElement","linearElement","trackingEventsElement","trackingEventElements","trackingEvents","trackingEventElement","_getAttributes","event","uri","filteredEvents","_ref","asyncToGenerator","gen","apply","step","classCallCheck","instance","Constructor","createClass","defineProperties","target","props","descriptor","configurable","writable","protoProps","staticProps","_extends","assign","source","get$1","receiver","desc","getOwnPropertyDescriptor","parent","inherits","subClass","superClass","possibleConstructorReturn","ReferenceError","toConsumableArray","arr","isArray","arr2","formatSize","size","formatPosition","position","getIcons","linearCreativeElement","iconsElement","iconElements","iconElement","duration","height","program","pxratio","width","_getAttributes$xPosit","xPosition","_getAttributes$yPosit","yPosition","getIconAttributes","staticResourceElement","htmlResourceElement","iFrameResourceElement","staticResource","htmlResource","iFrameResource","getIconResource","iconTrackingElements","iconViewTrackingElement","iconViewTracking","getIconViewTracking","iconClicksElement","iconClickThroughElement","iconClickTrackingElements","iconClickTrackingElement","iconClickThrough","iconClickTracking","getIconClicks","getBooleanValue","val","Boolean","compareBySequence","itemA","itemB","itemASequence","itemBSequence","getAds","parsedVAST","vastElement","ads","getPodAdSequence","sequence","isPodAd","hasAdPod","isWrapper","getVASTAdTagURI","wrapperElement","vastAdTagURIElement","getMediaFiles","universalAdIdElement","universalAdId","mediaFilesElement","mediaFileElements","mediaFileElement","src","_getAttributes2","apiFramework","bitrate","codec","delivery","id","maintainAspectRatio","maxBitrate","minBitrate","scalable","getInteractiveFiles","interactiveFiles","interactiveElements","interactiveElement","_getAttributes3","getInteractiveCreativeFiles","mediaFiles","_ref2$apiFramework","getVideoClicksElement","videoClicksElement","getClickThrough","clickThroughElement","getCreativeData","xml","linearContent","getLinearContent","AdParameters","getAdParametersContent","xmlEncoded","getXmlEncodedValue","parseMacro","macro","upperKeysMap","data","parsedMacro","macroData","CACHEBUSTING","Math","round","random","TIMESTAMP","Date","toISOString","encodeURIComponent","pixelTracker","URLMacro","img","Image","trackError","vastChain","errorCode","_ref$tracker","tracker","parsedXML","errorURI","getAdErrorURI","getVastErrorURI","createVastEventTracker","vastChainSelector","linearTrackingEventSelector","linearTrackers","trackingURIs","clickTrackings","clickTrackingElements","getClickTracking","customClicks","customClickElements","getCustomClick","progressUri","trackingEventSelector","NonLinearAdsElement","getNonLinearTrackingEvents","linearTrackers$1","loadScript","_ref$async","_ref$defer","defer","_ref$type","placeholder","script","document","createElement","scriptPlaceholder","onerror","URIError","onload","currentScript","parentNode","head","appendChild","createAdVideoElement","video","style","createAdContainer","adContainer","classList","add","getContentDocument","iframeElement","contentDocument","contentWindow","supported","createBaseIframe","iframe","sandbox","margin","padding","border","createIframe","location","targetOrigin","iframeContent","origin","protocol","hostname","port","write","removeChild","srcdoc","addEventListener","handleMessage","removeEventListener","nextId","hidden","VideoAdContainer","videoElement","destroyed","readyPromise","Element","executionContext","isOriginalVideoElement","_callee","options","_context","isDestroyed","body","_x2","createVideoAdContainer","canPlay","mediaFile","canPlayType","ext","3gp","avi","flv","m3u8","m4v","mov","mp4","mpd","ogv","ts","webm","wmv","guessMimeType","findBestMedia","inlineAd","container","screenRect","getBoundingClientRect","screenWidth","sort","mediaFileA","mediaFileB","abs","sortMediaByBestFit","once","listener","handler","progress$1","safeCallback","callback","logger","fullscreen$1","exitFullscreen$1","playerCollapse$1","playerExpand$1","pause$1","resume$1","rewind$1","skip$1","createDefaultSkipControl","skipBtn","innerHTML","bottom","right","error$1","volumeChanged","adProgress","complete$1","firstQuartile$1","midpoint$1","start$1","thirdQuartile$1","percentageProgress","currentTime","isCompleted","mute$1","unmute$1","isMuted","muted","volume","impression$1","toFixedDigits","num","digits","formattedNum","String","progress$2","secondsToMilliseconds","seconds","isValid","offsetIsValid","parseFloat","isPercentage$1","uriIsValid","offsetToMs","clickThrough$1","handlers","clickThroughUrl","anchor","left","top","href","onclick","Event","stopPropagation","paused","play","errorHandler","fullscreenEvtNames","fullscreenOn","fullscreenchangeHandler","fullscreenElement","webkitFullscreenElement","mozFullScreenElement","msFullscreenElement","_event","impressionHandler","started","playHandler","pauseHandler","_ref3$progressEvents","progressEvents","playedMs","previousCurrentTime","pendingEvents","_ref4","progressHandler","delta","_pendingEvents$reduce","reduce","accumulator","toCall","stillPending","_ref5","hours","minutes","ms","contentplayhead","floor","timeupdateHandler","videoAdContainer","skipoffset","_ref$createSkipContro","createSkipControl","skipControl","skipHandler","currentTimeMs","passFirstQuartile","passMidPoint","passThirdQuartile","completed","isPassThirdQuartile","isPassMidPoint","isPassFirstQuartile","endedHandler","wasMuted","volumechangeHandler","setupMetricHandlers","hooks","getSkipOffset","accumulated","events","concat","getProgressEvents","stopHandlersFns","disconnect","updateMedia","media","playing","load","FUNC_ERROR_TEXT","NAN","symbolTag","reTrim","reIsBadHex","reIsBinary","reIsOctal","freeParseInt","freeGlobal","freeSelf","objectToString","nativeMax","max","nativeMin","min","now","isObject","isSymbol","isObjectLike","toNumber","other","valueOf","isBinary","lodash_debounce","func","wait","lastArgs","lastThis","maxWait","timerId","lastCallTime","lastInvokeTime","leading","maxing","trailing","invokeFunc","time","args","thisArg","shouldInvoke","timeSinceLastCall","timerExpired","trailingEdge","setTimeout","remainingWait","debounced","isInvoking","leadingEdge","cancel","clearTimeout","flush","MutationObserver","WebKitMutationObserver","MozMutationObserver","noop","sizeMutationAttrs","mutationHandlers","observerKey","onMutation","observer","mutations","index","observe","characterData","childList","createResizeMO","_len","_key","resizeHandlers","resizeObject","onResize","setAttribute","createResizeObjElement","_len2","_key2","getComputedStyle","onElementResize","_ref$threshold","threshold","validate","makeSizeId","clientHeight","clientWidth","lastSize","checkElementHandler","currentSize","stopObservingMutations","stopListeningToResize","elementEntries","checkIsVisible","lastInViewport","isInViewport","viewabilityOffsetFraction","_element$getBoundingC","verticalOffset","horizontalOffset","viewportHeight","innerHeight","viewportWidth","innerWidth","isElementVisible","viewportOffset","checkVisibility","onElementVisibilityChange","_ref$scrollableElemen","scrollableElement","_ref$viewabilityOffse","viewabilityOffset","validate$1","viewportEventHandler","elementEntry","every","preventManualProgress","previousTime","skipAttempts","preventAdSkip","preventAdSeek","Emitter","evts","console","evtListeners","eListener","_","_this","removeListener","on","_this2","hasListeners","stack","getResource","chooseByPxRatio","icons","devicePixelRatio","iconA","iconB","sortIconByBestPxratio","retrieveIcons","byProgram","icon","_icon$program","groupIconsByProgram","chooseIcons","uniqValue","seen","item","uniqByResource","Deferred","promise","waitFor","pending","cancelOnce","fetch","support","searchParams","blob","Blob","formData","arrayBuffer","viewClasses","isDataView","DataView","isPrototypeOf","isArrayBufferView","ArrayBuffer","isView","Headers","append","normalizeName","normalizeValue","oldValue","has","set","items","iteratorFor","entries","methods","Request","clone","_bodyInit","Body","Response","status","statusText","headers","url","response","redirectStatuses","redirect","RangeError","input","init","request","xhr","XMLHttpRequest","rawHeaders","getAllResponseHeaders","split","line","parts","shift","responseURL","responseText","ontimeout","open","credentials","withCredentials","responseType","setRequestHeader","send","polyfill","header","consumed","bodyUsed","fileReaderReady","reader","readBlobAsArrayBuffer","FileReader","readAsArrayBuffer","bufferClone","buf","view","Uint8Array","byteLength","buffer","_initBody","_bodyText","_bodyBlob","FormData","_bodyFormData","URLSearchParams","_bodyArrayBuffer","rejected","readAsText","chars","fromCharCode","readArrayBufferAsText","decode","json","JSON","parse","upcased","referrer","form","bytes","decodeURIComponent","bodyInit","ok","isValidContentType","contentType","normalisedCT","some","allowedType","fetchHtml","endpoint","_error","_x","createResource","createStaticResource","divElement","html","dispatchEvent","CustomEvent","createHtmlResource","frameBorder","createIframeResource","noop$1","loadResource","resourceElement","resourceErrorWait","resourceLoadWait","cleanUp","contains","zIndex","updateIcon","dynamicPos","iconHeight","phHeight","drawnIcons","oldSignature","signature","rect","phRect","isCustomXposition","dIcon","iconWidth","phWidth","drawnIconsWidth","calculateIconLeft","isCustomYPosition","updated","calculateArea","_ref6","withoutOverlaps","newIcon","_ref7","drawnIcon","overlap","canBeRendered","config","thereIsSpace","placeholderArea","hasSpace","isWithinTheContentArea","withinBoundaries","doesNotOverlap","noop$2","wrapWithClickThrough","_ref$onIconClick","onIconClick","iconClickthrough","pointerEvents","createIcon","iconResource","_x3","updateIconElement","renderIcon","_callee2","updatedIcon","_context2","_x4","_x5","renderIcons","_icons$reduce","currentTimeInMs","videoDurationInMs","canBeShown","otherIcons","iconsToShow","renderedIcon","log","firstRenderPending","noop$3","addIcons","_ref3$onIconView","onIconView","_ref3$onIconClick","rest","objectWithoutProperties","drawIcons","hasPendingIconRedraws","iconsPendingToRedraw","iconsPendingToBeRemoved","_hasPendingIconRedraws","removeIcons","removeDrawnIcons","viewmode","start$2","iconClick$1","iconView$1","_protected","VideoAdUnit","_Emitter","_ref$viewability","viewability","_ref$responsive","responsive","_ref$logger","finished","onFinishCallbacks","emit","adUnit","onErrorCallbacks","throwIfCalled","throwIfFinished","isFinished","_addIcons","unsubscribe","visible","prevSize","resize","isStarted","complete$2","errorEvt","skip$2","_private","VastAdUnit","_VideoAdUnit","handleMetric","code","assetUri","removeMetricHandlers","_videoAdContainer","adUnitError","_callee3","_videoAdContainer2","_context3","SUPPORTED_MIMETYPES","isSupported","mimetype","loadCreative","addScript","getVPAIDAd","adStarted","adSkipped","adDurationChange","adRemainingTimeChange","adVolumeChange","adImpression","adVideoStart","adVideoFirstQuartile","adVideoMidpoint","adVideoThirdQuartile","adVideoComplete","adClickThru","adUserAcceptInvitation","adUserMinimize","adUserClose","adPaused","adPlaying","adError","EVENTS","waitFor$1","creativeAd","timeout","timeoutId","subscribe","callAndWait","waitPromise","major","version","handshake","supportedVersion","creativeVersion","creativeMajorNum","isSupported$1","createSlot","slot","cursor","complete$3","mute$2","unmute$2","skip$3","start$3","firstQuartile$2","pause$2","resume$2","impression$2","midpoint$2","thirdQuartile$2","clickThrough$2","errorEvt$1","closeLinear$1","_private$1","vpaidGeneralError","payload","error$$1","VpaidAdUnit","_evtHandler","evtHandler","playerHandles","getVolume","handleVpaidEvt","loadCreativePromise","adLoadedPromise","creativeEvt","t0","_placeholder$getBound","environmentVars","creativeData","videoSlot","videoSlotCanAutoPlay","XML","initAd","setVolume","t1","t2","remainingTime","createVideoAdUnit","linearEvent","evtType","linearTracker","trackLinearEvent","nonLinearEvent","trackNonLinearEvent","validate$2","hasVastCreative","startAdUnit","onAdReady","onError","tryToStartVpaidAd","startVastAd","startVideoAd","run","adUnitPromise","timedOut","timeoutPromise","race","newAdUnit","onFinish","destroy","fetch$1","defaults$$1","fetchOptions","requested","markAdAsRequested","validateChain","_ref$wrapperLimit","wrapperLimit","fetchAdXML","adTag","parseVastXml","getAd","validateResponse","_ref4$allowMultipleAd","allowMultipleAds","_ref4$followAdditiona","followAdditionalWrappers","isInline","_error2","getOptions","fallbackOnNoAd","opts","parentAd","wrapperOptions","requestAd","VASTAdResponse","epoch","fetchPromise","requestTag","Number","isInteger","getNextAd","_ref2$fallbackOnNoAd","_ref2$useAdBuffet","useAdBuffet","availableAds","adDefinition","nextAd","currentPod","nextPodSequence","getNextPod","requestNextAd","VastChain","validateChain$1","vastResponse","newVastChain","validateVastChain","lastVastResponse","validateVastResponse","callbackHandler","cb","getErrorCode","transformVastResponse","waterfall","fetchVastChain","isCanceled","runEpoch","onAdStart","onRunFinish","newEpoch","runWaterfall","canceled","onAdStartHandler","navigator","userAgent","MSStream","__webpack_exports__","_mailonline_video_ad_sdk__WEBPACK_IMPORTED_MODULE_0__","textArea","querySelector","testBtn","evt","requestAdRun","resumeContent","remove"],"mappings":"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","file":"demo.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"../\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n","var commonjsGlobal = typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\nfunction createCommonjsModule(fn, module) {\n\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n}\n\nvar runtime = createCommonjsModule(function (module) {\n/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n!(function(global) {\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n  var runtime = global.regeneratorRuntime;\n  if (runtime) {\n    {\n      // If regeneratorRuntime is defined globally and we're in a module,\n      // make the exports object identical to regeneratorRuntime.\n      module.exports = runtime;\n    }\n    // Don't bother evaluating the rest of this file if the runtime was\n    // already defined globally.\n    return;\n  }\n\n  // Define the runtime globally (as expected by generated code) as either\n  // module.exports (if we're in a module) or a new, empty object.\n  runtime = global.regeneratorRuntime = module.exports;\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  runtime.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  IteratorPrototype[iteratorSymbol] = function () {\n    return this;\n  };\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunctionPrototype[toStringTagSymbol] =\n    GeneratorFunction.displayName = \"GeneratorFunction\";\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      prototype[method] = function(arg) {\n        return this._invoke(method, arg);\n      };\n    });\n  }\n\n  runtime.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  runtime.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      if (!(toStringTagSymbol in genFun)) {\n        genFun[toStringTagSymbol] = \"GeneratorFunction\";\n      }\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  runtime.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return Promise.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return Promise.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration. If the Promise is rejected, however, the\n          // result for this iteration will be rejected with the same\n          // reason. Note that rejections of yielded Promises are not\n          // thrown back into the generator function, as is the case\n          // when an awaited Promise is rejected. This difference in\n          // behavior between yield and await is important, because it\n          // allows the consumer to decide what to do with the yielded\n          // rejection (swallow it and continue, manually .throw it back\n          // into the generator, abandon iteration, whatever). With\n          // await, by contrast, there is no opportunity to examine the\n          // rejection reason outside the generator function, so the\n          // only option is to throw it from the await expression, and\n          // let the generator function handle the exception.\n          result.value = unwrapped;\n          resolve(result);\n        }, reject);\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new Promise(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  AsyncIterator.prototype[asyncIteratorSymbol] = function () {\n    return this;\n  };\n  runtime.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  runtime.async = function(innerFn, outerFn, self, tryLocsList) {\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList)\n    );\n\n    return runtime.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        if (delegate.iterator.return) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  Gp[toStringTagSymbol] = \"Generator\";\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  runtime.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  runtime.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n})(\n  // In sloppy mode, unbound `this` refers to the global object, fallback to\n  // Function constructor if we're in global strict mode. That is sadly a form\n  // of indirect eval which violates Content Security Policy.\n  (function() { return this })() || Function(\"return this\")()\n);\n});\n\n/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n// This method of obtaining a reference to the global object needs to be\n// kept identical to the way it is obtained in runtime.js\nvar g = (function() { return this })() || Function(\"return this\")();\n\n// Use `getOwnPropertyNames` because not all browsers support calling\n// `hasOwnProperty` on the global `self` object in a worker. See #183.\nvar hadRuntime = g.regeneratorRuntime &&\n  Object.getOwnPropertyNames(g).indexOf(\"regeneratorRuntime\") >= 0;\n\n// Save the old regeneratorRuntime in case it needs to be restored later.\nvar oldRuntime = hadRuntime && g.regeneratorRuntime;\n\n// Force reevalutation of runtime.js.\ng.regeneratorRuntime = undefined;\n\nvar runtimeModule = runtime;\n\nif (hadRuntime) {\n  // Restore the original runtime.\n  g.regeneratorRuntime = oldRuntime;\n} else {\n  // Remove the global property added by runtime.js.\n  try {\n    delete g.regeneratorRuntime;\n  } catch(e) {\n    g.regeneratorRuntime = undefined;\n  }\n}\n\nvar regenerator = runtimeModule;\n\n/**\n * Interface for classes that may emit linear VAST events.\n *\n * @interface LinearEvents\n */\n\n/**\n * Fires when the the creative was played to the end at normal speed so that 100% of the creative was played.\n *\n * @event LinearEvents#complete\n */\nvar complete = 'complete';\n\n/**\n * Fires when a user clicks the ad.\n *\n * @event LinearEvents#clickThrough\n */\nvar clickThrough = 'clickThrough';\n\n/**\n * Fires when there was an error with the linear creative.\n *\n * @event LinearEvents#error\n */\nvar error = 'error';\n\n/**\n * Fires when the creative played continuously for at least 25% of the total duration at normal speed.\n *\n * @event LinearEvents#firstQuartile\n */\nvar firstQuartile = 'firstQuartile';\n\n/**\n * Fires when there was an impression of the linear creative.\n *\n * @event LinearEvents#impression\n */\nvar impression = 'impression';\n\n/**\n * Fires when the creative played continuously for at least 50% of the total duration at normal speed.\n *\n * @event LinearEvents#midpoint\n */\nvar midpoint = 'midpoint';\n\n/**\n * Fires when the user activated the mute control and muted the creative.\n *\n * @event LinearEvents#mute\n */\nvar mute = 'mute';\n\n/**\n * Optional metric that can capture all other user interactions under one metric such a s hover-overs, or custom clicks. It should NOT replace clickthrough events or other existing events like mute, unmute, pause, etc.\n *\n * @event LinearEvents#otherAdInteraction\n */\nvar otherAdInteraction = 'otherAdInteraction';\n\n/**\n * Fires when the user clicked the pause control and stopped the creative.\n *\n * @event LinearEvents#pause\n */\nvar pause = 'pause';\n\n/**\n * Fires when the user activated a control to reduce player to a smaller size. This event replaces the exitFullscreen event per the 2014 Digital Video In-Stream Ad Metric Definitions.\n *\n * @event LinearEvents#playerCollapse\n */\nvar playerCollapse = 'playerCollapse';\n\n/**\n * Fires when the user activated a control to reduce player to a smaller size.\n *\n * @event LinearEvents#exitFullscreen\n */\nvar exitFullscreen = 'exitFullscreen';\n\n/**\n * Fires when the user activated a control to extend the player to a larger size. This event replaces the fullscreen event per the 2014 Digital Video In-Stream Ad Metric Definitions.\n *\n * @event LinearEvents#playerExpand\n */\nvar playerExpand = 'playerExpand';\n\n/**\n * Fires when the user activated a control to extend the player to a larger size. Only for VAST 3.\n *\n * @event LinearEvents#fullscreen\n */\nvar fullscreen = 'fullscreen';\n\n/**\n * Fires when the creative played for a duration at normal speed that is equal to or greater than the value provided in an additional offset attribute for the <Tracking> element under Linear ads. Values can be time in the format HH:MM:SS or HH:MM:SS.mmm or a percentage value in the format n%.\n *\n * @event LinearEvents#progress\n */\nvar progress = 'progress';\n\n/**\n * Fires when the user activated the resume control after the creative had been stopped or paused.\n *\n * @event LinearEvents#resume\n */\nvar resume = 'resume';\n\n/**\n * Fires when the user activated the rewind control to access a previous point in the creative timeline.\n *\n * @event LinearEvents#rewind\n */\nvar rewind = 'rewind';\n\n/**\n * Fires when the user activated a skip control to skip the creative.\n *\n * @event LinearEvents#skip\n */\nvar skip = 'skip';\n\n/**\n * This event is used to indicate that an individual creative within the ad was loaded and playback began. As with creativeView, this event is another way of tracking creative playback.\n *\n * @event LinearEvents#start\n */\nvar start = 'start';\n\n/**\n * Fires when the creative played continuously for at least 75% of the duration at normal speed.\n *\n * @event LinearEvents#thirdQuartile\n */\nvar thirdQuartile = 'thirdQuartile';\n\n/**\n * Amount of video viewed at normal speed in seconds or other appropriate time-based units. If a rewind event occurs during play, time spent viewing may be calculated on total amount of video viewed at normal speed, which may include additional amounts of video viewed after rewinding. The offset attribute for the <Tracking> element under Linear ads may be used to track when time spent viewing meets the threshold. Otherwise, a macro may be provided so that the player may return a time value. VAST does not provide a standard macro for this value, so the involved parties must establish these parameters if this metric is to be used.\n *\n * @event LinearEvents#timeSpentViewing\n */\nvar timeSpentViewing = 'timeSpentViewing';\n\n/**\n * Fires when the user activated the mute control and unmuted the creative.\n *\n * @event LinearEvents#unmute\n */\nvar unmute = 'unmute';\n\n/**\n * Fires when the user clicked the creative icon.\n *\n * @event LinearEvents#iconClick\n */\nvar iconClick = 'iconClick';\n\n/**\n * Fires when the user viewed the creative icon.\n *\n * @event LinearEvents#iconView\n */\nvar iconView = 'iconView';\n\n/**\n * The viewer has chosen to close the linear ad unit. This is currently inuse by some of the largest mobile SDKs to mark the dismissal of the end card companion that follows the video, as well as a close of the video itself, if applicable\n *\n * @event LinearEvents#closeLinear\n */\nvar closeLinear = 'closeLinear';\n\nvar linearEvents = {\n  clickThrough: clickThrough,\n  closeLinear: closeLinear,\n  complete: complete,\n  error: error,\n  exitFullscreen: exitFullscreen,\n  firstQuartile: firstQuartile,\n  fullscreen: fullscreen,\n  iconClick: iconClick,\n  iconView: iconView,\n  impression: impression,\n  midpoint: midpoint,\n  mute: mute,\n  otherAdInteraction: otherAdInteraction,\n  pause: pause,\n  playerCollapse: playerCollapse,\n  playerExpand: playerExpand,\n  progress: progress,\n  resume: resume,\n  rewind: rewind,\n  skip: skip,\n  start: start,\n  thirdQuartile: thirdQuartile,\n  timeSpentViewing: timeSpentViewing,\n  unmute: unmute\n};\n\n/**\n * Interface for classes that may emit non linear VAST events.\n *\n * @interface NonLinearEvents\n */\n\n/**\n * Fires when the user clicked or otherwise activated a control used to pause streaming content, which either expands the ad within the player’s viewable area or “takes-over” the streaming content area by launching an additional portion of the ad.\n *\n * @event NonLinearEvents#acceptInvitation\n */\nvar acceptInvitation = 'acceptInvitation';\n\n/**\n * Fires when the user clicked or otherwise activated a control used to pause streaming content, which either expands the ad within the player’s viewable area or “takes-over” the streaming content area by launching an additional portion of the ad.\n *\n * @event NonLinearEvents#adCollapse\n */\nvar adCollapse = 'adCollapse';\n\n/**\n * Not to be confused with an impression, this event indicates that an individual creative portion of the ad was viewed.\n *\n * @event NonLinearEvents#creativeView\n */\nvar creativeView = 'creativeView';\n\n/**\n * Fires when the user clicked or otherwise activated a control for removing the ad.\n *\n * @event NonLinearEvents#close\n */\nvar close = 'close';\n\nvar nonLinearEvents = {\n  acceptInvitation: acceptInvitation,\n  adCollapse: adCollapse,\n  close: close,\n  creativeView: creativeView\n};\n\nvar innerXML = function (node) {\n    var s = new XMLSerializer();\n    return Array.prototype.map.call(node.childNodes, function (node) {\n        return s.serializeToString(node);\n    }).join('');\n};\n\nvar getParseError = function (doc) {\n    // Firefox\n    if (doc.documentElement.tagName === 'parsererror' &&\n        doc.documentElement.namespaceURI === 'http://www.mozilla.org/newlayout/xml/parsererror.xml') {\n        return doc.documentElement;\n    }\n\n    // Chrome, Safari\n    if ((doc.documentElement.tagName === 'xml' || doc.documentElement.tagName === 'html') &&\n        doc.documentElement.childNodes &&\n        doc.documentElement.childNodes.length > 0 &&\n        doc.documentElement.childNodes[0].nodeName === 'parsererror') {\n        return doc.documentElement.childNodes[0];\n    }\n\n    // PhantomJS\n    if (doc.documentElement.tagName === 'html' &&\n        doc.documentElement.childNodes &&\n        doc.documentElement.childNodes.length > 0 &&\n        doc.documentElement.childNodes[0].nodeName === 'body' &&\n        doc.documentElement.childNodes[0].childNodes &&\n        doc.documentElement.childNodes[0].childNodes.length &&\n        doc.documentElement.childNodes[0].childNodes[0].nodeName === 'parsererror') {\n        return doc.documentElement.childNodes[0].childNodes[0];\n    }\n\n    return undefined;\n};\n\nvar errorMessagePatterns = [\n    // Chrome, Safari, PhantomJS\n    new RegExp('^<h3[^>]*>This page contains the following errors:<\\/h3><div[^>]*>(.+?)\\n?<\\/div>'),\n    // Firefox\n    new RegExp('^(.+)\\n')\n];\n\nvar extractParseError = function (errorNode) {\n    var content = innerXML(errorNode);\n    var i, match;\n\n    for(i = 0; i < errorMessagePatterns.length; i++) {\n        match = errorMessagePatterns[i].exec(content);\n\n        if (match) {\n            return match[1];\n        }\n    }\n    return undefined;\n};\n\nvar failOnParseError = function (doc) {\n    var errorMessage;\n\n    if (doc === null) {\n        throw new Error('Parse error');\n    }\n\n    var parseError = getParseError(doc);\n    if (parseError !== undefined) {\n        errorMessage = extractParseError(parseError) || 'Parse error';\n        throw new Error(errorMessage);\n    }\n};\n\nvar failOnParseError_1 = function (doc) {\n    failOnParseError(doc);\n\n    return doc;\n};\n\nvar saneDomparserError = {\n\tfailOnParseError: failOnParseError_1\n};\n\nvar TYPE = {\n  CDATA: 'cdata',\n  DOCUMENT: 'document',\n  ELEMENT: 'element',\n  TEXT: 'text'\n};\n\nvar nodeType = function nodeType(node) {\n  if (node.nodeType === 1) {\n    return TYPE.ELEMENT;\n  }\n\n  if (node.nodeType === 3 || node.nodeType === 4) {\n    return TYPE.TEXT;\n  }\n\n  if (node.nodeType === 9) {\n    return TYPE.DOCUMENT;\n  }\n\n  throw new Error('Unsupported element type');\n};\n\nvar xmlToJson = function xmlToJson(node) {\n  var type = nodeType(node);\n\n  var obj = {\n    type: type\n  };\n\n  if (type === TYPE.ELEMENT) {\n    obj.name = node.nodeName.toLowerCase();\n\n    if (node.attributes.length > 0) {\n      obj.attributes = {};\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = Array.from(node.attributes)[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var attribute = _step.value;\n\n          obj.attributes[attribute.nodeName] = attribute.nodeValue;\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n    }\n  } else if (type === TYPE.TEXT) {\n    obj.text = node.nodeValue.replace('<![CDATA[', '').replace(']]>', '').trim();\n  }\n\n  // do children\n  if (node.hasChildNodes()) {\n    var childNodes = Array.from(node.childNodes).filter(function (childNode) {\n      return [1, 3, 4].includes(childNode.nodeType);\n    });\n    var elements = [];\n\n    obj.elements = elements;\n\n    var _iteratorNormalCompletion2 = true;\n    var _didIteratorError2 = false;\n    var _iteratorError2 = undefined;\n\n    try {\n      for (var _iterator2 = childNodes[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n        var childNode = _step2.value;\n\n        var childObj = xmlToJson(childNode);\n\n        if (childObj.type !== TYPE.TEXT || childObj.text.length > 0) {\n          elements.push(childObj);\n        }\n      }\n    } catch (err) {\n      _didIteratorError2 = true;\n      _iteratorError2 = err;\n    } finally {\n      try {\n        if (!_iteratorNormalCompletion2 && _iterator2.return) {\n          _iterator2.return();\n        }\n      } finally {\n        if (_didIteratorError2) {\n          throw _iteratorError2;\n        }\n      }\n    }\n  }\n\n  return obj;\n};\n\n/* eslint-disable filenames/match-regex, id-match */\n\nvar xml2js = function xml2js(parser, xmlText) {\n  var xmlDom = parser.parseFromString(xmlText, 'application/xml');\n\n  saneDomparserError.failOnParseError(xmlDom);\n\n  return xmlToJson(xmlDom);\n};\n\nvar getChildren = function getChildren() {\n  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      _ref$elements = _ref.elements,\n      elements = _ref$elements === undefined ? [] : _ref$elements;\n\n  return elements;\n};\n\nvar findChildByName = function findChildByName(element, childName) {\n  return getChildren(element).find(function (_ref2) {\n    var _ref2$name = _ref2.name,\n        name = _ref2$name === undefined ? '' : _ref2$name;\n    return name.toUpperCase() === childName.toUpperCase();\n  });\n};\n\nvar filterChildrenByName = function filterChildrenByName(element, childrenName) {\n  return getChildren(element).filter(function (_ref3) {\n    var _ref3$name = _ref3.name,\n        name = _ref3$name === undefined ? '' : _ref3$name;\n    return name.toUpperCase() === childrenName.toUpperCase();\n  });\n};\n\n/**\n * Get the first child element from the passed parsed xml element.\n *\n * @memberof module:@mailonline/vast-xml2js\n * @param {Object} element - Parsed xml element object.\n * @param {string} childName - Child element name\n * @returns {Object|undefined} - the first child element with the passed name or undefined if not found.\n */\nvar get = findChildByName;\n\n/**\n * Get all the children elements of the passed parsed xml element filtered by the passed child name if passed.\n *\n * @memberof module:@mailonline/vast-xml2js\n * @param {Object} element - Parsed xml element object.\n * @param {string} [childName] - Child element name.\n * @returns {Array} - Array of child elements or an empty array.\n */\nvar getAll = function getAll(element, childName) {\n  if (typeof childName === 'string') {\n    return filterChildrenByName(element, childName);\n  }\n\n  return getChildren(element);\n};\n\n/**\n * Get the first child element from the passed parsed xml element.\n *\n * @memberof module:@mailonline/vast-xml2js\n * @returns {Object|null} - the first child element or undefined if there are non.\n */\nvar getFirstChild = function getFirstChild(element) {\n  return getChildren(element)[0] || null;\n};\n\n/**\n * Get the text value of the passed parsed xml element or null if there is non.\n *\n * @memberof module:@mailonline/vast-xml2js\n * @returns {string|null} - text of the element or null.\n */\nvar getText = function getText(element) {\n  var firstChild = element && getFirstChild(element);\n\n  return firstChild && firstChild.text || null;\n};\n\n/**\n * Get all the attributes of the passed parsed xml element.\n *\n * @memberof module:@mailonline/vast-xml2js\n * @returns {Object} - Object with the element attributes.\n */\nvar getAttributes = function getAttributes() {\n  var _ref4 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      _ref4$attributes = _ref4.attributes,\n      attributes = _ref4$attributes === undefined ? {} : _ref4$attributes;\n\n  return attributes;\n};\n\n/**\n * Get the attribute with the passed name of the passed parsed xml element.\n *\n * @memberof module:@mailonline/vast-xml2js\n * @returns {number|string|undefined} - Attribute value or undefined.\n */\nvar getAttribute = function getAttribute(element, attributeName) {\n  return getAttributes(element)[attributeName];\n};\n\nvar parser = new DOMParser();\n\n/**\n * Parses the passed xml text.\n *\n * @throws if there is an error parsing the xml.\n * @param {string} xmlText - XML text to be parsed.\n * @returns {Object} - Returns the parsed xml document as a js object.\n * @static\n */\nvar parseXml = function parseXml(xmlText) {\n  return xml2js(parser, xmlText);\n};\n\nvar parseHoursToMs = function parseHoursToMs(hourStr) {\n  return parseInt(hourStr, 10) * 60 * 60 * 1000;\n};\nvar parseMinToMs = function parseMinToMs(minStr) {\n  return parseInt(minStr, 10) * 60 * 1000;\n};\nvar parseSecToMs = function parseSecToMs(secStr) {\n  return parseInt(secStr, 10) * 1000;\n};\nvar parseTime = function parseTime(durationStr) {\n  if (typeof durationStr === 'string') {\n    var durationRegex = /(\\d\\d):(\\d\\d):(\\d\\d)(\\.(\\d\\d\\d))?/;\n    var match = durationStr.match(durationRegex);\n\n    if (match) {\n      var durationInMs = parseHoursToMs(match[1]) + parseMinToMs(match[2]) + parseSecToMs(match[3]) + parseInt(match[5] || 0, 10);\n\n      if (!isNaN(durationInMs)) {\n        return durationInMs;\n      }\n    }\n  }\n\n  return null;\n};\n\nvar isPercentage = function isPercentage(offset) {\n  var percentageRegex = /^\\d+(\\.\\d+)?%$/g;\n\n  return percentageRegex.test(offset);\n};\n\nvar parseOffset = function parseOffset(offset) {\n  if (isPercentage(offset)) {\n    return offset;\n  }\n\n  return parseTime(offset);\n};\n\nvar getLinearCreative = function getLinearCreative(ad) {\n  var adTypeElement = getFirstChild(ad);\n  var creativesElement = adTypeElement && get(adTypeElement, 'creatives');\n  var hasLinear = function hasLinear(creative) {\n    return get(creative, 'linear');\n  };\n\n  return creativesElement && getAll(creativesElement).find(hasLinear) || null;\n};\n\n/**\n * Gets the Linear tracking events from the Vast Ad\n *\n * @function\n * @param {ParsedAd} ad - VAST ad object.\n * @param {string} [eventName] - If provided it will filter-out the array events against it.\n * @returns {?Array.<VastTrackingEvent>} - Array of Tracking event definitions\n * @static\n * @ignore\n */\nvar getLinearTrackingEvents = function getLinearTrackingEvents(ad, eventName) {\n  var creativeElement = ad && getLinearCreative(ad);\n\n  if (creativeElement) {\n    var linearElement = get(creativeElement, 'Linear');\n    var trackingEventsElement = linearElement && get(linearElement, 'TrackingEvents');\n    var trackingEventElements = trackingEventsElement && getAll(trackingEventsElement, 'Tracking');\n\n    if (trackingEventElements && trackingEventElements.length > 0) {\n      var trackingEvents = trackingEventElements.map(function (trackingEventElement) {\n        var _getAttributes = getAttributes(trackingEventElement),\n            event = _getAttributes.event,\n            offset = _getAttributes.offset;\n\n        var uri = getText(trackingEventElement);\n\n        return {\n          event: event,\n          offset: offset && parseOffset(offset),\n          uri: uri\n        };\n      });\n\n      if (eventName) {\n        var filteredEvents = trackingEvents.filter(function (_ref) {\n          var event = _ref.event;\n          return event === eventName;\n        });\n\n        if (filteredEvents.length > 0) {\n          return filteredEvents;\n        }\n      } else {\n        return trackingEvents;\n      }\n    }\n  }\n\n  return null;\n};\n\n/**\n * Gets the Non Linear tracking events from the Vast Ad\n *\n * @function\n * @param {ParsedAd} ad - VAST ad object.\n * @param {string} [eventName] - If provided it will filter-out the array events against it.\n * @returns {?Array.<VastTrackingEvent>} - Array of Tracking event definitions\n * @static\n * @ignore\n */\nvar getNonLinearTrackingEvents = function getNonLinearTrackingEvents(ad, eventName) {\n  var creativeElement = ad && getLinearCreative(ad);\n\n  if (creativeElement) {\n    var NonLinearAdsElement = get(creativeElement, 'NonLinearAds');\n    var trackingEventsElement = NonLinearAdsElement && get(NonLinearAdsElement, 'TrackingEvents');\n    var trackingEventElements = trackingEventsElement && getAll(trackingEventsElement, 'Tracking');\n\n    if (trackingEventElements && trackingEventElements.length > 0) {\n      var trackingEvents = trackingEventElements.map(function (trackingEventElement) {\n        var _getAttributes = getAttributes(trackingEventElement),\n            event = _getAttributes.event;\n\n        var uri = getText(trackingEventElement);\n\n        return {\n          event: event,\n          uri: uri\n        };\n      });\n\n      if (eventName) {\n        var filteredEvents = trackingEvents.filter(function (_ref) {\n          var event = _ref.event;\n          return event === eventName;\n        });\n\n        if (filteredEvents.length > 0) {\n          return filteredEvents;\n        }\n      } else {\n        return trackingEvents;\n      }\n    }\n  }\n\n  return null;\n};\n\nvar asyncToGenerator = function (fn) {\n  return function () {\n    var gen = fn.apply(this, arguments);\n    return new Promise(function (resolve, reject) {\n      function step(key, arg) {\n        try {\n          var info = gen[key](arg);\n          var value = info.value;\n        } catch (error) {\n          reject(error);\n          return;\n        }\n\n        if (info.done) {\n          resolve(value);\n        } else {\n          return Promise.resolve(value).then(function (value) {\n            step(\"next\", value);\n          }, function (err) {\n            step(\"throw\", err);\n          });\n        }\n      }\n\n      return step(\"next\");\n    });\n  };\n};\n\nvar classCallCheck = function (instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n};\n\nvar createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar defineProperty = function (obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n};\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar get$1 = function get(object, property, receiver) {\n  if (object === null) object = Function.prototype;\n  var desc = Object.getOwnPropertyDescriptor(object, property);\n\n  if (desc === undefined) {\n    var parent = Object.getPrototypeOf(object);\n\n    if (parent === null) {\n      return undefined;\n    } else {\n      return get(parent, property, receiver);\n    }\n  } else if (\"value\" in desc) {\n    return desc.value;\n  } else {\n    var getter = desc.get;\n\n    if (getter === undefined) {\n      return undefined;\n    }\n\n    return getter.call(receiver);\n  }\n};\n\nvar inherits = function (subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n};\n\nvar objectWithoutProperties = function (obj, keys) {\n  var target = {};\n\n  for (var i in obj) {\n    if (keys.indexOf(i) >= 0) continue;\n    if (!Object.prototype.hasOwnProperty.call(obj, i)) continue;\n    target[i] = obj[i];\n  }\n\n  return target;\n};\n\nvar possibleConstructorReturn = function (self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n};\n\nvar toConsumableArray = function (arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) arr2[i] = arr[i];\n\n    return arr2;\n  } else {\n    return Array.from(arr);\n  }\n};\n\nvar formatSize = function formatSize(size) {\n  var match = ('' + size).match(/\\d+/g);\n\n  return parseInt(match[0], 10);\n};\n\nvar formatPosition = function formatPosition(position) {\n  var isNumberString = /\\d+/.test(position);\n\n  if (isNumberString) {\n    return formatSize(position);\n  }\n\n  return position;\n};\n\nvar getIconAttributes = function getIconAttributes(iconElement) {\n  var _getAttributes = getAttributes(iconElement),\n      duration = _getAttributes.duration,\n      height = _getAttributes.height,\n      offset = _getAttributes.offset,\n      program = _getAttributes.program,\n      pxratio = _getAttributes.pxratio,\n      width = _getAttributes.width,\n      _getAttributes$xPosit = _getAttributes.xPosition,\n      xPosition = _getAttributes$xPosit === undefined ? 'right' : _getAttributes$xPosit,\n      _getAttributes$yPosit = _getAttributes.yPosition,\n      yPosition = _getAttributes$yPosit === undefined ? 'top' : _getAttributes$yPosit;\n\n  return {\n    duration: duration && parseTime(duration),\n    height: height && formatSize(height),\n    offset: offset && parseTime(offset),\n    program: program,\n    pxratio: pxratio && parseInt(pxratio, 10),\n    width: width && formatSize(width),\n    xPosition: xPosition && formatPosition(xPosition),\n    yPosition: yPosition && formatPosition(yPosition)\n  };\n};\n\nvar getIconResource = function getIconResource(iconElement) {\n  var staticResourceElement = get(iconElement, 'StaticResource');\n  var htmlResourceElement = get(iconElement, 'HTMLResource');\n  var iFrameResourceElement = get(iconElement, 'IFrameResource');\n\n  if (staticResourceElement) {\n    return { staticResource: getText(staticResourceElement) };\n  }\n\n  if (htmlResourceElement) {\n    return { htmlResource: getText(htmlResourceElement) };\n  }\n\n  if (iFrameResourceElement) {\n    return { iFrameResource: getText(iFrameResourceElement) };\n  }\n\n  return {\n    staticResource: getText(iconElement)\n  };\n};\n\nvar getIconViewTracking = function getIconViewTracking(iconElement) {\n  var iconTrackingElements = getAll(iconElement, 'IconViewTracking').map(function (iconViewTrackingElement) {\n    return getText(iconViewTrackingElement);\n  });\n\n  if (iconTrackingElements.length === 0) {\n    return {};\n  }\n\n  return {\n    iconViewTracking: iconTrackingElements\n  };\n};\n\nvar getIconClicks = function getIconClicks(iconElement) {\n  var iconClicksElement = get(iconElement, 'IconClicks');\n  var iconClickThroughElement = iconClicksElement && get(iconClicksElement, 'IconClickThrough');\n  var iconClickTrackingElements = iconClicksElement && getAll(iconClicksElement, 'IconClickTracking').map(function (iconClickTrackingElement) {\n    return getText(iconClickTrackingElement);\n  });\n\n  return {\n    iconClickThrough: iconClickThroughElement && getText(iconClickThroughElement),\n    iconClickTracking: iconClickTrackingElements && iconClickTrackingElements.length > 0 ? iconClickTrackingElements : undefined\n  };\n};\n\n/**\n * Gets the Vast Icon definitions from the Vast Ad\n *\n * @function\n * @param {ParsedAd} ad - VAST ad object.\n * @returns {?Array.<VastIcon>} - Array of VAST icon definitions\n * @static\n * @ignore\n */\nvar getIcons = function getIcons(ad) {\n  var linearCreativeElement = ad && getLinearCreative(ad);\n  var linearElement = linearCreativeElement && get(linearCreativeElement, 'linear');\n  var iconsElement = linearElement && get(linearElement, 'Icons');\n  var iconElements = iconsElement && getAll(iconsElement, 'Icon');\n\n  if (iconElements && iconElements.length > 0) {\n    return iconElements.map(function (iconElement) {\n      return _extends({}, getIconAttributes(iconElement), getIconResource(iconElement), getIconViewTracking(iconElement), getIconClicks(iconElement));\n    });\n  }\n\n  return null;\n};\n\nvar getBooleanValue = function getBooleanValue(val) {\n  if (typeof val === 'string') {\n    return val === 'true';\n  }\n\n  return Boolean(val);\n};\n\nvar compareBySequence = function compareBySequence(itemA, itemB) {\n  var itemASequence = parseInt(getAttribute(itemA, 'sequence'), 10);\n  var itemBSequence = parseInt(getAttribute(itemB, 'sequence'), 10);\n\n  if (itemASequence < itemBSequence) {\n    return -1;\n  }\n\n  if (itemASequence > itemBSequence) {\n    return 1;\n  }\n\n  return 0;\n};\n\n/**\n * Selects the ads of the passed VAST.\n *\n * @function\n * @param {ParsedVast} parsedVAST - Parsed VAST xml.\n * @returns {?Array} - Array of ads or empty array.\n * @static\n * @ignore\n */\nvar getAds = function getAds(parsedVAST) {\n  var vastElement = parsedVAST && get(parsedVAST, 'VAST');\n  var ads = vastElement && getAll(vastElement, 'Ad');\n\n  if (ads && ads.length > 0) {\n    return ads;\n  }\n\n  return [];\n};\n\n/**\n * Gets the Error URI of the passed parsed VAST xml.\n *\n * @function\n * @param {ParsedVast} parsedVAST - Parsed VAST xml.\n * @returns {?VAST-macro} - Vast Error URI or `null` otherwise.\n * @static\n * @ignore\n */\nvar getVastErrorURI = function getVastErrorURI(parsedVAST) {\n  var vastElement = parsedVAST && get(parsedVAST, 'VAST');\n\n  if (vastElement) {\n    var error = get(vastElement, 'Error');\n\n    if (error) {\n      return getText(error);\n    }\n  }\n\n  return null;\n};\n\n/**\n * Gets the sequence of the pod ad.\n *\n * @function\n * @param {ParsedAd} ad - Parsed ad definition object.\n * @returns {?number} - The pod ad sequence number or `null`.\n * @static\n * @ignore\n */\nvar getPodAdSequence = function getPodAdSequence(ad) {\n  var sequence = parseInt(getAttribute(ad, 'sequence'), 10);\n\n  if (typeof sequence === 'number' && !isNaN(sequence)) {\n    return sequence;\n  }\n\n  return null;\n};\n\n/**\n * Checks if the passed ad definition is a pod ad.\n *\n * @function\n * @param {ParsedAd} ad - Parsed ad definition object.\n * @returns {?boolean} - Returns true if there the ad is a pod ad and false otherwise.\n * @static\n * @ignore\n */\nvar isPodAd = function isPodAd(ad) {\n  return Boolean(getPodAdSequence(ad));\n};\n\n/**\n * Checks if the passed array of ads have an ad pod.\n *\n * @function\n * @param {ParsedVAST} parsedVAST - Parsed VAST xml.\n * @returns {?boolean} - Returns true if there is an ad pod in the array and false otherwise.\n * @static\n * @ignore\n */\nvar hasAdPod = function hasAdPod(parsedVAST) {\n  var ads = getAds(parsedVAST);\n\n  return Array.isArray(ads) && ads.filter(isPodAd).length > 1;\n};\n\n/**\n * Selects the first ad of the passed VAST. If the passed VAST response contains an ad pod it will return the first ad in the ad pod sequence.\n *\n * @function\n * @param {ParsedVAST} parsedVAST - Parsed VAST xml.\n * @returns {?ParsedAd} - First ad of the VAST xml or `null`.\n * @static\n * @ignore\n */\nvar getFirstAd = function getFirstAd(parsedVAST) {\n  var ads = getAds(parsedVAST);\n\n  if (Array.isArray(ads) && ads.length > 0) {\n    if (hasAdPod(parsedVAST)) {\n      return ads.filter(isPodAd).sort(compareBySequence)[0];\n    }\n\n    return ads[0];\n  }\n\n  return null;\n};\n\n/**\n * Checks if the passed ad is a Wrapper.\n *\n * @function\n * @param {ParsedAd} ad - VAST ad object.\n * @returns {boolean} - `true` if the ad contains a wrapper and `false` otherwise.\n * @static\n * @ignore\n */\nvar isWrapper = function isWrapper() {\n  var ad = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  return Boolean(get(ad || {}, 'Wrapper'));\n};\n\n/**\n * Checks if the passed ad is an Inline.\n *\n * @function\n * @param {ParsedAd} ad - VAST ad object.\n * @returns {boolean} - Returns `true` if the ad contains an Inline or `false` otherwise.\n * @static\n * @ignore\n */\nvar isInline = function isInline(ad) {\n  return Boolean(get(ad || {}, 'Inline'));\n};\n\n/**\n * Returns the VASTAdTagURI from the wrapper ad.\n *\n * @function\n * @param {ParsedAd} ad - VAST ad object.\n * @returns {?string} - Returns the VASTAdTagURI from the wrapper ad or `null` otherwise.\n * @static\n * @ignore\n */\nvar getVASTAdTagURI = function getVASTAdTagURI(ad) {\n  var wrapperElement = get(ad, 'Wrapper');\n  var vastAdTagURIElement = wrapperElement && get(wrapperElement, 'VastAdTagUri');\n\n  if (vastAdTagURIElement) {\n    return getText(vastAdTagURIElement) || null;\n  }\n\n  return null;\n};\n\n/**\n * Returns the options from the wrapper ad.\n *\n * @function\n * @param {Object} ad - VAST ad object.\n * @returns {WrapperOptions} - Returns the options from the wrapper ad.\n * @static\n * @ignore\n */\nvar getWrapperOptions = function getWrapperOptions(ad) {\n  var _getAttributes = getAttributes(get(ad, 'Wrapper')),\n      allowMultipleAds = _getAttributes.allowMultipleAds,\n      fallbackOnNoAd = _getAttributes.fallbackOnNoAd,\n      followAdditionalWrappers = _getAttributes.followAdditionalWrappers;\n\n  var opts = {};\n\n  if (allowMultipleAds) {\n    opts.allowMultipleAds = getBooleanValue(allowMultipleAds);\n  }\n\n  if (fallbackOnNoAd) {\n    opts.fallbackOnNoAd = getBooleanValue(fallbackOnNoAd);\n  }\n\n  if (followAdditionalWrappers) {\n    opts.followAdditionalWrappers = getBooleanValue(followAdditionalWrappers);\n  }\n\n  return opts;\n};\n\n/**\n * Gets the Error URI of the passed ad.\n *\n * @function\n * @param {ParsedAd} ad - VAST ad object.\n * @returns {?string} - Vast ad Error URI or `null` otherwise.\n * @static\n * @ignore\n */\nvar getAdErrorURI = function getAdErrorURI(ad) {\n  var adTypeElement = ad && getFirstChild(ad);\n\n  if (adTypeElement) {\n    var error = get(adTypeElement, 'Error');\n\n    if (error) {\n      return getText(error);\n    }\n  }\n\n  return null;\n};\n\n/**\n * Gets the Impression URI of the passed ad.\n *\n * @function\n * @param {ParsedAd} ad - VAST ad object.\n * @returns {?string} - Vast ad Impression URI or `null` otherwise.\n * @static\n * @ignore\n */\nvar getImpressionUri = function getImpressionUri(ad) {\n  var adTypeElement = ad && getFirstChild(ad);\n\n  if (adTypeElement) {\n    var impression = get(adTypeElement, 'Impression');\n\n    if (impression) {\n      return getText(impression);\n    }\n  }\n\n  return null;\n};\n\n/**\n * Gets the ads MediaFiles.\n *\n * @function\n * @param {ParsedAd} ad - VAST ad object.\n * @returns {?Array.<MediaFile>} - array of media files or null\n * @static\n * @ignore\n */\nvar getMediaFiles = function getMediaFiles(ad) {\n  var creativeElement = ad && getLinearCreative(ad);\n\n  if (creativeElement) {\n    var universalAdIdElement = get(creativeElement, 'UniversalAdId');\n    var universalAdId = universalAdIdElement && getText(universalAdIdElement) || null;\n    var linearElement = get(creativeElement, 'Linear');\n    var mediaFilesElement = get(linearElement, 'MediaFiles');\n    var mediaFileElements = mediaFilesElement && getAll(mediaFilesElement, 'MediaFile');\n\n    if (mediaFileElements && mediaFileElements.length > 0) {\n      return mediaFileElements.map(function (mediaFileElement) {\n        var src = getText(mediaFileElement);\n\n        var _getAttributes2 = getAttributes(mediaFileElement),\n            apiFramework = _getAttributes2.apiFramework,\n            bitrate = _getAttributes2.bitrate,\n            codec = _getAttributes2.codec,\n            delivery = _getAttributes2.delivery,\n            height = _getAttributes2.height,\n            id = _getAttributes2.id,\n            maintainAspectRatio = _getAttributes2.maintainAspectRatio,\n            maxBitrate = _getAttributes2.maxBitrate,\n            minBitrate = _getAttributes2.minBitrate,\n            scalable = _getAttributes2.scalable,\n            type = _getAttributes2.type,\n            width = _getAttributes2.width;\n\n        return {\n          apiFramework: apiFramework,\n          bitrate: bitrate,\n          codec: codec,\n          delivery: delivery,\n          height: height,\n          id: id,\n          maintainAspectRatio: maintainAspectRatio,\n          maxBitrate: maxBitrate,\n          minBitrate: minBitrate,\n          scalable: scalable,\n          src: src,\n          type: type,\n          universalAdId: universalAdId,\n          width: width\n        };\n      });\n    }\n  }\n\n  return null;\n};\n\nvar getInteractiveCreativeFiles = function getInteractiveCreativeFiles(ad) {\n  var creativeElement = ad && getLinearCreative(ad);\n\n  if (creativeElement) {\n    var linearElement = get(creativeElement, 'Linear');\n    var mediaFilesElement = get(linearElement, 'MediaFiles');\n    var interactiveElements = mediaFilesElement && getAll(mediaFilesElement, 'InteractiveCreativeFile');\n\n    if (interactiveElements && interactiveElements.length > 0) {\n      return interactiveElements.map(function (interactiveElement) {\n        var _getAttributes3 = getAttributes(interactiveElement),\n            apiFramework = _getAttributes3.apiFramework,\n            type = _getAttributes3.type;\n\n        var src = getText(interactiveElement);\n\n        return {\n          apiFramework: apiFramework,\n          src: src,\n          type: type\n        };\n      });\n    }\n  }\n\n  return null;\n};\n\nvar getInteractiveFiles = function getInteractiveFiles(ad) {\n  var interactiveFiles = getInteractiveCreativeFiles(ad);\n\n  if (interactiveFiles) {\n    return interactiveFiles;\n  }\n\n  var mediaFiles = getMediaFiles(ad);\n\n  if (mediaFiles) {\n    interactiveFiles = mediaFiles.filter(function (_ref2) {\n      var _ref2$apiFramework = _ref2.apiFramework,\n          apiFramework = _ref2$apiFramework === undefined ? '' : _ref2$apiFramework;\n      return apiFramework.toLowerCase() === 'vpaid';\n    }).map(function (_ref3) {\n      var apiFramework = _ref3.apiFramework,\n          src = _ref3.src,\n          type = _ref3.type;\n      return {\n        apiFramework: apiFramework,\n        src: src,\n        type: type\n      };\n    });\n\n    if (interactiveFiles.length > 0) {\n      return interactiveFiles;\n    }\n  }\n\n  return null;\n};\n\nvar getVideoClicksElement = function getVideoClicksElement(ad) {\n  var creativeElement = ad && getLinearCreative(ad);\n  var linearElement = creativeElement && get(creativeElement, 'Linear');\n  var videoClicksElement = linearElement && get(linearElement, 'VideoClicks');\n\n  if (videoClicksElement) {\n    return videoClicksElement;\n  }\n\n  return null;\n};\n\n/**\n * Gets the click through {@link VAST-macro}.\n *\n * @function\n * @param {ParsedAd} ad - VAST ad object.\n * @returns {?VAST-macro} - clickthrough macro\n * @static\n * @ignore\n */\nvar getClickThrough = function getClickThrough(ad) {\n  var videoClicksElement = getVideoClicksElement(ad);\n  var clickThroughElement = videoClicksElement && get(videoClicksElement, 'ClickThrough');\n\n  if (clickThroughElement) {\n    return getText(clickThroughElement);\n  }\n\n  return null;\n};\n\n/**\n * Gets the click through {@link VAST-macro}.\n *\n * @function\n * @param {ParsedAd} ad - VAST ad object.\n * @returns {?Array.<VAST-macro>} - click tracking macro\n * @static\n * @ignore\n */\nvar getClickTracking = function getClickTracking(ad) {\n  var videoClicksElement = getVideoClicksElement(ad);\n  var clickTrackingElements = videoClicksElement && getAll(videoClicksElement, 'ClickTracking');\n\n  if (clickTrackingElements && clickTrackingElements.length > 0) {\n    return clickTrackingElements.map(function (element) {\n      return getText(element);\n    });\n  }\n\n  return null;\n};\n\n/**\n * Gets the custom click {@link VAST-macro}.\n *\n * @function\n * @param {ParsedAd} ad - VAST ad object.\n * @returns {?Array.<VAST-macro>} - click tracking macro\n * @static\n * @ignore\n */\nvar getCustomClick = function getCustomClick(ad) {\n  var videoClicksElement = getVideoClicksElement(ad);\n  var customClickElements = videoClicksElement && getAll(videoClicksElement, 'CustomClick');\n\n  if (customClickElements && customClickElements.length > 0) {\n    return customClickElements.map(function (element) {\n      return getText(element);\n    });\n  }\n\n  return null;\n};\n\n/**\n * Gets the skipoffset.\n *\n * @function\n * @param {Object} ad - VAST ad object.\n * @returns {?ParsedOffset} - the time offset in milliseconds or a string with the percentage or null\n * @static\n * @ignore\n */\nvar getSkipOffset = function getSkipOffset(ad) {\n  var creativeElement = ad && getLinearCreative(ad);\n  var linearElement = creativeElement && get(creativeElement, 'Linear');\n  var skipoffset = linearElement && getAttribute(linearElement, 'skipoffset');\n\n  if (skipoffset) {\n    return parseOffset(skipoffset);\n  }\n\n  return null;\n};\n\nvar getLinearContent = function getLinearContent(xml) {\n  var linearRegex = /<Linear([\\s\\S]*)<\\/Linear/gm;\n  var result = linearRegex.exec(xml);\n\n  return result && result[1];\n};\n\nvar getAdParametersContent = function getAdParametersContent(xml) {\n  var paramsRegex = /<AdParameters[\\s\\w=\"]*>([\\s\\S]*)<\\/AdParameters>/gm;\n  var result = paramsRegex.exec(xml);\n\n  return result && result[1].replace('<![CDATA[', '').replace(']]>', '').trim();\n};\n\nvar getXmlEncodedValue = function getXmlEncodedValue(xml) {\n  var xmlEncodedRegex = /<AdParameters[\\s]*xmlEncoded=\"(.*?)\">/gmi;\n  var result = xmlEncodedRegex.exec(xml);\n\n  return Boolean(result) && result[1] === 'true';\n};\n\nvar getCreativeData = function getCreativeData(xml) {\n  var linearContent = getLinearContent(xml);\n  var AdParameters = linearContent && getAdParametersContent(linearContent);\n  var xmlEncoded = linearContent && getXmlEncodedValue(linearContent);\n\n  return {\n    AdParameters: AdParameters,\n    xmlEncoded: xmlEncoded\n  };\n};\n\nvar toUpperKeys = function toUpperKeys(map) {\n  var upperKeysMap = {};\n\n  Object.keys(map).forEach(function (key) {\n    upperKeysMap[key.toUpperCase()] = map[key];\n  });\n\n  return upperKeysMap;\n};\n\n/**\n * Parses the passed macro with the passed data and returns the resulting parsed Macro.\n * If no CACHEBUSTING property is passed in the data it will generate a random one on its own.\n * If no TIMESTAMP property is passed in the data it will generate a one on its own.\n *\n * @ignore\n * @param {string} macro - The string macro to be parsed.\n * @param {Object} data - The data used by the macro.\n * @returns {string} - The parsed macro.\n * @static\n */\nvar parseMacro = function parseMacro(macro) {\n  var data = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n  var parsedMacro = macro;\n  var macroData = toUpperKeys(data);\n\n  if (!Boolean(macroData.CACHEBUSTING)) {\n    macroData.CACHEBUSTING = Math.round(Math.random() * 1.0e+10);\n  }\n\n  if (!Boolean(macroData.TIMESTAMP)) {\n    macroData.TIMESTAMP = new Date().toISOString();\n  }\n\n  Object.keys(macroData).forEach(function (key) {\n    var value = encodeURIComponent(macroData[key]);\n\n    parsedMacro = parsedMacro.replace(new RegExp('\\\\[' + key + '\\\\]', 'gm'), value);\n  });\n\n  return parsedMacro;\n};\n\n/**\n * Creates a tracking image with the passed URL macro.\n *\n * @type TrackerFn\n * @name pixelTracker\n * @param {string} URLMacro - URL Macro that need to be tracked.\n * @param {Object} data - Data Object with the macros's variables.\n * @returns {HTMLImageElement} - Image element whose source is the parsed URL Macro.\n * @static\n */\nvar pixelTracker = function pixelTracker(URLMacro, data) {\n  var img = new Image();\n\n  img.src = parseMacro(URLMacro, data);\n\n  return img;\n};\n\n/**\n * Tracks an error.\n *\n * @ignore\n * @param {VastChain} vastChain - the ad VAST Chain.\n * @param {Object} options - Options Map. The allowed properties are:\n * @param {Object} [options.logger] - Optional logger instance.\n *                                    Must comply to the [Console interface](https://developer.mozilla.org/es/docs/Web/API/Console).\n *                                    Defaults to console.\n * @param {tracker} [options.tracker] - optional tracker to use for the actual tracking. Defaults to the pixel tracker.\n * @param {string} [options.errorCode] - error code. Needed if we are tracking an error.\n */\nvar trackError = function trackError(vastChain, _ref) {\n  var errorCode = _ref.errorCode,\n      _ref$tracker = _ref.tracker,\n      tracker = _ref$tracker === undefined ? pixelTracker : _ref$tracker;\n\n  vastChain.forEach(function (_ref2) {\n    var ad = _ref2.ad,\n        parsedXML = _ref2.parsedXML;\n\n    var errorURI = getAdErrorURI(ad) || getVastErrorURI(parsedXML);\n\n    if (Boolean(errorURI)) {\n      tracker(errorURI, { errorCode: errorCode });\n    }\n  });\n};\n\nvar trackIconView = function trackIconView(vastChain, _ref) {\n  var data = _ref.data,\n      _ref$tracker = _ref.tracker,\n      tracker = _ref$tracker === undefined ? pixelTracker : _ref$tracker;\n  var iconViewTracking = data.iconViewTracking;\n\n\n  if (Array.isArray(iconViewTracking)) {\n    var _iteratorNormalCompletion = true;\n    var _didIteratorError = false;\n    var _iteratorError = undefined;\n\n    try {\n      for (var _iterator = iconViewTracking[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n        var trackUrl = _step.value;\n\n        tracker(trackUrl, _extends({}, data));\n      }\n    } catch (err) {\n      _didIteratorError = true;\n      _iteratorError = err;\n    } finally {\n      try {\n        if (!_iteratorNormalCompletion && _iterator.return) {\n          _iterator.return();\n        }\n      } finally {\n        if (_didIteratorError) {\n          throw _iteratorError;\n        }\n      }\n    }\n  }\n};\n\nvar trackIconClick = function trackIconClick(vastChain, _ref) {\n  var data = _ref.data,\n      _ref$tracker = _ref.tracker,\n      tracker = _ref$tracker === undefined ? pixelTracker : _ref$tracker;\n  var iconClickTracking = data.iconClickTracking;\n\n\n  if (Array.isArray(iconClickTracking)) {\n    var _iteratorNormalCompletion = true;\n    var _didIteratorError = false;\n    var _iteratorError = undefined;\n\n    try {\n      for (var _iterator = iconClickTracking[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n        var trackUrl = _step.value;\n\n        tracker(trackUrl, _extends({}, data));\n      }\n    } catch (err) {\n      _didIteratorError = true;\n      _iteratorError = err;\n    } finally {\n      try {\n        if (!_iteratorNormalCompletion && _iterator.return) {\n          _iterator.return();\n        }\n      } finally {\n        if (_didIteratorError) {\n          throw _iteratorError;\n        }\n      }\n    }\n  }\n};\n\nvar trackProgress = function trackProgress(vastChain, _ref) {\n  var data = _ref.data,\n      _ref$tracker = _ref.tracker,\n      tracker = _ref$tracker === undefined ? pixelTracker : _ref$tracker;\n  var progressUri = data.progressUri;\n\n\n  if (Boolean(progressUri)) {\n    tracker(progressUri, _extends({}, data));\n  }\n};\n\nvar createVastEventTracker = function createVastEventTracker(vastChainSelector) {\n  return function (vastChain, _ref) {\n    var data = _ref.data,\n        _ref$tracker = _ref.tracker,\n        tracker = _ref$tracker === undefined ? pixelTracker : _ref$tracker;\n\n    vastChain.forEach(function (_ref2) {\n      var ad = _ref2.ad;\n\n      var value = vastChainSelector(ad);\n\n      if (Boolean(value)) {\n        switch (true) {\n          case typeof value === 'string':\n            {\n              tracker(value, data);\n              break;\n            }\n          case Array.isArray(value):\n            {\n              value.map(function (_ref3) {\n                var uri = _ref3.uri;\n                return tracker(uri, data);\n              });\n              break;\n            }\n        }\n      }\n    });\n  };\n};\n\nvar _linearTrackers;\n\nvar clickTrackingSelector = function clickTrackingSelector(ad) {\n  var trackingURIs = [];\n  var clickTrackings = getClickTracking(ad);\n  var customClicks = getCustomClick(ad);\n\n  /* istanbul ignore else */\n  if (Array.isArray(clickTrackings) && clickTrackings.length > 0) {\n    trackingURIs.push.apply(trackingURIs, toConsumableArray(clickTrackings.map(function (uri) {\n      return { uri: uri };\n    })));\n  }\n\n  /* istanbul ignore else */\n  if (Array.isArray(customClicks) && customClicks.length > 0) {\n    trackingURIs.push.apply(trackingURIs, toConsumableArray(customClicks.map(function (uri) {\n      return { uri: uri };\n    })));\n  }\n\n  return trackingURIs;\n};\n\nvar linearTrackingEventSelector = function linearTrackingEventSelector(event) {\n  return function (ad) {\n    return getLinearTrackingEvents(ad, event);\n  };\n};\nvar linearTrackers = (_linearTrackers = {}, defineProperty(_linearTrackers, clickThrough, createVastEventTracker(clickTrackingSelector)), defineProperty(_linearTrackers, closeLinear, createVastEventTracker(linearTrackingEventSelector(closeLinear))), defineProperty(_linearTrackers, complete, createVastEventTracker(linearTrackingEventSelector(complete))), defineProperty(_linearTrackers, error, trackError), defineProperty(_linearTrackers, exitFullscreen, createVastEventTracker(linearTrackingEventSelector(exitFullscreen))), defineProperty(_linearTrackers, firstQuartile, createVastEventTracker(linearTrackingEventSelector(firstQuartile))), defineProperty(_linearTrackers, fullscreen, createVastEventTracker(linearTrackingEventSelector(fullscreen))), defineProperty(_linearTrackers, iconClick, trackIconClick), defineProperty(_linearTrackers, iconView, trackIconView), defineProperty(_linearTrackers, impression, createVastEventTracker(getImpressionUri)), defineProperty(_linearTrackers, midpoint, createVastEventTracker(linearTrackingEventSelector(midpoint))), defineProperty(_linearTrackers, mute, createVastEventTracker(linearTrackingEventSelector(mute))), defineProperty(_linearTrackers, pause, createVastEventTracker(linearTrackingEventSelector(pause))), defineProperty(_linearTrackers, playerCollapse, createVastEventTracker(linearTrackingEventSelector(playerCollapse))), defineProperty(_linearTrackers, playerExpand, createVastEventTracker(linearTrackingEventSelector(playerExpand))), defineProperty(_linearTrackers, progress, trackProgress), defineProperty(_linearTrackers, resume, createVastEventTracker(linearTrackingEventSelector(resume))), defineProperty(_linearTrackers, rewind, createVastEventTracker(linearTrackingEventSelector(rewind))), defineProperty(_linearTrackers, skip, createVastEventTracker(linearTrackingEventSelector(skip))), defineProperty(_linearTrackers, start, createVastEventTracker(linearTrackingEventSelector(start))), defineProperty(_linearTrackers, thirdQuartile, createVastEventTracker(linearTrackingEventSelector(thirdQuartile))), defineProperty(_linearTrackers, unmute, createVastEventTracker(linearTrackingEventSelector(unmute))), _linearTrackers);\n\n/**\n * Tracks the passed linear event.\n *\n * @ignore\n * @param {string} event - name of the linear event we need to track. @see LinearEvents\n * @param {VastChain} vastChain - the ad VAST Chain.\n * @param {Object} options - Options Map. The allowed properties are:\n * @param {Object} [options.logger] - Optional logger instance.\n *                                    Must comply to the [Console interface](https://developer.mozilla.org/es/docs/Web/API/Console).\n *                                    Defaults to console.\n * @param {Object} [options.data] - additional data for the URL macro. See [VAST specification]{@link https://www.iab.com/guidelines/digital-video-ad-serving-template-vast-4-0/}\n * @param {tracker} [options.tracker] - optional tracker to use for the actual tracking. Defaults to the pixel tracker.\n * @param {string} [options.errorCode] - error code. Needed if we are tracking an error.\n */\nvar trackLinearEvent = function trackLinearEvent(event, vastChain, _ref) {\n  var data = _ref.data,\n      errorCode = _ref.errorCode,\n      _ref$tracker = _ref.tracker,\n      tracker = _ref$tracker === undefined ? pixelTracker : _ref$tracker,\n      _ref$logger = _ref.logger,\n      logger = _ref$logger === undefined ? console : _ref$logger;\n\n  var linearTracker = linearTrackers[event];\n\n  if (linearTracker) {\n    linearTracker(vastChain, {\n      data: _extends({}, data, {\n        errorCode: errorCode\n      }),\n      errorCode: errorCode,\n      tracker: tracker\n    });\n  } else {\n    logger.error('Event \\'' + event + '\\' cannot be tracked');\n  }\n};\n\nvar _linearTrackers$1;\n\nvar trackingEventSelector = function trackingEventSelector(event) {\n  return function (ad) {\n    return getNonLinearTrackingEvents(ad, event);\n  };\n};\nvar linearTrackers$1 = (_linearTrackers$1 = {}, defineProperty(_linearTrackers$1, acceptInvitation, createVastEventTracker(trackingEventSelector(acceptInvitation))), defineProperty(_linearTrackers$1, adCollapse, createVastEventTracker(trackingEventSelector(adCollapse))), defineProperty(_linearTrackers$1, close, createVastEventTracker(trackingEventSelector(close))), defineProperty(_linearTrackers$1, creativeView, createVastEventTracker(trackingEventSelector(creativeView))), _linearTrackers$1);\n\n/**\n * Tracks the passed non linear event.\n *\n * @ignore\n * @param {string} event - name of the linear event we need to track. @see LinearEvents\n * @param {VastChain} vastChain - the ad VAST Chain.\n * @param {Object} options - Options Map. The allowed properties are:\n * @param {Object} [options.logger] - Optional logger instance.\n *                                    Must comply to the [Console interface](https://developer.mozilla.org/es/docs/Web/API/Console).\n *                                    Defaults to console.\n * @param {Object} [options.data] - additional data for the URL macro. See [VAST specification]{@link https://www.iab.com/guidelines/digital-video-ad-serving-template-vast-4-0/}\n * @param {tracker} [options.tracker] - optional tracker to use for the actual tracking. Defaults to the pixel tracker.\n */\nvar trackNonLinearEvent = function trackNonLinearEvent(event, vastChain, _ref) {\n  var data = _ref.data,\n      _ref$tracker = _ref.tracker,\n      tracker = _ref$tracker === undefined ? pixelTracker : _ref$tracker,\n      _ref$logger = _ref.logger,\n      logger = _ref$logger === undefined ? console : _ref$logger;\n\n  var linearTracker = linearTrackers$1[event];\n\n  if (linearTracker) {\n    linearTracker(vastChain, {\n      data: _extends({}, data),\n      tracker: tracker\n    });\n  } else {\n    logger.error('Event \\'' + event + '\\' cannot be tracked');\n  }\n};\n\n/**\n * Loads the script source.\n *\n * @ignore\n * @param {string} src - The script source.\n * @param {Object} options - The allowed options are:\n *                           type: Defaults to 'text/javascript'.\n *                           async<Boolean> : if \"true\" the \"async\" attribute is added to the new script. Defaults to false.\n *                           defer<Boolean> : if \"true\" the \"defer\" attribute is added to the new script. Defaults to false.\n *                           placeholder: Element that should contain the script. Defaults to the parentNode of the currentScript or\n *                                        if missing to document.head .\n */\nvar loadScript = function loadScript(src) {\n  var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n      _ref$async = _ref.async,\n      async = _ref$async === undefined ? false : _ref$async,\n      _ref$defer = _ref.defer,\n      defer = _ref$defer === undefined ? false : _ref$defer,\n      _ref$type = _ref.type,\n      type = _ref$type === undefined ? 'text/javascript' : _ref$type,\n      placeholder = _ref.placeholder;\n\n  if (!src) {\n    throw new TypeError('Missing required \"src\" parameter');\n  }\n\n  return new Promise(function (resolve, reject) {\n    var script = document.createElement('script');\n    var scriptPlaceholder = placeholder;\n\n    script.type = type;\n    script.async = async;\n    script.defer = defer;\n    script.onerror = function () {\n      return reject(new URIError('The script ' + src + ' is not accessible.'));\n    };\n    script.onload = function () {\n      return resolve(script);\n    };\n\n    if (!scriptPlaceholder) {\n      scriptPlaceholder = document.currentScript ?\n      /* istanbul ignore next */\n      document.currentScript.parentNode : document.head;\n    }\n\n    script.src = src;\n    scriptPlaceholder.appendChild(script);\n  });\n};\n\nvar createAdVideoElement = function createAdVideoElement() {\n  var contentDocument = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : document;\n\n  var video = contentDocument.createElement('VIDEO');\n\n  video.style.width = '100%';\n  video.style.height = '100%';\n\n  return video;\n};\n\nvar createAdContainer = function createAdContainer() {\n  var adContainer = document.createElement('DIV');\n\n  adContainer.classList.add('mol-video-ad-container');\n  adContainer.style.width = '100%';\n  adContainer.style.height = '100%';\n\n  return adContainer;\n};\n\nvar getContentDocument = function getContentDocument(iframeElement) {\n  return iframeElement.contentDocument ||\n  /* istanbul ignore next */\n  iframeElement.contentWindow && iframeElement.contentWindow.document;\n};\n\nvar getOrigin = function getOrigin() {\n  var location = window.location;\n\n  /* istanbul ignore else */\n  if (location.origin) {\n    return location.origin;\n  } else {\n    return location.protocol + '//' + location.hostname + (location.port ? ':' + location.port : '');\n  }\n};\n\nvar supported = 'srcdoc' in document.createElement('iframe');\nvar supportsSrcdoc = function supportsSrcdoc() {\n  return supported;\n};\n\nvar iframeContent = function iframeContent(id, targetOrigin) {\n  return '<!DOCTYPE html>\\n<html>\\n  <head><meta charset=\\'UTF-8\\'></head>\\n  <body style=\\'margin:0;padding:0\\'>\\n  <script type=\\'text/javascript\\'>window.parent.postMessage(\\'' + id + '_ready\\', \\'' + targetOrigin + '\\');</script>\\n  </body>\\n</html>';\n};\n\nvar createBaseIframe = function createBaseIframe() {\n  var iframe = document.createElement('IFRAME');\n\n  iframe.sandbox = 'allow-forms allow-popups allow-scripts allow-same-origin';\n  iframe.style.margin = '0';\n  iframe.style.padding = '0';\n  iframe.style.border = 'none';\n  iframe.style.width = '0';\n  iframe.style.height = '0';\n  iframe.style.position = 'absolute';\n\n  return iframe;\n};\n\nvar createIframe = function createIframe(placeholder, id) {\n  return new Promise(function (resolve, reject) {\n    var content = iframeContent(id, getOrigin());\n    var iframe = void 0;\n\n    /*\n      NOTE: favor about:blank instead of srcdoc because some browsers\n    */\n    try {\n      iframe = createBaseIframe();\n      iframe.src = 'about:blank';\n      placeholder.appendChild(iframe);\n      getContentDocument(iframe).write(content);\n    } catch (error) {\n      placeholder.removeChild(iframe);\n\n      if (supportsSrcdoc()) {\n        iframe = createBaseIframe();\n        iframe.src = 'about:srcdoc';\n        iframe.srcdoc = content;\n        placeholder.appendChild(iframe);\n      } else {\n        reject(error);\n      }\n    }\n\n    var handleMessage = function handleMessage(_ref) {\n      var data = _ref.data;\n\n      /* istanbul ignore else */\n      if (data === id + '_ready') {\n        window.removeEventListener('message', handleMessage);\n        resolve(iframe);\n      }\n    };\n\n    window.addEventListener('message', handleMessage, false);\n  });\n};\n\n/**\n * unique will create a unique string every time is called, sequentially and namespaced\n *\n * @ignore\n * @param {string} namespace\n */\nvar unique = function unique(namespace) {\n  var count = -1;\n\n  return function () {\n    return namespace + '_' + ++count;\n  };\n};\n\nvar nextId = unique('videoAdContainer');\nvar hidden = Symbol('hidden');\n\n/**\n * @class\n * @alias VideoAdContainer\n * @description This class provides everything necessary to contain and create a video ad within a given placeholder Element.\n */\n\nvar VideoAdContainer = function () {\n\n  /**\n   * Creates a VideoAdContainer.\n   *\n   * @param {HTMLDivElement} placeholder - DIV that will contain the ad.\n   * @param {HTMLVideoElement} [videoElement] - optional videoElement that will be used to play the ad.\n   */\n  function VideoAdContainer(placeholder) {\n    var videoElement = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n    classCallCheck(this, VideoAdContainer);\n    this[hidden] = {\n      destroyed: false,\n      iframe: null,\n      readyPromise: null\n    };\n\n    if (!(placeholder instanceof Element)) {\n      throw new TypeError('placeholder is not an Element');\n    }\n\n    this[hidden].id = nextId();\n    this.element = createAdContainer();\n    this.executionContext = null;\n\n    this.isOriginalVideoElement = Boolean(videoElement);\n\n    if (videoElement) {\n      this.videoElement = videoElement;\n    } else {\n      this.videoElement = createAdVideoElement();\n      this.element.appendChild(this.videoElement);\n    }\n\n    placeholder.appendChild(this.element);\n  }\n\n  /**\n   * Adds the passed script to the ad container.\n   *\n   * @param {string} src - script source uri.\n   * @param {Object} options - Options map.\n   * @param {string} options.type - Defaults to 'text/javascript'.\n   * @param {boolean} options.async - if \"true\" the \"async\" attribute is added to the new script. Defaults to false.\n   * @param {boolean} options.defer - if \"true\" the \"defer\" attribute is added to the new script. Defaults to true.\n   */\n\n\n  createClass(VideoAdContainer, [{\n    key: 'addScript',\n    value: function () {\n      var _ref = asyncToGenerator( /*#__PURE__*/regenerator.mark(function _callee(src) {\n        var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n        var placeholder;\n        return regenerator.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (!this.isDestroyed()) {\n                  _context.next = 2;\n                  break;\n                }\n\n                throw new Error('VideoAdContainer has been destroyed');\n\n              case 2:\n                if (this[hidden].iframe) {\n                  _context.next = 7;\n                  break;\n                }\n\n                _context.next = 5;\n                return createIframe(this.element, this[hidden].id);\n\n              case 5:\n                this[hidden].iframe = _context.sent;\n\n                this.executionContext = this[hidden].iframe.contentWindow;\n\n              case 7:\n                placeholder = getContentDocument(this[hidden].iframe).body;\n                return _context.abrupt('return', loadScript(src, _extends({\n                  placeholder: placeholder\n                }, options)));\n\n              case 9:\n              case 'end':\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function addScript(_x2) {\n        return _ref.apply(this, arguments);\n      }\n\n      return addScript;\n    }()\n\n    /**\n     * Destroys the VideoAdContainer.\n     */\n\n  }, {\n    key: 'destroy',\n    value: function destroy() {\n      this.element.parentNode.removeChild(this.element);\n      this[hidden].destroyed = true;\n    }\n\n    /**\n     * Checks if the container is destroyed.\n     *\n     * @returns {boolean} - true if the container is destroyed and false otherwise.\n     */\n\n  }, {\n    key: 'isDestroyed',\n    value: function isDestroyed() {\n      return this[hidden].destroyed;\n    }\n  }]);\n  return VideoAdContainer;\n}();\n\n/**\n * @function\n * @description VideoAdContainer factory method. Returns a VideoAdContainer instance that will contain the video ad.\n *\n * @ignore\n * @static\n * @param {HTMLElement} placeholder - Placeholder element that will contain the video ad.\n * @param {HTMLVideoElement} [videoElement] - optional videoElement that will be used to play the ad.\n *\n * @returns {VideoAdContainer} - Returns a `VideoAdContainer` instance.\n */\nvar createVideoAdContainer = function createVideoAdContainer(placeholder, videoElement) {\n  if (!placeholder) {\n    throw new TypeError('placeholder is required');\n  }\n\n  return new VideoAdContainer(placeholder, videoElement);\n};\n\n/* eslint-disable id-match*/\nvar guessMimeType = function guessMimeType(src) {\n  var mimeMap = {\n    '3gp': 'video/3gpp',\n    avi: 'video/x-msvideo',\n    flv: 'video/x-flv',\n    m3u8: 'application/x-mpegURL',\n    m4v: 'video/mp4',\n    mov: 'video/quicktime',\n    mp4: 'video/mp4',\n    mpd: 'application/dash+xml',\n    ogv: 'video/ogg',\n    ts: 'video/MP2T',\n    webm: 'video/webm',\n    wmv: 'video/x-ms-wmv'\n  };\n  var match = src.match(/\\.([^./?]+)(\\?[^/]+)?$/i);\n  var ext = match && match[1];\n\n  return mimeMap[ext] || 'video/' + ext;\n};\n\nvar canPlay = function canPlay(videoElement, mediaFile) {\n  var src = mediaFile.src,\n      type = mediaFile.type;\n\n\n  return videoElement.canPlayType(type || guessMimeType(src));\n};\n\nvar sortMediaByBestFit = function sortMediaByBestFit(mediaFiles, screenRect) {\n  var screenWidth = screenRect.width;\n  var compareTo = function compareTo(mediaFileA, mediaFileB) {\n    var deltaA = Math.abs(screenWidth - (mediaFileA.width || 0));\n    var deltaB = Math.abs(screenWidth - (mediaFileB.width || 0));\n\n    return deltaA - deltaB;\n  };\n\n  return mediaFiles.slice(0).sort(compareTo);\n};\n\nvar findBestMedia = function findBestMedia(inlineAd, videoElement, container) {\n  var screenRect = container.getBoundingClientRect();\n  var mediaFiles = getMediaFiles(inlineAd);\n\n  if (mediaFiles) {\n    var supportedMediaFiles = mediaFiles.filter(function (mediaFile) {\n      return canPlay(videoElement, mediaFile);\n    });\n    var sortedMediaFiles = sortMediaByBestFit(supportedMediaFiles, screenRect);\n\n    return sortedMediaFiles[0];\n  }\n\n  return null;\n};\n\nvar once = function once(element, eventName, listener) {\n  var handler = function handler() {\n    element.removeEventListener(eventName, handler);\n\n    return listener.apply(undefined, arguments);\n  };\n\n  element.addEventListener(eventName, handler);\n\n  return function () {\n    element.removeEventListener(eventName, handler);\n  };\n};\n\nvar progress$1 = linearEvents.progress;\n\n\nvar getProgressEvents = function getProgressEvents(vastChain) {\n  return vastChain.map(function (_ref) {\n    var ad = _ref.ad;\n    return ad;\n  }).reduce(function (accumulated, ad) {\n    var events = getLinearTrackingEvents(ad, progress$1) || [];\n\n    return [].concat(toConsumableArray(accumulated), toConsumableArray(events));\n  }, []).map(function (_ref2) {\n    var offset = _ref2.offset,\n        uri = _ref2.uri;\n    return {\n      offset: offset,\n      uri: uri\n    };\n  });\n};\n\nvar safeCallback = function safeCallback(callback, logger) {\n  return function () {\n    try {\n      // eslint-disable-next-line callback-return, promise/prefer-await-to-callbacks\n      callback.apply(undefined, arguments);\n    } catch (error) {\n      if (logger) {\n        logger.error(error);\n      }\n    }\n  };\n};\n\n/* eslint-disable promise/prefer-await-to-callbacks, callback-return */\n\nvar fullscreenElement = function fullscreenElement() {\n  return document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement || null;\n};\n\nvar fullscreen$1 = linearEvents.fullscreen,\n    exitFullscreen$1 = linearEvents.exitFullscreen,\n    playerCollapse$1 = linearEvents.playerCollapse,\n    playerExpand$1 = linearEvents.playerExpand;\n\n\nvar onFullscreenChange = function onFullscreenChange(_ref, callback) {\n  var videoElement = _ref.videoElement;\n\n  var fullscreenEvtNames = ['webkitfullscreenchange', 'mozfullscreenchange', 'fullscreenchange', 'MSFullscreenChange'];\n  var fullscreenOn = false;\n  var fullscreenchangeHandler = function fullscreenchangeHandler() {\n    if (fullscreenElement() === videoElement) {\n      fullscreenOn = true;\n      callback(playerExpand$1);\n      callback(fullscreen$1);\n    } else if (fullscreenOn) {\n      fullscreenOn = false;\n      callback(playerCollapse$1);\n      callback(exitFullscreen$1);\n    }\n  };\n\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = fullscreenEvtNames[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var event = _step.value;\n\n      document.addEventListener(event, fullscreenchangeHandler);\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator.return) {\n        _iterator.return();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n\n  return function () {\n    var _iteratorNormalCompletion2 = true;\n    var _didIteratorError2 = false;\n    var _iteratorError2 = undefined;\n\n    try {\n      for (var _iterator2 = fullscreenEvtNames[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n        var _event = _step2.value;\n\n        document.removeEventListener(_event, fullscreenchangeHandler);\n      }\n    } catch (err) {\n      _didIteratorError2 = true;\n      _iteratorError2 = err;\n    } finally {\n      try {\n        if (!_iteratorNormalCompletion2 && _iterator2.return) {\n          _iterator2.return();\n        }\n      } finally {\n        if (_didIteratorError2) {\n          throw _iteratorError2;\n        }\n      }\n    }\n  };\n};\n\n/* eslint-disable promise/prefer-await-to-callbacks, callback-return */\n\nvar pause$1 = linearEvents.pause,\n    resume$1 = linearEvents.resume;\n\n\nvar onPlayPause = function onPlayPause(_ref, callback) {\n  var videoElement = _ref.videoElement;\n\n  var started = false;\n  var paused = true;\n\n  var playHandler = function playHandler() {\n    if (!started) {\n      started = true;\n      paused = false;\n    } else if (paused) {\n      paused = false;\n      callback(resume$1);\n    }\n  };\n\n  var pauseHandler = function pauseHandler() {\n    if (!paused) {\n      paused = true;\n      callback(pause$1);\n    }\n  };\n\n  videoElement.addEventListener('play', playHandler);\n  videoElement.addEventListener('pause', pauseHandler);\n\n  return function () {\n    videoElement.removeEventListener('play', playHandler);\n    videoElement.removeEventListener('pause', pauseHandler);\n  };\n};\n\n/* eslint-disable promise/prefer-await-to-callbacks, callback-return */\n\nvar rewind$1 = linearEvents.rewind;\n\nvar onRewind = function onRewind(_ref, callback) {\n  var videoElement = _ref.videoElement;\n\n  var currentTime = videoElement.currentTime;\n\n  var timeupdateHandler = function timeupdateHandler() {\n    var delta = videoElement.currentTime - currentTime;\n\n    if (delta < 0 && Math.abs(delta) >= 1) {\n      callback(rewind$1);\n    }\n\n    currentTime = videoElement.currentTime;\n  };\n\n  videoElement.addEventListener('timeupdate', timeupdateHandler);\n\n  return function () {\n    videoElement.removeEventListener('timeupdate', timeupdateHandler);\n  };\n};\n\n/* eslint-disable callback-return, promise/prefer-await-to-callbacks */\n\nvar skip$1 = linearEvents.skip;\n\nvar createDefaultSkipControl = function createDefaultSkipControl() {\n  var skipBtn = document.createElement('BUTTON');\n\n  skipBtn.classList.add('mol-vast-skip-control');\n  skipBtn.type = 'button';\n  skipBtn.innerHTML = 'skip';\n  skipBtn.style.position = 'absolute';\n  skipBtn.style.bottom = '15px';\n  skipBtn.style.right = '15px';\n\n  return skipBtn;\n};\n\nvar onSkip = function onSkip(videoAdContainer, callback) {\n  var _ref = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {},\n      skipoffset = _ref.skipoffset,\n      _ref$createSkipContro = _ref.createSkipControl,\n      createSkipControl = _ref$createSkipContro === undefined ? createDefaultSkipControl : _ref$createSkipContro;\n\n  if (!Boolean(skipoffset)) {\n    return function () {};\n  }\n\n  var skipControl = void 0;\n  var videoElement = videoAdContainer.videoElement,\n      element = videoAdContainer.element;\n\n\n  var skipHandler = function skipHandler() {\n    var currentTimeMs = videoElement.currentTime * 1000;\n\n    if (!Boolean(skipControl) && currentTimeMs >= skipoffset) {\n      skipControl = createSkipControl();\n\n      skipControl.onclick = function (event) {\n        if (Event.prototype.stopPropagation !== undefined) {\n          event.stopPropagation();\n        }\n\n        callback(skip$1);\n\n        return false;\n      };\n\n      element.appendChild(skipControl);\n      videoElement.removeEventListener('timeupdate', skipHandler);\n    }\n  };\n\n  videoElement.addEventListener('timeupdate', skipHandler);\n\n  return function () {\n    videoElement.removeEventListener('timeupdate', skipHandler);\n    if (Boolean(skipControl)) {\n      element.removeChild(skipControl);\n    }\n  };\n};\n\n/* eslint-disable promise/prefer-await-to-callbacks, callback-return */\n\nvar error$1 = linearEvents.error;\n\n\nvar onError = function onError(_ref, callback) {\n  var videoElement = _ref.videoElement;\n\n  var errorHandler = function errorHandler() {\n    callback(error$1, videoElement.error);\n  };\n\n  videoElement.addEventListener('error', errorHandler);\n\n  return function () {\n    videoElement.removeEventListener('error', errorHandler);\n  };\n};\n\n/**\n * Fires when the adUnit's volume has changed.\n *\n * @event VideoAdUnit#volumeChanged\n */\nvar volumeChanged = 'volumeChanged';\n\n/**\n * Fires when the adUnit's has finished.\n *\n * @event VideoAdUnit#finish\n */\nvar finish = 'finish';\n\n/**\n * fires on ad progress.\n *\n * @event VideoAdUnit#adProgress\n */\nvar adProgress = 'adProgress';\n\n/* eslint-disable promise/prefer-await-to-callbacks, callback-return */\n\nvar complete$1 = linearEvents.complete,\n    firstQuartile$1 = linearEvents.firstQuartile,\n    midpoint$1 = linearEvents.midpoint,\n    start$1 = linearEvents.start,\n    thirdQuartile$1 = linearEvents.thirdQuartile;\n\nvar percentageProgress = function percentageProgress(currentTime, duration) {\n  return currentTime * 100 / duration;\n};\nvar isPassFirstQuartile = function isPassFirstQuartile(currentTime, duration) {\n  return percentageProgress(currentTime, duration) >= 25;\n};\nvar isPassMidPoint = function isPassMidPoint(currentTime, duration) {\n  return percentageProgress(currentTime, duration) >= 50;\n};\nvar isPassThirdQuartile = function isPassThirdQuartile(currentTime, duration) {\n  return percentageProgress(currentTime, duration) >= 75;\n};\nvar isCompleted = function isCompleted(currentTime, duration) {\n  return percentageProgress(currentTime, duration) >= 99;\n};\n\n// TODO: implement logic to track `timeSpentViewing` linear event\n\nvar onTimeUpdate = function onTimeUpdate(_ref, callback) {\n  var videoElement = _ref.videoElement;\n\n  var started = false;\n  var passFirstQuartile = false;\n  var passMidPoint = false;\n  var passThirdQuartile = false;\n  var completed = false;\n\n  // eslint-disable-next-line complexity\n  var timeupdateHandler = function timeupdateHandler() {\n    var duration = videoElement.duration;\n    var currentTime = videoElement.currentTime;\n\n    if (!started && currentTime > 0) {\n      started = true;\n      callback(start$1);\n    } else if (!passFirstQuartile) {\n      if (isPassFirstQuartile(currentTime, duration)) {\n        passFirstQuartile = true;\n        callback(firstQuartile$1);\n      }\n    } else if (!passMidPoint) {\n      if (isPassMidPoint(currentTime, duration)) {\n        passMidPoint = true;\n        callback(midpoint$1);\n      }\n    } else if (!passThirdQuartile) {\n      if (isPassThirdQuartile(currentTime, duration)) {\n        passThirdQuartile = true;\n        callback(thirdQuartile$1);\n      }\n    } else if (!completed) {\n      if (isCompleted(currentTime, duration)) {\n        completed = true;\n        callback(complete$1);\n      }\n    }\n\n    callback(adProgress);\n  };\n\n  var endedHandler = function endedHandler() {\n    var duration = videoElement.duration;\n    var currentTime = videoElement.currentTime;\n\n    if (!completed && isCompleted(currentTime, duration)) {\n      completed = true;\n      callback(complete$1);\n    }\n\n    videoElement.removeEventListener('ended', endedHandler);\n    videoElement.removeEventListener('timeupdate', timeupdateHandler);\n  };\n\n  videoElement.addEventListener('timeupdate', timeupdateHandler);\n  videoElement.addEventListener('ended', endedHandler);\n\n  return function () {\n    videoElement.removeEventListener('timeupdate', timeupdateHandler);\n    videoElement.removeEventListener('ended', endedHandler);\n  };\n};\n\n/* eslint-disable promise/prefer-await-to-callbacks, callback-return */\n\nvar mute$1 = linearEvents.mute,\n    unmute$1 = linearEvents.unmute;\n\nvar isMuted = function isMuted(videoElement) {\n  return videoElement.muted || videoElement.volume === 0;\n};\n\nvar onVolumeChange = function onVolumeChange(_ref, callback) {\n  var videoElement = _ref.videoElement;\n\n  var wasMuted = isMuted(videoElement);\n\n  var volumechangeHandler = function volumechangeHandler() {\n    callback(volumeChanged);\n\n    if (wasMuted && !isMuted(videoElement)) {\n      callback(unmute$1);\n    } else if (!wasMuted && isMuted(videoElement)) {\n      callback(mute$1);\n    }\n\n    wasMuted = isMuted(videoElement);\n  };\n\n  videoElement.addEventListener('volumechange', volumechangeHandler);\n\n  return function () {\n    videoElement.removeEventListener('volumechange', volumechangeHandler);\n  };\n};\n\n/* eslint-disable promise/prefer-await-to-callbacks, callback-return */\n\nvar impression$1 = linearEvents.impression;\n\n\nvar onImpression = function onImpression(_ref, callback) {\n  var videoElement = _ref.videoElement;\n\n  var impressionHandler = function impressionHandler() {\n    var currentTime = videoElement.currentTime;\n\n    if (currentTime >= 2) {\n      callback(impression$1);\n      videoElement.removeEventListener('timeupdate', impressionHandler);\n    }\n  };\n\n  videoElement.addEventListener('timeupdate', impressionHandler);\n\n  return function () {\n    videoElement.removeEventListener('timeupdate', impressionHandler);\n  };\n};\n\nvar toFixedDigits = function toFixedDigits(num, digits) {\n  var formattedNum = String(num);\n\n  while (formattedNum.length < digits) {\n    formattedNum = '0' + formattedNum;\n  }\n\n  return formattedNum;\n};\n\nvar formatProgress = function formatProgress(progress) {\n  var hours = Math.floor(progress / (60 * 60 * 1000));\n  var minutes = Math.floor(progress / (60 * 1000) % 60);\n  var seconds = Math.floor(progress / 1000 % 60);\n  var ms = progress % 1000;\n\n  return toFixedDigits(hours, 2) + ':' + toFixedDigits(minutes, 2) + ':' + toFixedDigits(seconds, 2) + '.' + toFixedDigits(ms, 3);\n};\n\n/* eslint-disable promise/prefer-await-to-callbacks, callback-return */\n\nvar progress$2 = linearEvents.progress;\n\nvar secondsToMilliseconds = function secondsToMilliseconds(seconds) {\n  return seconds * 1000;\n};\nvar isPercentage$1 = function isPercentage(offset) {\n  var percentageRegex = /^\\d+(\\.\\d+)?%$/g;\n\n  return percentageRegex.test(offset) && !isNaN(parseFloat(offset));\n};\n\nvar isValid = function isValid(_ref) {\n  var offset = _ref.offset,\n      uri = _ref.uri;\n\n  var offsetIsValid = typeof offset === 'number' || isPercentage$1(offset);\n  var uriIsValid = typeof uri === 'string' && uri.length > 0;\n\n  return offsetIsValid && uriIsValid;\n};\n\nvar offsetToMs = function offsetToMs(offset, durationInMs) {\n  if (typeof offset === 'number') {\n    return offset;\n  }\n\n  return parseFloat(offset) / 100 * durationInMs;\n};\n\nvar onProgress = function onProgress(_ref2, callback) {\n  var videoElement = _ref2.videoElement;\n\n  var _ref3 = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {},\n      _ref3$progressEvents = _ref3.progressEvents,\n      progressEvents = _ref3$progressEvents === undefined ? [] : _ref3$progressEvents;\n\n  var duration = videoElement.duration;\n\n  var durationInMs = secondsToMilliseconds(duration);\n  var playedMs = 0;\n  var previousCurrentTime = secondsToMilliseconds(videoElement.currentTime);\n  var pendingEvents = progressEvents.filter(isValid).map(function (_ref4) {\n    var offset = _ref4.offset,\n        uri = _ref4.uri;\n    return {\n      offset: offsetToMs(offset, durationInMs),\n      uri: uri\n    };\n  });\n\n  var progressHandler = function progressHandler() {\n    var currentTime = videoElement.currentTime;\n\n    var delta = Math.abs(currentTime - previousCurrentTime);\n\n    playedMs += secondsToMilliseconds(delta);\n    previousCurrentTime = currentTime;\n\n    var _pendingEvents$reduce = pendingEvents.reduce(function (accumulator, event) {\n      var offset = event.offset;\n\n\n      if (playedMs >= offset) {\n        accumulator.toCall.push(event);\n      } else {\n        accumulator.stillPending.push(event);\n      }\n\n      return accumulator;\n    }, {\n      stillPending: [],\n      toCall: []\n    }),\n        stillPending = _pendingEvents$reduce.stillPending,\n        toCall = _pendingEvents$reduce.toCall;\n\n    pendingEvents = stillPending;\n    toCall.forEach(function (_ref5) {\n      var uri = _ref5.uri;\n\n      callback(progress$2, {\n        contentplayhead: formatProgress(playedMs),\n        progressUri: uri\n      });\n    });\n\n    if (pendingEvents.length === 0) {\n      videoElement.removeEventListener('timeupdate', progressHandler);\n    }\n  };\n\n  if (pendingEvents.length > 0) {\n    videoElement.addEventListener('timeupdate', progressHandler);\n  }\n\n  return function () {\n    videoElement.removeEventListener('timeupdate', progressHandler);\n  };\n};\n\n/* eslint-disable callback-return, promise/prefer-await-to-callbacks */\n\nvar clickThrough$1 = linearEvents.clickThrough;\n\n\nvar onClickThrough = function onClickThrough(_ref, callback) {\n  var videoElement = _ref.videoElement,\n      element = _ref.element;\n\n  var _ref2 = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {},\n      clickThroughUrl = _ref2.clickThroughUrl;\n\n  var placeholder = element || videoElement.parentNode;\n  var anchor = document.createElement('A');\n\n  anchor.classList.add('mol-vast-clickthrough');\n  anchor.style.width = '100%';\n  anchor.style.height = '100%';\n  anchor.style.position = 'absolute';\n  anchor.style.left = 0;\n  anchor.style.top = 0;\n\n  if (clickThroughUrl) {\n    anchor.href = clickThroughUrl;\n    anchor.target = '_blank';\n  }\n\n  anchor.onclick = function (event) {\n    if (Event.prototype.stopPropagation !== undefined) {\n      event.stopPropagation();\n    }\n\n    if (videoElement.paused) {\n      videoElement.play();\n    } else {\n      videoElement.pause();\n\n      callback(clickThrough$1);\n    }\n  };\n\n  placeholder.appendChild(anchor);\n\n  return function () {\n    return placeholder.removeChild(anchor);\n  };\n};\n\n/* eslint-disable import/max-dependencies */\n\nvar handlers = [onClickThrough, onError, onFullscreenChange, onImpression, onPlayPause, onProgress, onRewind, onSkip, onTimeUpdate, onVolumeChange];\n\n/* eslint-disable promise/prefer-await-to-callbacks */\n\nvar setupMetricHandlers = function setupMetricHandlers(_ref, callback) {\n  var vastChain = _ref.vastChain,\n      videoAdContainer = _ref.videoAdContainer,\n      hooks = _ref.hooks;\n\n  var inlineAd = vastChain[0].ad;\n  var skipoffset = getSkipOffset(inlineAd);\n  var clickThroughUrl = getClickThrough(inlineAd);\n  var progressEvents = getProgressEvents(vastChain);\n  var data = _extends({\n    clickThroughUrl: clickThroughUrl,\n    progressEvents: progressEvents,\n    skipoffset: skipoffset\n  }, hooks);\n\n  var stopHandlersFns = handlers.map(function (handler) {\n    return safeCallback(handler(videoAdContainer, callback, data));\n  });\n\n  return function () {\n    return stopHandlersFns.forEach(function (disconnect) {\n      return disconnect();\n    });\n  };\n};\n\nvar updateMedia = function updateMedia(videoElement, media) {\n  return new Promise(function (resolve) {\n    var state = {\n      currentTime: videoElement.currentTime,\n      playing: !videoElement.paused\n    };\n\n    if (state.playing) {\n      videoElement.pause();\n    }\n\n    videoElement.src = media.src;\n    videoElement.load();\n\n    once(videoElement, 'loadeddata', function () {\n      videoElement.currentTime = state.currentTime;\n\n      if (state.playing) {\n        videoElement.play();\n      }\n\n      resolve();\n    });\n  });\n};\n\n/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as the `TypeError` message for \"Functions\" methods. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/** Used to match leading and trailing whitespace. */\nvar reTrim = /^\\s+|\\s+$/g;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof commonjsGlobal == 'object' && commonjsGlobal && commonjsGlobal.Object === Object && commonjsGlobal;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        result = wait - timeSinceLastCall;\n\n    return maxing ? nativeMin(result, maxWait - timeSinceLastInvoke) : result;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && objectToString.call(value) == symbolTag);\n}\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = value.replace(reTrim, '');\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nvar lodash_debounce = debounce;\n\nvar MutationObserver = window.MutationObserver || window.WebKitMutationObserver || window.MozMutationObserver;\n\n/* eslint-disable promise/prefer-await-to-callbacks */\n\nvar validate = function validate(target, callback) {\n  if (!(target instanceof Element)) {\n    throw new TypeError('Target is not an Element node');\n  }\n\n  if (!(callback instanceof Function)) {\n    throw new TypeError('Callback is not a function');\n  }\n};\nvar noop = function noop() {};\nvar sizeMutationAttrs = ['style', 'clientWidth', 'clientHeight'];\nvar createResizeMO = function createResizeMO(target, callback) {\n  var observer = new MutationObserver(function (mutations) {\n    for (var index = 0; index < mutations.length; index++) {\n      var attributeName = mutations[index].attributeName;\n\n\n      if (sizeMutationAttrs.includes(attributeName)) {\n        // eslint-disable-next-line callback-return\n        callback();\n      }\n    }\n  });\n\n  observer.observe(target, {\n    attributes: true,\n    characterData: false,\n    childList: true\n  });\n\n  return observer;\n};\nvar mutationHandlers = Symbol('mutationHandlers');\nvar observerKey = Symbol('mutationObserver');\nvar onMutation = function onMutation(target, callback) {\n  if (!target[mutationHandlers]) {\n    target[mutationHandlers] = [];\n\n    var execHandlers = function execHandlers() {\n      for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      if (target[mutationHandlers]) {\n        target[mutationHandlers].forEach(function (handler) {\n          return handler.apply(undefined, args);\n        });\n      }\n    };\n\n    target[observerKey] = createResizeMO(target, execHandlers);\n  }\n\n  target[mutationHandlers].push(callback);\n\n  return function () {\n    target[mutationHandlers] = target[mutationHandlers].filter(function (handler) {\n      return handler !== callback;\n    });\n\n    if (target[mutationHandlers].length === 0) {\n      target[observerKey].disconnect();\n\n      delete target[mutationHandlers];\n      delete target[observerKey];\n    }\n  };\n};\n\nvar createResizeObjElement = function createResizeObjElement(callback) {\n  var obj = document.createElement('object');\n\n  // eslint-disable-next-line max-len\n  obj.setAttribute('style', 'display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; pointer-events: none; z-index: -1;');\n  obj.onload = function () {\n    if (this.contentWindow) {\n      this.contentWindow.addEventListener('resize', callback);\n    }\n  };\n  obj.type = 'text/html';\n  obj.data = 'about:blank';\n\n  return obj;\n};\nvar resizeHandlers = Symbol('resizeHandlers');\nvar resizeObject = Symbol('resizeObj');\n\n// Original code http://www.backalleycoder.com/2013/03/18/cross-browser-event-based-element-resize-detection/\nvar onResize = function onResize(target, callback) {\n  if (!target[resizeHandlers]) {\n    target[resizeHandlers] = [];\n    var execHandlers = function execHandlers() {\n      for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        args[_key2] = arguments[_key2];\n      }\n\n      if (target[resizeHandlers]) {\n        target[resizeHandlers].forEach(function (handler) {\n          return handler.apply(undefined, args);\n        });\n      }\n    };\n\n    target[resizeObject] = createResizeObjElement(execHandlers);\n\n    if (getComputedStyle(target).position === 'static') {\n      target.style.position = 'relative';\n    }\n\n    target.appendChild(target[resizeObject]);\n  }\n\n  target[resizeHandlers].push(callback);\n\n  return function () {\n    target[resizeHandlers] = target[resizeHandlers].filter(function (handler) {\n      return handler !== callback;\n    });\n\n    if (target[resizeHandlers].length === 0) {\n      target.removeChild(target[resizeObject]);\n      delete target[resizeHandlers];\n      delete target[resizeObject];\n    }\n  };\n};\n\nvar onElementResize = function onElementResize(target, callback) {\n  var _ref = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {},\n      _ref$threshold = _ref.threshold,\n      threshold = _ref$threshold === undefined ? 20 : _ref$threshold;\n\n  validate(target, callback);\n\n  var makeSizeId = function makeSizeId(_ref2) {\n    var style = _ref2.style,\n        clientHeight = _ref2.clientHeight,\n        clientWidth = _ref2.clientWidth;\n    return [style.width, style.height, clientWidth, clientHeight].join('.');\n  };\n  var lastSize = makeSizeId(target);\n  var checkElementSize = function checkElementSize() {\n    var currentSize = makeSizeId(target);\n\n    if (currentSize !== lastSize) {\n      lastSize = currentSize;\n      // eslint-disable-next-line callback-return\n      callback();\n    }\n  };\n\n  var checkElementHandler = lodash_debounce(checkElementSize, threshold);\n  var stopObservingMutations = Boolean(MutationObserver) ? onMutation(target, checkElementHandler) : noop;\n  var stopListeningToResize = onResize(target, checkElementHandler);\n\n  return function () {\n    stopObservingMutations();\n    stopListeningToResize();\n  };\n};\n\nvar isElementVisible = function isElementVisible(element) {\n  var viewabilityOffsetFraction = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n  var _element$getBoundingC = element.getBoundingClientRect(),\n      height = _element$getBoundingC.height,\n      width = _element$getBoundingC.width,\n      top = _element$getBoundingC.top,\n      right = _element$getBoundingC.right,\n      bottom = _element$getBoundingC.bottom,\n      left = _element$getBoundingC.left;\n\n  if (!height || !width) {\n    return false;\n  }\n\n  var verticalOffset = height * (1 - viewabilityOffsetFraction);\n  var horizontalOffset = width * (1 - viewabilityOffsetFraction);\n  var viewportHeight = window.innerHeight || document.documentElement.clientHeight;\n  var viewportWidth = window.innerWidth || document.documentElement.clientWidth;\n\n  return !document.hidden && top + verticalOffset >= 0 && bottom - verticalOffset <= viewportHeight && left + horizontalOffset >= 0 && right - horizontalOffset <= viewportWidth;\n};\n\n/* eslint-disable promise/prefer-await-to-callbacks */\n\nvar elementEntries = [];\n\nvar checkIsVisible = function checkIsVisible(entry) {\n  var element = entry.element,\n      callback = entry.callback,\n      lastInViewport = entry.lastInViewport,\n      viewportOffset = entry.viewportOffset;\n\n  var isInViewport = isElementVisible(element, viewportOffset);\n\n  if (isInViewport !== lastInViewport) {\n    entry.lastInViewport = isInViewport;\n\n    // eslint-disable-next-line callback-return\n    callback(isInViewport);\n  }\n};\n\nvar checkVisibility = function checkVisibility() {\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = elementEntries[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var entry = _step.value;\n\n      checkIsVisible(entry);\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator.return) {\n        _iterator.return();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n};\n\nvar validate$1 = function validate(target, callback) {\n  if (!(target instanceof Element)) {\n    throw new TypeError('Target is not an Element node');\n  }\n\n  if (!(callback instanceof Function)) {\n    throw new TypeError('Callback is not a function');\n  }\n};\n\nvar onElementVisibilityChange = function onElementVisibilityChange(target, callback) {\n  var _ref = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {},\n      _ref$threshold = _ref.threshold,\n      threshold = _ref$threshold === undefined ? 100 : _ref$threshold,\n      _ref$scrollableElemen = _ref.scrollableElement,\n      scrollableElement = _ref$scrollableElemen === undefined ? window : _ref$scrollableElemen,\n      _ref$viewabilityOffse = _ref.viewabilityOffset,\n      viewabilityOffset = _ref$viewabilityOffse === undefined ? 0.4 : _ref$viewabilityOffse;\n\n  validate$1(target, callback);\n\n  var viewportEventHandler = threshold > 0 ? lodash_debounce(checkVisibility) : checkVisibility;\n\n  var entry = {\n    callback: callback,\n    element: target,\n    lastInViewport: false,\n    scrollableElement: scrollableElement,\n    viewabilityOffset: viewabilityOffset\n  };\n\n  checkIsVisible(entry);\n  elementEntries.push(entry);\n\n  scrollableElement.addEventListener('scroll', viewportEventHandler);\n\n  if (elementEntries.length === 1) {\n    window.addEventListener('resize', viewportEventHandler);\n    window.addEventListener('orientationchange', viewportEventHandler);\n    document.addEventListener('visibilitychange', viewportEventHandler);\n  }\n\n  return function () {\n    elementEntries = elementEntries.filter(function (elementEntry) {\n      return elementEntry !== entry;\n    });\n\n    if (elementEntries.length === 0) {\n      window.removeEventListener('resize', viewportEventHandler);\n      window.removeEventListener('orientationchange', viewportEventHandler);\n      document.removeEventListener('visibilitychange', viewportEventHandler);\n    }\n\n    if (elementEntries.every(function (elementEntry) {\n      return elementEntry.scrollableElement !== scrollableElement;\n    })) {\n      scrollableElement.removeEventListener('scroll', viewportEventHandler);\n    }\n  };\n};\n\nvar preventManualProgress = function preventManualProgress(videoElement) {\n  // IOS video clock is very unreliable and we need a 3 seconds threshold to ensure that the user forwarded/rewound the ad\n  var PROGRESS_THRESHOLD = 3;\n  var previousTime = 0;\n  var skipAttempts = 0;\n\n  var preventAdSkip = function preventAdSkip() {\n    // Ignore ended event if the Ad time was not 'near' the end\n    // and revert time to the previous 'valid' time\n    if (videoElement.duration - previousTime > PROGRESS_THRESHOLD) {\n      // this reduces the video jitter if the IOS skip button is pressed\n      videoElement.pause();\n\n      // we need to trigger the play to put the video element back in a valid state\n      videoElement.play();\n      videoElement.currentTime = previousTime;\n    }\n  };\n\n  var preventAdSeek = function preventAdSeek() {\n    var currentTime = videoElement.currentTime;\n    var progressDelta = Math.abs(currentTime - previousTime);\n\n    if (progressDelta > PROGRESS_THRESHOLD) {\n      skipAttempts += 1;\n      if (skipAttempts >= 2) {\n        videoElement.pause();\n      }\n      videoElement.currentTime = previousTime;\n    } else {\n      previousTime = currentTime;\n    }\n  };\n\n  videoElement.addEventListener('timeupdate', preventAdSeek);\n  videoElement.addEventListener('ended', preventAdSkip);\n\n  return function () {\n    videoElement.removeEventListener('timeupdate', preventAdSeek);\n    videoElement.removeEventListener('ended', preventAdSkip);\n  };\n};\n\n/* eslint-disable filenames/match-exported */\n/**\n * @class\n * @description Subset of  node's [Emitter class]{@link https://nodejs.org/api/events.html#events_class_eventemitter}\n * @param {Object} logger - Optional logger instance. Must comply to the [Console interface]{@link https://developer.mozilla.org/es/docs/Web/API/Console}.\n */\nvar Emitter = function () {\n  function Emitter(logger) {\n    classCallCheck(this, Emitter);\n\n    this.evts = {};\n    this.logger = logger || console;\n  }\n\n  /**\n   * Adds the listener function to the end of the listeners array for the event named eventName.\n   *\n   * @param {string} eventName - The name of the event.\n   * @param {Function} listener - Listener fn that handles the evt.\n   * @returns {Emitter} - The Emitter instance.\n   */\n\n\n  createClass(Emitter, [{\n    key: \"on\",\n    value: function on(eventName, listener) {\n      var evts = this.evts;\n      var evtListeners = evts[eventName] || (evts[eventName] = []);\n\n      evtListeners.push(listener);\n\n      return this;\n    }\n\n    /**\n     * Removes the specified listener from the listener array for the event named eventName.\n     *\n     * @param {string} eventName - The name of the event.\n     * @param {Function} listener - Listener fn that handles the evt.\n     * @returns {Emitter} - The Emitter instance.\n     */\n\n  }, {\n    key: \"removeListener\",\n    value: function removeListener(eventName, listener) {\n      var evts = this.evts;\n      var evtListeners = evts[eventName] || (evts[eventName] = []);\n\n      evts[eventName] = evtListeners.filter(function (eListener) {\n        return eListener !== listener && eListener._ !== listener;\n      });\n\n      return this;\n    }\n\n    /**\n     * Removes all listeners, or those of the specified eventName.\n     *\n     * @param {string} eventName - The name of the event. Optional if omitted all listeners will be removed.\n     * @returns {Emitter} - The Emitter instance.\n     */\n\n  }, {\n    key: \"removeAllListeners\",\n    value: function removeAllListeners(eventName) {\n      if (eventName) {\n        this.evts[eventName] = null;\n      } else {\n        this.evts = {};\n      }\n\n      return this;\n    }\n\n    /**\n     * Adds a one time listener function for the event named eventName. The next time eventName is triggered,\n     * this listener is removed and then invoked.\n     *\n     * @param {string} eventName - The name of the event.\n     * @param {Function} listener - Listener fn that handles the evt.\n     * @returns {Emitter} - The Emitter instance.\n     */\n\n  }, {\n    key: \"once\",\n    value: function once(eventName, listener) {\n      var _this = this;\n\n      var handler = function handler() {\n        _this.removeListener(eventName, handler);\n        listener.apply(undefined, arguments);\n      };\n\n      handler._ = listener;\n\n      return this.on(eventName, handler);\n    }\n\n    /**\n     * Synchronously calls each of the listeners registered for the event named eventName, in the order they were registered,\n     * passing the supplied arguments to each.\n     *\n     * @param {string} eventName - The name of the event.\n     * @returns {boolean} - Returns true if the event had listeners, false otherwise.\n     */\n\n  }, {\n    key: \"emit\",\n    value: function emit(eventName) {\n      var _this2 = this;\n\n      for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        args[_key - 1] = arguments[_key];\n      }\n\n      var evts = this.evts;\n      var evtListeners = evts[eventName] || (evts[eventName] = []);\n      var hasListeners = evtListeners.length > 0;\n\n      evtListeners.forEach(function (handler) {\n        try {\n          handler.apply(undefined, args);\n        } catch (error) {\n          _this2.logger.error(error, error.stack);\n        }\n      });\n\n      return hasListeners;\n    }\n  }]);\n  return Emitter;\n}();\n\nvar getResource = function getResource() {\n  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      staticResource = _ref.staticResource,\n      htmlResource = _ref.htmlResource,\n      iFrameResource = _ref.iFrameResource;\n\n  return staticResource || htmlResource || iFrameResource;\n};\n\nvar UNKNOWN = 'UNKNOWN';\nvar uniqBy = function uniqBy(array, uniqValue) {\n  var seen = {};\n\n  return array.filter(function (item) {\n    var key = uniqValue(item);\n\n    if (seen.hasOwnProperty(key)) {\n      return false;\n    }\n\n    seen[key] = true;\n\n    return true;\n  });\n};\n\nvar uniqByResource = function uniqByResource(icons) {\n  return uniqBy(icons, getResource);\n};\n\nvar groupIconsByProgram = function groupIconsByProgram(icons) {\n  return icons.reduce(function (accumulator, icon) {\n    var _icon$program = icon.program,\n        program = _icon$program === undefined ? UNKNOWN : _icon$program;\n\n\n    if (!accumulator[program]) {\n      accumulator[program] = [];\n    }\n\n    accumulator[program].push(icon);\n\n    return accumulator;\n  }, {});\n};\n\nvar sortIconByBestPxratio = function sortIconByBestPxratio(icons) {\n  var devicePixelRatio = window.devicePixelRatio || 0;\n\n  var compareTo = function compareTo(iconA, iconB) {\n    var deltaA = Math.abs(devicePixelRatio - (iconA.pxratio || 0));\n    var deltaB = Math.abs(devicePixelRatio - (iconB.pxratio || 0));\n\n    return deltaA - deltaB;\n  };\n\n  return icons.slice(0).sort(compareTo);\n};\n\nvar chooseByPxRatio = function chooseByPxRatio(icons) {\n  if (icons.length === 1) {\n    return icons[0];\n  }\n\n  return sortIconByBestPxratio(icons)[0];\n};\n\nvar chooseIcons = function chooseIcons(icons) {\n  var byProgram = groupIconsByProgram(icons);\n  var programs = Object.keys(byProgram);\n\n  return programs.reduce(function (accumulator, program) {\n    if (program === UNKNOWN) {\n      return [].concat(toConsumableArray(accumulator), toConsumableArray(byProgram[UNKNOWN]));\n    }\n\n    return [].concat(toConsumableArray(accumulator), [chooseByPxRatio(byProgram[program])]);\n  }, []);\n};\n\nvar retrieveIcons = function retrieveIcons(vastChain) {\n  var ads = vastChain.map(function (_ref) {\n    var ad = _ref.ad;\n    return ad;\n  });\n  var icons = ads.reduce(function (accumulator, ad) {\n    return [].concat(toConsumableArray(accumulator), toConsumableArray(getIcons(ad) || []));\n  }, []);\n\n  if (icons.length > 0) {\n    var uniqIcons = uniqByResource(icons);\n\n    return chooseIcons(uniqIcons);\n  }\n\n  return null;\n};\n\nvar Deferred = function Deferred() {\n  var _this = this;\n\n  classCallCheck(this, Deferred);\n\n  this.promise = new Promise(function (resolve, reject) {\n    _this.resolve = resolve;\n    _this.reject = reject;\n  });\n};\n\nvar waitFor = function waitFor(element, event) {\n  var pending = true;\n\n  var _ref = new Deferred(),\n      promise = _ref.promise,\n      reject = _ref.reject,\n      resolve = _ref.resolve;\n\n  var cancelOnce = once(element, event, function () {\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    pending = false;\n    resolve(args);\n  });\n  var cancel = function cancel() {\n    if (pending) {\n      pending = false;\n      cancelOnce();\n      reject(new Error('waitFor was canceled'));\n    }\n  };\n\n  return {\n    cancel: cancel,\n    promise: promise\n  };\n};\n\n(function(self) {\n\n  if (self.fetch) {\n    return\n  }\n\n  var support = {\n    searchParams: 'URLSearchParams' in self,\n    iterable: 'Symbol' in self && 'iterator' in Symbol,\n    blob: 'FileReader' in self && 'Blob' in self && (function() {\n      try {\n        new Blob();\n        return true\n      } catch(e) {\n        return false\n      }\n    })(),\n    formData: 'FormData' in self,\n    arrayBuffer: 'ArrayBuffer' in self\n  };\n\n  if (support.arrayBuffer) {\n    var viewClasses = [\n      '[object Int8Array]',\n      '[object Uint8Array]',\n      '[object Uint8ClampedArray]',\n      '[object Int16Array]',\n      '[object Uint16Array]',\n      '[object Int32Array]',\n      '[object Uint32Array]',\n      '[object Float32Array]',\n      '[object Float64Array]'\n    ];\n\n    var isDataView = function(obj) {\n      return obj && DataView.prototype.isPrototypeOf(obj)\n    };\n\n    var isArrayBufferView = ArrayBuffer.isView || function(obj) {\n      return obj && viewClasses.indexOf(Object.prototype.toString.call(obj)) > -1\n    };\n  }\n\n  function normalizeName(name) {\n    if (typeof name !== 'string') {\n      name = String(name);\n    }\n    if (/[^a-z0-9\\-#$%&'*+.\\^_`|~]/i.test(name)) {\n      throw new TypeError('Invalid character in header field name')\n    }\n    return name.toLowerCase()\n  }\n\n  function normalizeValue(value) {\n    if (typeof value !== 'string') {\n      value = String(value);\n    }\n    return value\n  }\n\n  // Build a destructive iterator for the value list\n  function iteratorFor(items) {\n    var iterator = {\n      next: function() {\n        var value = items.shift();\n        return {done: value === undefined, value: value}\n      }\n    };\n\n    if (support.iterable) {\n      iterator[Symbol.iterator] = function() {\n        return iterator\n      };\n    }\n\n    return iterator\n  }\n\n  function Headers(headers) {\n    this.map = {};\n\n    if (headers instanceof Headers) {\n      headers.forEach(function(value, name) {\n        this.append(name, value);\n      }, this);\n    } else if (Array.isArray(headers)) {\n      headers.forEach(function(header) {\n        this.append(header[0], header[1]);\n      }, this);\n    } else if (headers) {\n      Object.getOwnPropertyNames(headers).forEach(function(name) {\n        this.append(name, headers[name]);\n      }, this);\n    }\n  }\n\n  Headers.prototype.append = function(name, value) {\n    name = normalizeName(name);\n    value = normalizeValue(value);\n    var oldValue = this.map[name];\n    this.map[name] = oldValue ? oldValue+','+value : value;\n  };\n\n  Headers.prototype['delete'] = function(name) {\n    delete this.map[normalizeName(name)];\n  };\n\n  Headers.prototype.get = function(name) {\n    name = normalizeName(name);\n    return this.has(name) ? this.map[name] : null\n  };\n\n  Headers.prototype.has = function(name) {\n    return this.map.hasOwnProperty(normalizeName(name))\n  };\n\n  Headers.prototype.set = function(name, value) {\n    this.map[normalizeName(name)] = normalizeValue(value);\n  };\n\n  Headers.prototype.forEach = function(callback, thisArg) {\n    for (var name in this.map) {\n      if (this.map.hasOwnProperty(name)) {\n        callback.call(thisArg, this.map[name], name, this);\n      }\n    }\n  };\n\n  Headers.prototype.keys = function() {\n    var items = [];\n    this.forEach(function(value, name) { items.push(name); });\n    return iteratorFor(items)\n  };\n\n  Headers.prototype.values = function() {\n    var items = [];\n    this.forEach(function(value) { items.push(value); });\n    return iteratorFor(items)\n  };\n\n  Headers.prototype.entries = function() {\n    var items = [];\n    this.forEach(function(value, name) { items.push([name, value]); });\n    return iteratorFor(items)\n  };\n\n  if (support.iterable) {\n    Headers.prototype[Symbol.iterator] = Headers.prototype.entries;\n  }\n\n  function consumed(body) {\n    if (body.bodyUsed) {\n      return Promise.reject(new TypeError('Already read'))\n    }\n    body.bodyUsed = true;\n  }\n\n  function fileReaderReady(reader) {\n    return new Promise(function(resolve, reject) {\n      reader.onload = function() {\n        resolve(reader.result);\n      };\n      reader.onerror = function() {\n        reject(reader.error);\n      };\n    })\n  }\n\n  function readBlobAsArrayBuffer(blob) {\n    var reader = new FileReader();\n    var promise = fileReaderReady(reader);\n    reader.readAsArrayBuffer(blob);\n    return promise\n  }\n\n  function readBlobAsText(blob) {\n    var reader = new FileReader();\n    var promise = fileReaderReady(reader);\n    reader.readAsText(blob);\n    return promise\n  }\n\n  function readArrayBufferAsText(buf) {\n    var view = new Uint8Array(buf);\n    var chars = new Array(view.length);\n\n    for (var i = 0; i < view.length; i++) {\n      chars[i] = String.fromCharCode(view[i]);\n    }\n    return chars.join('')\n  }\n\n  function bufferClone(buf) {\n    if (buf.slice) {\n      return buf.slice(0)\n    } else {\n      var view = new Uint8Array(buf.byteLength);\n      view.set(new Uint8Array(buf));\n      return view.buffer\n    }\n  }\n\n  function Body() {\n    this.bodyUsed = false;\n\n    this._initBody = function(body) {\n      this._bodyInit = body;\n      if (!body) {\n        this._bodyText = '';\n      } else if (typeof body === 'string') {\n        this._bodyText = body;\n      } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {\n        this._bodyBlob = body;\n      } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {\n        this._bodyFormData = body;\n      } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n        this._bodyText = body.toString();\n      } else if (support.arrayBuffer && support.blob && isDataView(body)) {\n        this._bodyArrayBuffer = bufferClone(body.buffer);\n        // IE 10-11 can't handle a DataView body.\n        this._bodyInit = new Blob([this._bodyArrayBuffer]);\n      } else if (support.arrayBuffer && (ArrayBuffer.prototype.isPrototypeOf(body) || isArrayBufferView(body))) {\n        this._bodyArrayBuffer = bufferClone(body);\n      } else {\n        throw new Error('unsupported BodyInit type')\n      }\n\n      if (!this.headers.get('content-type')) {\n        if (typeof body === 'string') {\n          this.headers.set('content-type', 'text/plain;charset=UTF-8');\n        } else if (this._bodyBlob && this._bodyBlob.type) {\n          this.headers.set('content-type', this._bodyBlob.type);\n        } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n          this.headers.set('content-type', 'application/x-www-form-urlencoded;charset=UTF-8');\n        }\n      }\n    };\n\n    if (support.blob) {\n      this.blob = function() {\n        var rejected = consumed(this);\n        if (rejected) {\n          return rejected\n        }\n\n        if (this._bodyBlob) {\n          return Promise.resolve(this._bodyBlob)\n        } else if (this._bodyArrayBuffer) {\n          return Promise.resolve(new Blob([this._bodyArrayBuffer]))\n        } else if (this._bodyFormData) {\n          throw new Error('could not read FormData body as blob')\n        } else {\n          return Promise.resolve(new Blob([this._bodyText]))\n        }\n      };\n\n      this.arrayBuffer = function() {\n        if (this._bodyArrayBuffer) {\n          return consumed(this) || Promise.resolve(this._bodyArrayBuffer)\n        } else {\n          return this.blob().then(readBlobAsArrayBuffer)\n        }\n      };\n    }\n\n    this.text = function() {\n      var rejected = consumed(this);\n      if (rejected) {\n        return rejected\n      }\n\n      if (this._bodyBlob) {\n        return readBlobAsText(this._bodyBlob)\n      } else if (this._bodyArrayBuffer) {\n        return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer))\n      } else if (this._bodyFormData) {\n        throw new Error('could not read FormData body as text')\n      } else {\n        return Promise.resolve(this._bodyText)\n      }\n    };\n\n    if (support.formData) {\n      this.formData = function() {\n        return this.text().then(decode)\n      };\n    }\n\n    this.json = function() {\n      return this.text().then(JSON.parse)\n    };\n\n    return this\n  }\n\n  // HTTP methods whose capitalization should be normalized\n  var methods = ['DELETE', 'GET', 'HEAD', 'OPTIONS', 'POST', 'PUT'];\n\n  function normalizeMethod(method) {\n    var upcased = method.toUpperCase();\n    return (methods.indexOf(upcased) > -1) ? upcased : method\n  }\n\n  function Request(input, options) {\n    options = options || {};\n    var body = options.body;\n\n    if (input instanceof Request) {\n      if (input.bodyUsed) {\n        throw new TypeError('Already read')\n      }\n      this.url = input.url;\n      this.credentials = input.credentials;\n      if (!options.headers) {\n        this.headers = new Headers(input.headers);\n      }\n      this.method = input.method;\n      this.mode = input.mode;\n      if (!body && input._bodyInit != null) {\n        body = input._bodyInit;\n        input.bodyUsed = true;\n      }\n    } else {\n      this.url = String(input);\n    }\n\n    this.credentials = options.credentials || this.credentials || 'omit';\n    if (options.headers || !this.headers) {\n      this.headers = new Headers(options.headers);\n    }\n    this.method = normalizeMethod(options.method || this.method || 'GET');\n    this.mode = options.mode || this.mode || null;\n    this.referrer = null;\n\n    if ((this.method === 'GET' || this.method === 'HEAD') && body) {\n      throw new TypeError('Body not allowed for GET or HEAD requests')\n    }\n    this._initBody(body);\n  }\n\n  Request.prototype.clone = function() {\n    return new Request(this, { body: this._bodyInit })\n  };\n\n  function decode(body) {\n    var form = new FormData();\n    body.trim().split('&').forEach(function(bytes) {\n      if (bytes) {\n        var split = bytes.split('=');\n        var name = split.shift().replace(/\\+/g, ' ');\n        var value = split.join('=').replace(/\\+/g, ' ');\n        form.append(decodeURIComponent(name), decodeURIComponent(value));\n      }\n    });\n    return form\n  }\n\n  function parseHeaders(rawHeaders) {\n    var headers = new Headers();\n    // Replace instances of \\r\\n and \\n followed by at least one space or horizontal tab with a space\n    // https://tools.ietf.org/html/rfc7230#section-3.2\n    var preProcessedHeaders = rawHeaders.replace(/\\r?\\n[\\t ]+/g, ' ');\n    preProcessedHeaders.split(/\\r?\\n/).forEach(function(line) {\n      var parts = line.split(':');\n      var key = parts.shift().trim();\n      if (key) {\n        var value = parts.join(':').trim();\n        headers.append(key, value);\n      }\n    });\n    return headers\n  }\n\n  Body.call(Request.prototype);\n\n  function Response(bodyInit, options) {\n    if (!options) {\n      options = {};\n    }\n\n    this.type = 'default';\n    this.status = options.status === undefined ? 200 : options.status;\n    this.ok = this.status >= 200 && this.status < 300;\n    this.statusText = 'statusText' in options ? options.statusText : 'OK';\n    this.headers = new Headers(options.headers);\n    this.url = options.url || '';\n    this._initBody(bodyInit);\n  }\n\n  Body.call(Response.prototype);\n\n  Response.prototype.clone = function() {\n    return new Response(this._bodyInit, {\n      status: this.status,\n      statusText: this.statusText,\n      headers: new Headers(this.headers),\n      url: this.url\n    })\n  };\n\n  Response.error = function() {\n    var response = new Response(null, {status: 0, statusText: ''});\n    response.type = 'error';\n    return response\n  };\n\n  var redirectStatuses = [301, 302, 303, 307, 308];\n\n  Response.redirect = function(url, status) {\n    if (redirectStatuses.indexOf(status) === -1) {\n      throw new RangeError('Invalid status code')\n    }\n\n    return new Response(null, {status: status, headers: {location: url}})\n  };\n\n  self.Headers = Headers;\n  self.Request = Request;\n  self.Response = Response;\n\n  self.fetch = function(input, init) {\n    return new Promise(function(resolve, reject) {\n      var request = new Request(input, init);\n      var xhr = new XMLHttpRequest();\n\n      xhr.onload = function() {\n        var options = {\n          status: xhr.status,\n          statusText: xhr.statusText,\n          headers: parseHeaders(xhr.getAllResponseHeaders() || '')\n        };\n        options.url = 'responseURL' in xhr ? xhr.responseURL : options.headers.get('X-Request-URL');\n        var body = 'response' in xhr ? xhr.response : xhr.responseText;\n        resolve(new Response(body, options));\n      };\n\n      xhr.onerror = function() {\n        reject(new TypeError('Network request failed'));\n      };\n\n      xhr.ontimeout = function() {\n        reject(new TypeError('Network request failed'));\n      };\n\n      xhr.open(request.method, request.url, true);\n\n      if (request.credentials === 'include') {\n        xhr.withCredentials = true;\n      } else if (request.credentials === 'omit') {\n        xhr.withCredentials = false;\n      }\n\n      if ('responseType' in xhr && support.blob) {\n        xhr.responseType = 'blob';\n      }\n\n      request.headers.forEach(function(value, name) {\n        xhr.setRequestHeader(name, value);\n      });\n\n      xhr.send(typeof request._bodyInit === 'undefined' ? null : request._bodyInit);\n    })\n  };\n  self.fetch.polyfill = true;\n})(typeof self !== 'undefined' ? self : undefined);\n\nvar _this = undefined;\n\nvar isValidContentType = function isValidContentType(contentType) {\n  var normalisedCT = contentType.toLowerCase();\n\n  return ['text/plain', 'text/html'].some(function (allowedType) {\n    return normalisedCT.includes(allowedType);\n  });\n};\n\nvar fetchHtml = function () {\n  var _ref = asyncToGenerator( /*#__PURE__*/regenerator.mark(function _callee(endpoint) {\n    var response, contentType, error, _error;\n\n    return regenerator.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return fetch(endpoint);\n\n          case 2:\n            response = _context.sent;\n            contentType = response.headers.get('Content-Type');\n\n            if (!(response.status >= 400)) {\n              _context.next = 8;\n              break;\n            }\n\n            error = new Error(response.statusText);\n\n\n            error.response = response;\n            throw error;\n\n          case 8:\n            if (isValidContentType(contentType)) {\n              _context.next = 12;\n              break;\n            }\n\n            _error = new Error('fetchHtml error, invalid Content-Type ' + contentType);\n\n\n            _error.response = response;\n            throw _error;\n\n          case 12:\n            return _context.abrupt('return', response.text());\n\n          case 13:\n          case 'end':\n            return _context.stop();\n        }\n      }\n    }, _callee, _this);\n  }));\n\n  return function fetchHtml(_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar createHtmlResource = function createHtmlResource(src, _ref) {\n  var document = _ref.document,\n      data = _ref.data;\n  var height = data.height,\n      width = data.width;\n\n  var divElement = document.createElement('DIV');\n\n  if (width) {\n    divElement.style.width = width + 'px';\n  }\n\n  if (height) {\n    divElement.style.height = height + 'px';\n  }\n\n  fetchHtml(src)\n  // eslint-disable-next-line promise/always-return, promise/prefer-await-to-then\n  .then(function (html) {\n    divElement.innerHTML = html;\n\n    divElement.dispatchEvent(new CustomEvent('load'));\n  }).catch(function () {\n    divElement.dispatchEvent(new CustomEvent('error'));\n  });\n\n  return divElement;\n};\n\nvar createIframeResource = function createIframeResource(src, _ref) {\n  var document = _ref.document,\n      data = _ref.data;\n  var height = data.height,\n      width = data.width;\n\n  var iframeElement = document.createElement('IFRAME');\n\n  iframeElement.src = src;\n  iframeElement.sandbox = 'allow-forms allow-popups allow-scripts';\n\n  if (width) {\n    iframeElement.width = width;\n  }\n\n  if (height) {\n    iframeElement.height = height;\n  }\n\n  iframeElement.src = src;\n\n  iframeElement.frameBorder = 0;\n  iframeElement.style.border = 'none';\n\n  return iframeElement;\n};\n\nvar createStaticResource = function createStaticResource(src, _ref) {\n  var document = _ref.document,\n      data = _ref.data;\n  var height = data.height,\n      width = data.width;\n\n  var img = document.createElement('IMG');\n\n  if (width) {\n    img.width = width;\n  }\n\n  if (height) {\n    img.height = height;\n  }\n\n  img.src = src;\n\n  return img;\n};\n\nvar createResource = function createResource(document, data) {\n  var staticResource = data.staticResource,\n      htmlResource = data.htmlResource,\n      iFrameResource = data.iFrameResource;\n\n\n  if (Boolean(staticResource)) {\n    return createStaticResource(staticResource, {\n      data: data,\n      document: document\n    });\n  }\n\n  if (Boolean(htmlResource)) {\n    return createHtmlResource(htmlResource, {\n      data: data,\n      document: document\n    });\n  }\n\n  return createIframeResource(iFrameResource, {\n    data: data,\n    document: document\n  });\n};\n\n/* eslint-disable promise/prefer-await-to-then, promise/always-return */\n\nvar noop$1 = function noop() {};\nvar loadResource = function loadResource(icon, _ref) {\n  var document = _ref.document,\n      placeholder = _ref.placeholder;\n  return new Promise(function (resolve, reject) {\n    try {\n      var resourceElement = createResource(document, icon);\n      var resourceErrorWait = waitFor(resourceElement, 'error');\n      var resourceLoadWait = waitFor(resourceElement, 'load');\n      var cleanUp = function cleanUp() {\n        if (placeholder.contains(resourceElement)) {\n          placeholder.removeChild(resourceElement);\n          resourceElement.style.zIndex = 0;\n        }\n      };\n\n      resourceErrorWait.promise.then(function () {\n        resourceLoadWait.cancel();\n        cleanUp();\n\n        reject(new Error('Error loading resource'));\n      }).catch(noop$1);\n\n      resourceLoadWait.promise.then(function () {\n        resourceErrorWait.cancel();\n        cleanUp();\n\n        resolve(resourceElement);\n      }).catch(noop$1);\n\n      // Some browsers will not load the resource if they are not added to the DOM\n      resourceElement.style.zIndex = -9999;\n      placeholder.appendChild(resourceElement);\n    } catch (error) {\n      reject(error);\n    }\n  });\n};\n\nvar isCustomXposition = function isCustomXposition(xPosition) {\n  return !['left', 'right'].includes(String(xPosition).toLowerCase());\n};\nvar isCustomYPosition = function isCustomYPosition(yPosition) {\n  return !['top', 'bottom'].includes(String(yPosition).toLowerCase());\n};\nvar calculateIconLeft = function calculateIconLeft(dynamicPos, iconWidth, drawnIcons, phWidth) {\n  var drawnIconsWidth = drawnIcons.reduce(function (accumulator, icon) {\n    return accumulator + icon.width + 1;\n  }, 0);\n\n  if (dynamicPos === 'left') {\n    return drawnIconsWidth;\n  }\n\n  return phWidth - drawnIconsWidth - iconWidth;\n};\n\nvar calculateIconTop = function calculateIconTop(dynamicPos, iconHeight, phHeight) {\n  if (dynamicPos === 'top') {\n    return 0;\n  }\n\n  return phHeight - iconHeight;\n};\n\nvar updateIcon = function updateIcon(icon, iconElement, _ref) {\n  var drawnIcons = _ref.drawnIcons,\n      placeholder = _ref.placeholder;\n\n  var oldSignature = icon.signature;\n  var rect = iconElement.getBoundingClientRect();\n  var phRect = placeholder.getBoundingClientRect();\n  var width = icon.width || rect.width;\n  var height = icon.height || rect.height;\n  var xPosition = icon.xPosition || 'right';\n  var yPosition = icon.yPosition || 'top';\n  var left = void 0;\n  var top = void 0;\n\n  if (isCustomXposition(xPosition)) {\n    left = xPosition;\n  } else {\n    var icons = drawnIcons.filter(function (dIcon) {\n      return dIcon.xPosition === xPosition && dIcon.yPosition === yPosition;\n    });\n\n    left = calculateIconLeft(xPosition, width, icons, phRect.width);\n  }\n  if (isCustomYPosition(yPosition)) {\n    top = yPosition;\n  } else {\n    top = calculateIconTop(yPosition, height, phRect.height);\n  }\n\n  var signature = left + '-' + top + '_' + width + 'x' + height;\n\n  return Object.assign(icon, {\n    height: height,\n    left: left,\n    signature: signature,\n    top: top,\n    updated: oldSignature !== signature,\n    width: width\n  });\n};\n\n/* eslint-disable no-shadow */\nvar calculateArea = function calculateArea(_ref) {\n  var height = _ref.height,\n      width = _ref.width;\n  return height * width;\n};\n\nvar hasSpace = function hasSpace(newIcon, config) {\n  var drawnIcons = config.drawnIcons,\n      placeholder = config.placeholder;\n\n  var placeholderArea = calculateArea(placeholder.getBoundingClientRect());\n  var iconArea = calculateArea(newIcon);\n  var usedIconsArea = drawnIcons.reduce(function (accumulator, icon) {\n    return accumulator + calculateArea(icon);\n  }, 0);\n\n  return iconArea + usedIconsArea <= placeholderArea * 0.35;\n};\n\nvar withinBoundaries = function withinBoundaries(newIcon, _ref2) {\n  var placeholder = _ref2.placeholder;\n\n  var phRect = placeholder.getBoundingClientRect();\n\n  return newIcon.left >= 0 && newIcon.left + newIcon.width <= phRect.width && newIcon.top >= 0 && newIcon.top + newIcon.height <= phRect.height;\n};\n\nvar right = function right(_ref3) {\n  var left = _ref3.left,\n      width = _ref3.width;\n  return left + width;\n};\nvar left = function left(_ref4) {\n  var left = _ref4.left;\n  return left;\n};\nvar top = function top(_ref5) {\n  var top = _ref5.top;\n  return top;\n};\nvar bottom = function bottom(_ref6) {\n  var top = _ref6.top,\n      height = _ref6.height;\n  return top + height;\n};\nvar overlap = function overlap(newIcon, drawnIcon) {\n  if (left(newIcon) > right(drawnIcon) || right(newIcon) < left(drawnIcon) || bottom(newIcon) < top(drawnIcon) || top(newIcon) > bottom(drawnIcon)) {\n    return false;\n  }\n\n  return true;\n};\n\nvar withoutOverlaps = function withoutOverlaps(newIcon, _ref7) {\n  var drawnIcons = _ref7.drawnIcons;\n  return !drawnIcons.some(function (drawnIcon) {\n    return overlap(newIcon, drawnIcon);\n  });\n};\n\nvar canBeRendered = function canBeRendered(newIcon, config) {\n  var thereIsSpace = hasSpace(newIcon, config);\n  var isWithinTheContentArea = withinBoundaries(newIcon, config);\n  var doesNotOverlap = withoutOverlaps(newIcon, config);\n\n  return thereIsSpace && isWithinTheContentArea && doesNotOverlap;\n};\n\nvar _this$1 = undefined;\n\nvar noop$2 = function noop() {};\nvar wrapWithClickThrough = function wrapWithClickThrough(iconElement, icon) {\n  var _ref = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {},\n      _ref$onIconClick = _ref.onIconClick,\n      onIconClick = _ref$onIconClick === undefined ? noop$2 : _ref$onIconClick;\n\n  var anchor = document.createElement('A');\n\n  if (icon.iconClickthrough) {\n    anchor.href = icon.iconClickthrough;\n    anchor.target = '_blank';\n  }\n\n  // NOTE: if iframe icon disable pointer events so that clickThrough and click tracking work\n  if (Boolean(icon.iFrameResource)) {\n    iconElement.style.pointerEvents = 'none';\n  }\n\n  anchor.onclick = function (event) {\n    if (Event.prototype.stopPropagation !== undefined) {\n      event.stopPropagation();\n    }\n\n    onIconClick(icon);\n  };\n\n  anchor.appendChild(iconElement);\n\n  return anchor;\n};\n\nvar createIcon = function () {\n  var _ref2 = asyncToGenerator( /*#__PURE__*/regenerator.mark(function _callee(icon, config) {\n    var iconResource;\n    return regenerator.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            if (icon.element) {\n              _context.next = 9;\n              break;\n            }\n\n            _context.next = 3;\n            return loadResource(icon, config);\n\n          case 3:\n            iconResource = _context.sent;\n\n\n            iconResource.width = '100%';\n            iconResource.height = '100%';\n            iconResource.style.height = '100%';\n            iconResource.style.width = '100%';\n\n            icon.element = wrapWithClickThrough(iconResource, icon, config);\n\n          case 9:\n            return _context.abrupt('return', icon.element);\n\n          case 10:\n          case 'end':\n            return _context.stop();\n        }\n      }\n    }, _callee, _this$1);\n  }));\n\n  return function createIcon(_x2, _x3) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\nvar updateIconElement = function updateIconElement(iconElement, icon) {\n  var height = icon.height,\n      width = icon.width,\n      left = icon.left,\n      top = icon.top,\n      yPosition = icon.yPosition;\n\n\n  iconElement.height = height;\n  iconElement.width = width;\n  iconElement.style.position = 'absolute';\n  iconElement.style.left = left + 'px';\n\n  // NOTE: This if is a bit odd but some browser don't calculate the placeholder height pixel perfect and,\n  //       setting the top of the icon will change the size of the icon's placeholder this if prevents that situation\n  if (yPosition === 'bottom') {\n    iconElement.style.bottom = '0';\n  } else {\n    iconElement.style.top = top + 'px';\n  }\n  iconElement.style.height = height + 'px';\n  iconElement.style.width = width + 'px';\n\n  return iconElement;\n};\n\nvar renderIcon = function () {\n  var _ref3 = asyncToGenerator( /*#__PURE__*/regenerator.mark(function _callee2(icon, config) {\n    var placeholder, iconElement, updatedIcon;\n    return regenerator.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            placeholder = config.placeholder;\n            _context2.next = 3;\n            return createIcon(icon, config);\n\n          case 3:\n            iconElement = _context2.sent;\n            updatedIcon = updateIcon(icon, iconElement, config);\n\n            if (!canBeRendered(updatedIcon, config)) {\n              _context2.next = 9;\n              break;\n            }\n\n            if (!iconElement.parentNode || icon.updated) {\n              placeholder.appendChild(updateIconElement(iconElement, updatedIcon));\n            }\n            _context2.next = 11;\n            break;\n\n          case 9:\n            if (iconElement.parentNode) {\n              iconElement.parentNode.removeChild(iconElement);\n            }\n            throw new Error('Icon can\\'t be rendered');\n\n          case 11:\n            return _context2.abrupt('return', updatedIcon);\n\n          case 12:\n          case 'end':\n            return _context2.stop();\n        }\n      }\n    }, _callee2, _this$1);\n  }));\n\n  return function renderIcon(_x4, _x5) {\n    return _ref3.apply(this, arguments);\n  };\n}();\n\nvar canBeShown = function canBeShown(icon, videoElement) {\n  var currentTimeInMs = videoElement.currentTime * 1000;\n  var videoDurationInMs = videoElement.duration * 1000;\n  var offset = icon.offset || 0;\n  var duration = icon.duration || videoDurationInMs;\n\n  return offset <= currentTimeInMs && currentTimeInMs - offset <= duration;\n};\n\n/* eslint-disable promise/prefer-await-to-then */\n\nvar renderIcons = function renderIcons(icons, _ref) {\n  var onIconClick = _ref.onIconClick,\n      videoAdContainer = _ref.videoAdContainer,\n      logger = _ref.logger;\n  var element = videoAdContainer.element,\n      videoElement = videoAdContainer.videoElement;\n\n  var drawnIcons = [];\n\n  var _icons$reduce = icons.reduce(function (accumulator, icon) {\n    if (canBeShown(icon, videoElement)) {\n      accumulator.iconsToShow.push(icon);\n    } else {\n      accumulator.otherIcons.push(icon);\n    }\n\n    return accumulator;\n  }, {\n    iconsToShow: [],\n    otherIcons: []\n  }),\n      iconsToShow = _icons$reduce.iconsToShow,\n      otherIcons = _icons$reduce.otherIcons;\n\n  otherIcons.forEach(function (_ref2) {\n    var iconElement = _ref2.element;\n\n    if (iconElement && iconElement.parentNode) {\n      iconElement.parentNode.removeChild(iconElement);\n    }\n  });\n\n  return iconsToShow.reduce(function (promise, icon) {\n    return promise.then(function () {\n      return renderIcon(icon, {\n        document: document,\n        drawnIcons: drawnIcons,\n        onIconClick: onIconClick,\n        placeholder: element\n      });\n    }).then(function (renderedIcon) {\n      return drawnIcons.push(renderedIcon);\n    }).catch(function (error) {\n      return logger.log(error);\n    });\n  }, Promise.resolve(drawnIcons)).then(function () {\n    return drawnIcons;\n  });\n};\n\nvar _this$2 = undefined;\n\nvar firstRenderPending = Symbol('firstRenderPending');\nvar noop$3 = function noop() {};\n\nvar _hasPendingIconRedraws = function _hasPendingIconRedraws(icons, videoElement) {\n  var currentTimeInMs = videoElement.currentTime * 1000;\n  var videoDurationInMs = videoElement.duration * 1000;\n\n  var iconsPendingToRedraw = icons.filter(function (icon) {\n    return !icon.offset || icon.offset < currentTimeInMs;\n  });\n  var iconsPendingToBeRemoved = icons.filter(function (icon) {\n    return icon.duration && icon.duration < videoDurationInMs;\n  });\n\n  return iconsPendingToRedraw.length > 0 || iconsPendingToBeRemoved.length > 0;\n};\n\nvar removeDrawnIcons = function removeDrawnIcons(icons) {\n  return icons.filter(function (_ref) {\n    var element = _ref.element;\n    return Boolean(element) && Boolean(element.parentNode);\n  }).forEach(function (_ref2) {\n    var element = _ref2.element;\n    return element.parentNode.removeChild(element);\n  });\n};\n\nvar addIcons = function addIcons(icons) {\n  var _ref3 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n  var videoAdContainer = _ref3.videoAdContainer,\n      _ref3$onIconView = _ref3.onIconView,\n      onIconView = _ref3$onIconView === undefined ? noop$3 : _ref3$onIconView,\n      _ref3$onIconClick = _ref3.onIconClick,\n      onIconClick = _ref3$onIconClick === undefined ? noop$3 : _ref3$onIconClick,\n      rest = objectWithoutProperties(_ref3, ['videoAdContainer', 'onIconView', 'onIconClick']);\n  var videoElement = videoAdContainer.videoElement,\n      element = videoAdContainer.element;\n\n  var drawIcons = function () {\n    var _ref4 = asyncToGenerator( /*#__PURE__*/regenerator.mark(function _callee() {\n      var drawnIcons;\n      return regenerator.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return renderIcons(icons, _extends({\n                onIconClick: onIconClick,\n                videoAdContainer: videoAdContainer\n              }, rest));\n\n            case 2:\n              drawnIcons = _context.sent;\n\n\n              element.dispatchEvent(new CustomEvent('iconsDrawn'));\n\n              drawnIcons.forEach(function (icon) {\n                if (icon[firstRenderPending]) {\n                  onIconView(icon);\n                  icon[firstRenderPending] = false;\n                }\n              });\n\n            case 5:\n            case 'end':\n              return _context.stop();\n          }\n        }\n      }, _callee, _this$2);\n    }));\n\n    return function drawIcons() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  icons.forEach(function (icon) {\n    icon[firstRenderPending] = true;\n  });\n\n  return {\n    drawIcons: drawIcons,\n    hasPendingIconRedraws: function hasPendingIconRedraws() {\n      return _hasPendingIconRedraws(icons, videoElement);\n    },\n    removeIcons: function removeIcons() {\n      return removeDrawnIcons(icons);\n    }\n  };\n};\n\nvar viewmode = function viewmode(width, height) {\n  var isFullscreen = width + 100 > innerWidth && height + 100 > innerHeight;\n\n  if (isFullscreen) {\n    return 'fullscreen';\n  }\n\n  if (width < 400) {\n    return 'thumbnail';\n  }\n\n  return 'normal';\n};\n\nvar start$2 = linearEvents.start,\n    iconClick$1 = linearEvents.iconClick,\n    iconView$1 = linearEvents.iconView;\n\n// eslint-disable-next-line id-match\n\nvar _protected = Symbol('_protected');\n\n/**\n * @class\n * @extends Emitter\n * @alias VideoAdUnit\n * @implements LinearEvents\n * @description This class provides shared logic among all the ad units.\n */\n\nvar VideoAdUnit = function (_Emitter) {\n  inherits(VideoAdUnit, _Emitter);\n\n  /**\n   * Creates a {@link VideoAdUnit}.\n   *\n   * @param {VastChain} vastChain - The {@link VastChain} with all the {@link VastResponse}\n   * @param {VideoAdContainer} videoAdContainer - container instance to place the ad\n   * @param {Object} [options] - Options Map. The allowed properties are:\n   * @param {Console} [options.logger] - Optional logger instance. Must comply to the [Console interface]{@link https://developer.mozilla.org/es/docs/Web/API/Console}.\n   * Defaults to `window.console`\n   * @param {boolean} [options.viewability] - if true it will pause the ad whenever is not visible for the viewer.\n   * Defaults to `false`\n   * @param {boolean} [options.responsive] - if true it will resize the ad unit whenever the ad container changes sizes\n   * Defaults to `false`\n   */\n\n\n  /** If an error occurs it will contain the reference to the error otherwise it will be bull */\n  function VideoAdUnit(vastChain, videoAdContainer) {\n    var _ref = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {},\n        _ref$viewability = _ref.viewability,\n        viewability = _ref$viewability === undefined ? false : _ref$viewability,\n        _ref$responsive = _ref.responsive,\n        responsive = _ref$responsive === undefined ? false : _ref$responsive,\n        _ref$logger = _ref.logger,\n        logger = _ref$logger === undefined ? console : _ref$logger;\n\n    classCallCheck(this, VideoAdUnit);\n\n    var _this = possibleConstructorReturn(this, (VideoAdUnit.__proto__ || Object.getPrototypeOf(VideoAdUnit)).call(this, logger));\n\n    _this[_protected] = {\n      finish: function finish$$1() {\n        _this[_protected].finished = true;\n        _this[_protected].onFinishCallbacks.forEach(function (callback) {\n          return callback();\n        });\n\n        _this.emit(finish, {\n          adUnit: _this,\n          type: finish\n        });\n      },\n      finished: false,\n      onErrorCallbacks: [],\n      onFinishCallbacks: [],\n      started: false,\n      throwIfCalled: function throwIfCalled() {\n        throw new Error('VideoAdUnit method must be implemented on child class');\n      },\n      throwIfFinished: function throwIfFinished() {\n        if (_this.isFinished()) {\n          throw new Error('VideoAdUnit is finished');\n        }\n      }\n    };\n    _this.type = null;\n    _this.error = null;\n    _this.errorCode = null;\n    var onFinishCallbacks = _this[_protected].onFinishCallbacks;\n\n    /** Reference to the {@link VastChain} used to load the ad. */\n\n    _this.vastChain = vastChain;\n\n    /** Reference to the {@link VideoAdContainer} that contains the ad. */\n    _this.videoAdContainer = videoAdContainer;\n\n    /** Array of {@link VastIcon} definitions to display from the passed {@link VastChain} or null if there are no icons.*/\n    _this.icons = retrieveIcons(vastChain);\n\n    onFinishCallbacks.push(preventManualProgress(_this.videoAdContainer.videoElement));\n\n    if (_this.icons) {\n      var _addIcons = addIcons(_this.icons, {\n        logger: logger,\n        onIconClick: function onIconClick(icon) {\n          return _this.emit(iconClick$1, {\n            adUnit: _this,\n            data: icon,\n            type: iconClick$1\n          });\n        },\n        onIconView: function onIconView(icon) {\n          return _this.emit(iconView$1, {\n            adUnit: _this,\n            data: icon,\n            type: iconView$1\n          });\n        },\n        videoAdContainer: videoAdContainer\n      }),\n          drawIcons = _addIcons.drawIcons,\n          hasPendingIconRedraws = _addIcons.hasPendingIconRedraws,\n          removeIcons = _addIcons.removeIcons;\n\n      _this[_protected].drawIcons = drawIcons;\n      _this[_protected].removeIcons = removeIcons;\n      _this[_protected].hasPendingIconRedraws = hasPendingIconRedraws;\n\n      onFinishCallbacks.push(removeIcons);\n    }\n\n    if (viewability) {\n      _this.once(start$2, function () {\n        var unsubscribe = onElementVisibilityChange(_this.videoAdContainer.element, function (visible) {\n          if (_this.isFinished()) {\n            return;\n          }\n\n          if (visible) {\n            _this.resume();\n          } else {\n            _this.pause();\n          }\n        });\n\n        onFinishCallbacks.push(unsubscribe);\n      });\n    }\n\n    if (responsive) {\n      _this.once(start$2, function () {\n        var element = _this.videoAdContainer.element;\n\n\n        _this[_protected].size = {\n          height: element.clientHeight,\n          viewmode: viewmode(element.clientWidth, element.clientHeight),\n          width: element.clientWidth\n        };\n        var unsubscribe = onElementResize(element, function () {\n          if (_this.isFinished()) {\n            return;\n          }\n\n          var prevSize = _this[_protected].size;\n          var height = element.clientHeight;\n          var width = element.clientWidth;\n\n          if (height !== prevSize.height || width !== prevSize.width) {\n            _this.resize(width, height, viewmode(width, height));\n          }\n        });\n\n        onFinishCallbacks.push(unsubscribe);\n      });\n    }\n    return _this;\n  }\n\n  /*\n   * Starts the ad unit.\n   *\n   * @throws if called twice.\n   * @throws if ad unit is finished.\n   */\n\n\n  /** If an error occurs it will contain the Vast Error code of the error */\n\n\n  /** Ad unit type */\n\n\n  createClass(VideoAdUnit, [{\n    key: 'start',\n    value: function start() {\n      this[_protected].throwIfCalled();\n    }\n\n    /**\n     * Resumes a previously paused ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     */\n\n  }, {\n    key: 'resume',\n    value: function resume() {\n      this[_protected].throwIfCalled();\n    }\n\n    /**\n     * Pauses the ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     */\n\n  }, {\n    key: 'pause',\n    value: function pause() {\n      this[_protected].throwIfCalled();\n    }\n\n    /**\n     * Sets the volume of the ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     *\n     * @param {number} volume - must be a value between 0 and 1;\n     */\n    // eslint-disable-next-line no-unused-vars\n\n  }, {\n    key: 'setVolume',\n    value: function setVolume(volume) {\n      this[_protected].throwIfCalled();\n    }\n\n    /**\n     * Gets the volume of the ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     *\n     * @returns {number} - the volume of the ad unit.\n     */\n\n  }, {\n    key: 'getVolume',\n    value: function getVolume() {\n      this[_protected].throwIfCalled();\n    }\n\n    /**\n     * Cancels the ad unit.\n     *\n     * @throws if ad unit is finished.\n     */\n\n  }, {\n    key: 'cancel',\n    value: function cancel() {\n      this[_protected].throwIfCalled();\n    }\n\n    /**\n     * Returns the duration of the ad Creative or 0 if there is no creative.\n     *\n     * @returns {number} - the duration of the ad unit.\n     */\n\n  }, {\n    key: 'duration',\n    value: function duration() {\n      this[_protected].throwIfCalled();\n    }\n\n    /**\n     * Returns true if the ad is paused and false otherwise\n     */\n\n  }, {\n    key: 'paused',\n    value: function paused() {\n      this[_protected].throwIfCalled();\n    }\n\n    /**\n     * Returns the current time of the ad Creative or 0 if there is no creative.\n     *\n     * @returns {number} - the current time of the ad unit.\n     */\n\n  }, {\n    key: 'currentTime',\n    value: function currentTime() {\n      this[_protected].throwIfCalled();\n    }\n\n    /**\n     * Register a callback function that will be called whenever the ad finishes. No matter if it was finished because de ad ended, or cancelled or there was an error playing the ad.\n     *\n     * @throws if ad unit is finished.\n     *\n     * @param {Function} callback - will be called once the ad unit finished\n     */\n\n  }, {\n    key: 'onFinish',\n    value: function onFinish(callback) {\n      if (typeof callback !== 'function') {\n        throw new TypeError('Expected a callback function');\n      }\n\n      this[_protected].onFinishCallbacks.push(safeCallback(callback, this.logger));\n    }\n\n    /**\n     * Register a callback function that will be called if there is an error while running the ad.\n     *\n     * @throws if ad unit is finished.\n     *\n     * @param {Function} callback - will be called on ad unit error passing the Error instance as the only argument if available.\n     */\n\n  }, {\n    key: 'onError',\n    value: function onError(callback) {\n      if (typeof callback !== 'function') {\n        throw new TypeError('Expected a callback function');\n      }\n\n      this[_protected].onErrorCallbacks.push(safeCallback(callback, this.logger));\n    }\n\n    /**\n     * @returns {boolean} - true if the ad unit is finished and false otherwise\n     */\n\n  }, {\n    key: 'isFinished',\n    value: function isFinished() {\n      return this[_protected].finished;\n    }\n\n    /**\n     * @returns {boolean} - true if the ad unit has started and false otherwise\n     */\n\n  }, {\n    key: 'isStarted',\n    value: function isStarted() {\n      return this[_protected].started;\n    }\n\n    /**\n     * This method resizes the ad unit to fit the available space in the passed {@link VideoAdContainer}\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     *\n     * @returns {Promise} - that resolves once the unit was resized\n     */\n\n  }, {\n    key: 'resize',\n    value: function () {\n      var _ref2 = asyncToGenerator( /*#__PURE__*/regenerator.mark(function _callee(width, height, mode) {\n        return regenerator.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                this[_protected].size = {\n                  height: height,\n                  viewmode: mode,\n                  width: width\n                };\n\n                if (!(this.isStarted() && !this.isFinished() && this.icons)) {\n                  _context.next = 6;\n                  break;\n                }\n\n                _context.next = 4;\n                return this[_protected].removeIcons();\n\n              case 4:\n                _context.next = 6;\n                return this[_protected].drawIcons();\n\n              case 6:\n              case 'end':\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function resize(_x2, _x3, _x4) {\n        return _ref2.apply(this, arguments);\n      }\n\n      return resize;\n    }()\n  }]);\n  return VideoAdUnit;\n}(Emitter);\n\nvar complete$2 = linearEvents.complete,\n    errorEvt = linearEvents.error,\n    skip$2 = linearEvents.skip;\n\n// eslint-disable-next-line id-match\n\nvar _private = Symbol('_private');\n\n/**\n * @class\n * @extends VideoAdUnit\n * @alias VastAdUnit\n * @implements LinearEvents\n * @description This class provides everything necessary to run a Vast ad.\n */\n\nvar VastAdUnit = function (_VideoAdUnit) {\n  inherits(VastAdUnit, _VideoAdUnit);\n\n  /**\n   * Creates a {VastAdUnit}.\n   *\n   * @param {VastChain} vastChain - The {@link VastChain} with all the {@link VastResponse}\n   * @param {VideoAdContainer} videoAdContainer - container instance to place the ad\n   * @param {Object} [options] - Options Map. The allowed properties are:\n   * @param {Console} [options.logger] - Optional logger instance. Must comply to the [Console interface]{@link https://developer.mozilla.org/es/docs/Web/API/Console}.\n   * Defaults to `window.console`\n   * @param {Object} [options.hooks] - Optional map with hooks to configure the behaviour of the ad.\n   * @param {Function} [options.hooks.createSkipControl] - If provided it will be called to generate the skip control. Must return a clickable [HTMLElement](https://developer.mozilla.org/es/docs/Web/API/HTMLElement) that is detached from the DOM.\n   * @param {boolean} [options.viewability] - if true it will pause the ad whenever is not visible for the viewer.\n   * Defaults to `false`\n   * @param {boolean} [options.responsive] - if true it will resize the ad unit whenever the ad container changes sizes.\n   * Defaults to `false`\n   */\n  function VastAdUnit(vastChain, videoAdContainer) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    classCallCheck(this, VastAdUnit);\n\n    var _this = possibleConstructorReturn(this, (VastAdUnit.__proto__ || Object.getPrototypeOf(VastAdUnit)).call(this, vastChain, videoAdContainer, options));\n\n    _this[_private] = {\n      handleMetric: function handleMetric(event, data) {\n        switch (event) {\n          case complete$2:\n            {\n              _this[_protected].finish();\n              break;\n            }\n          case errorEvt:\n            {\n              _this.error = data;\n              _this.errorCode = _this.error && _this.error.code ? _this.error.code : 405;\n              _this[_protected].onErrorCallbacks.forEach(function (callback) {\n                return callback(_this.error);\n              });\n              _this[_protected].finish();\n              break;\n            }\n          case skip$2:\n            {\n              _this.cancel();\n              break;\n            }\n        }\n\n        _this.emit(event, {\n          adUnit: _this,\n          type: event\n        });\n      }\n    };\n    _this.assetUri = null;\n    _this.type = 'VAST';\n    var onFinishCallbacks = _this[_protected].onFinishCallbacks;\n    var handleMetric = _this[_private].handleMetric;\n\n\n    _this.hooks = options.hooks || {};\n\n    var removeMetricHandlers = setupMetricHandlers({\n      hooks: _this.hooks,\n      vastChain: _this.vastChain,\n      videoAdContainer: _this.videoAdContainer\n    }, handleMetric);\n\n    onFinishCallbacks.push(removeMetricHandlers);\n    return _this;\n  }\n\n  /**\n   * Starts the ad unit.\n   *\n   * @throws if called twice.\n   * @throws if ad unit is finished.\n   */\n\n\n  /** Ad unit type. Will be `VAST` for VastAdUnit */\n\n\n  createClass(VastAdUnit, [{\n    key: 'start',\n    value: function () {\n      var _ref = asyncToGenerator( /*#__PURE__*/regenerator.mark(function _callee2() {\n        var _this2 = this;\n\n        var inlineAd, _videoAdContainer, videoElement, element, media, drawIcons, adUnitError;\n\n        return regenerator.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                this[_protected].throwIfFinished();\n\n                if (!this.isStarted()) {\n                  _context2.next = 3;\n                  break;\n                }\n\n                throw new Error('VastAdUnit already started');\n\n              case 3:\n                inlineAd = this.vastChain[0].ad;\n                _videoAdContainer = this.videoAdContainer, videoElement = _videoAdContainer.videoElement, element = _videoAdContainer.element;\n                media = findBestMedia(inlineAd, videoElement, element);\n\n                if (!Boolean(media)) {\n                  _context2.next = 16;\n                  break;\n                }\n\n                if (!this.icons) {\n                  _context2.next = 11;\n                  break;\n                }\n\n                drawIcons = function () {\n                  var _ref2 = asyncToGenerator( /*#__PURE__*/regenerator.mark(function _callee() {\n                    return regenerator.wrap(function _callee$(_context) {\n                      while (1) {\n                        switch (_context.prev = _context.next) {\n                          case 0:\n                            if (!_this2.isFinished()) {\n                              _context.next = 2;\n                              break;\n                            }\n\n                            return _context.abrupt('return');\n\n                          case 2:\n                            _context.next = 4;\n                            return _this2[_protected].drawIcons();\n\n                          case 4:\n\n                            if (_this2[_protected].hasPendingIconRedraws() && !_this2.isFinished()) {\n                              once(videoElement, 'timeupdate', drawIcons);\n                            }\n\n                          case 5:\n                          case 'end':\n                            return _context.stop();\n                        }\n                      }\n                    }, _callee, _this2);\n                  }));\n\n                  return function drawIcons() {\n                    return _ref2.apply(this, arguments);\n                  };\n                }();\n\n                _context2.next = 11;\n                return drawIcons();\n\n              case 11:\n\n                videoElement.src = media.src;\n                this.assetUri = media.src;\n                videoElement.play();\n                _context2.next = 19;\n                break;\n\n              case 16:\n                adUnitError = new Error('Can\\'t find a suitable media to play');\n\n\n                adUnitError.code = 403;\n                this[_private].handleMetric(errorEvt, adUnitError);\n\n              case 19:\n\n                this[_protected].started = true;\n\n              case 20:\n              case 'end':\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function start() {\n        return _ref.apply(this, arguments);\n      }\n\n      return start;\n    }()\n\n    /**\n     * Resumes a previously paused ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     */\n\n  }, {\n    key: 'resume',\n    value: function resume() {\n      this.videoAdContainer.videoElement.play();\n    }\n\n    /**\n     * Pauses the ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     */\n\n  }, {\n    key: 'pause',\n    value: function pause() {\n      this.videoAdContainer.videoElement.pause();\n    }\n\n    /**\n     * Returns true if the ad is paused and false otherwise\n     */\n\n  }, {\n    key: 'paused',\n    value: function paused() {\n      return this.videoAdContainer.videoElement.paused;\n    }\n\n    /**\n     * Sets the volume of the ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     *\n     * @param {number} volume - must be a value between 0 and 1;\n     */\n\n  }, {\n    key: 'setVolume',\n    value: function setVolume(volume) {\n      this.videoAdContainer.videoElement.volume = volume;\n    }\n\n    /**\n     * Gets the volume of the ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     *\n     * @returns {number} - the volume of the ad unit.\n     */\n\n  }, {\n    key: 'getVolume',\n    value: function getVolume() {\n      return this.videoAdContainer.videoElement.volume;\n    }\n\n    /**\n     * Cancels the ad unit.\n     *\n     * @throws if ad unit is finished.\n     */\n\n  }, {\n    key: 'cancel',\n    value: function cancel() {\n      this[_protected].throwIfFinished();\n\n      this.videoAdContainer.videoElement.pause();\n\n      this[_protected].finish();\n    }\n\n    /**\n     * Returns the duration of the ad Creative or 0 if there is no creative.\n     *\n     * @returns {number} - the duration of the ad unit.\n     */\n\n  }, {\n    key: 'duration',\n    value: function duration() {\n      if (!this.isStarted()) {\n        return 0;\n      }\n\n      return this.videoAdContainer.videoElement.duration;\n    }\n\n    /**\n     * Returns the current time of the ad Creative or 0 if there is no creative.\n     *\n     * @returns {number} - the current time of the ad unit.\n     */\n\n  }, {\n    key: 'currentTime',\n    value: function currentTime() {\n      if (!this.isStarted()) {\n        return 0;\n      }\n\n      return this.videoAdContainer.videoElement.currentTime;\n    }\n\n    /**\n     * This method resizes the ad unit to fit the available space in the passed {@link VideoAdContainer}\n     *\n     * @param width {number} - the new width of the ad container.\n     * @param height {number} - the new height of the ad container.\n     * @param viewmode {string} - fullscreen | normal | thumbnail\n     * @returns {Promise} - that resolves once the unit was resized\n     */\n\n  }, {\n    key: 'resize',\n    value: function () {\n      var _ref3 = asyncToGenerator( /*#__PURE__*/regenerator.mark(function _callee3(width, height, viewmode) {\n        var inlineAd, _videoAdContainer2, videoElement, element, media;\n\n        return regenerator.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return get$1(VastAdUnit.prototype.__proto__ || Object.getPrototypeOf(VastAdUnit.prototype), 'resize', this).call(this, width, height, viewmode);\n\n              case 2:\n\n                if (this.isStarted() && !this.isFinished()) {\n                  inlineAd = this.vastChain[0].ad;\n                  _videoAdContainer2 = this.videoAdContainer, videoElement = _videoAdContainer2.videoElement, element = _videoAdContainer2.element;\n                  media = findBestMedia(inlineAd, videoElement, element);\n\n\n                  if (Boolean(media) && videoElement.src !== media.src) {\n                    updateMedia(videoElement, media);\n                  }\n                }\n\n              case 3:\n              case 'end':\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function resize(_x2, _x3, _x4) {\n        return _ref3.apply(this, arguments);\n      }\n\n      return resize;\n    }()\n  }]);\n  return VastAdUnit;\n}(VideoAdUnit);\n\nvar SUPPORTED_MIMETYPES = ['text/javascript', 'text/javascript1.0', 'text/javascript1.2', 'text/javascript1.4', 'text/jscript', 'application/javascript', 'application/x-javascript', 'text/ecmascript', 'text/ecmascript1.0', 'text/ecmascript1.2', 'text/ecmascript1.4', 'text/livescript', 'application/ecmascript', 'application/x-ecmascript'];\n\nvar isSupported = function isSupported(_ref) {\n  var type = _ref.type;\n  return SUPPORTED_MIMETYPES.some(function (mimetype) {\n    return mimetype === type;\n  });\n};\n\nvar _this$3 = undefined;\n\nvar loadCreative = function () {\n  var _ref = asyncToGenerator( /*#__PURE__*/regenerator.mark(function _callee(vastChain, videoAdContainer) {\n    var creative, src, type, context;\n    return regenerator.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            creative = (getInteractiveFiles(vastChain[0].ad) || []).filter(isSupported)[0];\n\n            if (creative) {\n              _context.next = 3;\n              break;\n            }\n\n            throw new TypeError('VastChain does not contain a supported vpaid creative');\n\n          case 3:\n            src = creative.src, type = creative.type;\n            _context.next = 6;\n            return videoAdContainer.addScript(src, { type: type });\n\n          case 6:\n            context = videoAdContainer.executionContext;\n            return _context.abrupt('return', context.getVPAIDAd());\n\n          case 8:\n          case 'end':\n            return _context.stop();\n        }\n      }\n    }, _callee, _this$3);\n  }));\n\n  return function loadCreative(_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar handshakeVersion = 'handshakeVersion';\nvar resizeAd = 'resizeAd';\nvar startAd = 'startAd';\nvar stopAd = 'stopAd';\nvar pauseAd = 'pauseAd';\nvar resumeAd = 'resumeAd';\nvar getAdRemainingTime = 'getAdRemainingTime';\nvar getAdDuration = 'getAdDuration';\nvar getAdVolume = 'getAdVolume';\nvar getAdIcons = 'getAdIcons';\nvar setAdVolume = 'setAdVolume';\nvar adLoaded = 'AdLoaded';\nvar adStarted = 'AdStarted';\nvar adStopped = 'AdStopped';\nvar adSkipped = 'AdSkipped';\nvar adSkippableStateChange = 'AdSkippableStateChange';\nvar adSizeChange = 'AdSizeChange';\nvar adLinearChange = 'AdLinearChange';\nvar adDurationChange = 'AdDurationChange';\nvar adExpandedChange = 'AdExpandedChange';\nvar adRemainingTimeChange = 'AdRemainingTimeChange';\nvar adVolumeChange = 'AdVolumeChange';\nvar adImpression = 'AdImpression';\nvar adVideoStart = 'AdVideoStart';\nvar adVideoFirstQuartile = 'AdVideoFirstQuartile';\nvar adVideoMidpoint = 'AdVideoMidpoint';\nvar adVideoThirdQuartile = 'AdVideoThirdQuartile';\nvar adVideoComplete = 'AdVideoComplete';\nvar adClickThru = 'AdClickThru';\nvar adInteraction = 'AdInteraction';\nvar adUserAcceptInvitation = 'AdUserAcceptInvitation';\nvar adUserMinimize = 'AdUserMinimize';\nvar adUserClose = 'AdUserClose';\nvar adPaused = 'AdPaused';\nvar adPlaying = 'AdPlaying';\nvar adLog = 'AdLog';\nvar adError = 'AdError';\n\nvar EVENTS = [adLoaded, adStarted, adStopped, adSkipped, adSkippableStateChange, adSizeChange, adLinearChange, adDurationChange, adExpandedChange, adRemainingTimeChange, adVolumeChange, adImpression, adVideoStart, adVideoFirstQuartile, adVideoMidpoint, adVideoThirdQuartile, adVideoComplete, adClickThru, adInteraction, adUserAcceptInvitation, adUserMinimize, adUserClose, adPaused, adPlaying, adLog, adError];\n\nvar waitFor$1 = function waitFor(creativeAd, event, timeout) {\n  return new Promise(function (resolve, reject) {\n    // eslint-disable-next-line prefer-const\n    var timeoutId = void 0;\n    var handler = function handler() {\n      if (typeof timeout === 'number') {\n        clearTimeout(timeoutId);\n      }\n\n      creativeAd.unsubscribe(handler, event);\n      resolve();\n    };\n\n    if (typeof timeout === 'number') {\n      timeoutId = setTimeout(function () {\n        creativeAd.unsubscribe(handler, event);\n        reject(new Error('Timeout waiting for event \\'' + event + '\\''));\n      }, timeout);\n    }\n\n    creativeAd.subscribe(handler, event);\n  });\n};\n\nvar callAndWait = function callAndWait(creativeAd, method, event) {\n  for (var _len = arguments.length, args = Array(_len > 3 ? _len - 3 : 0), _key = 3; _key < _len; _key++) {\n    args[_key - 3] = arguments[_key];\n  }\n\n  var waitPromise = waitFor$1(creativeAd, event, 5000);\n\n  creativeAd[method].apply(creativeAd, args);\n\n  return waitPromise;\n};\n\nvar major = function major(version) {\n  var parts = version.split('.');\n\n  return parseInt(parts[0], 10);\n};\n\nvar isSupported$1 = function isSupported(supportedVersion, creativeVersion) {\n  var creativeMajorNum = major(creativeVersion);\n\n  if (creativeMajorNum < 1) {\n    return false;\n  }\n\n  return creativeMajorNum <= major(supportedVersion);\n};\n\nvar handshake = function handshake(creative, supportedVersion) {\n  var creativeVersion = creative[handshakeVersion](supportedVersion);\n\n  if (!isSupported$1(supportedVersion, creativeVersion)) {\n    throw new Error('Creative Version \\'' + creativeVersion + '\\' not supported');\n  }\n\n  return creativeVersion;\n};\n\nvar createSlot = function createSlot(placeholder, width, height) {\n  var slot = document.createElement('DIV');\n\n  Object.assign(slot.style, {\n    border: '0px',\n    cursor: 'pointer',\n    height: height + 'px',\n    left: '0px',\n    margin: '0px',\n    padding: '0px',\n    position: 'absolute',\n    top: '0px',\n    width: width + 'px'\n  });\n\n  placeholder.appendChild(slot);\n\n  return slot;\n};\nvar initAd$1 = function initAd(creativeAd, videoAdContainer, vastChain) {\n  var placeholder = videoAdContainer.element;\n\n  var _placeholder$getBound = placeholder.getBoundingClientRect(),\n      width = _placeholder$getBound.width,\n      height = _placeholder$getBound.height;\n\n  var mode = viewmode(width, height);\n  var desiredBitrate = -1;\n  var environmentVars = {\n    slot: createSlot(placeholder, width, height),\n    videoSlot: videoAdContainer.videoElement,\n    videoSlotCanAutoPlay: videoAdContainer.isOriginalVideoElement\n  };\n  var creativeData = getCreativeData(vastChain[0].XML);\n\n  creativeAd.initAd(width, height, mode, desiredBitrate, creativeData, environmentVars);\n};\n\nvar complete$3 = linearEvents.complete,\n    mute$2 = linearEvents.mute,\n    unmute$2 = linearEvents.unmute,\n    skip$3 = linearEvents.skip,\n    start$3 = linearEvents.start,\n    firstQuartile$2 = linearEvents.firstQuartile,\n    pause$2 = linearEvents.pause,\n    resume$2 = linearEvents.resume,\n    impression$2 = linearEvents.impression,\n    midpoint$2 = linearEvents.midpoint,\n    thirdQuartile$2 = linearEvents.thirdQuartile,\n    clickThrough$2 = linearEvents.clickThrough,\n    errorEvt$1 = linearEvents.error,\n    closeLinear$1 = linearEvents.closeLinear;\n\n// eslint-disable-next-line id-match\n\nvar _private$1 = Symbol('_private');\n\nvar vpaidGeneralError = function vpaidGeneralError(payload) {\n  var error$$1 = payload instanceof Error ? payload : new Error('VPAID general error');\n\n  if (!error$$1.code) {\n    error$$1.code = 901;\n  }\n\n  return error$$1;\n};\n\n/**\n * @class\n * @alias VpaidAdUnit\n * @extends VideoAdUnit\n * @implements NonLinearEvents\n * @implements LinearEvents\n * @description This class provides everything necessary to run a Vpaid ad.\n */\n\nvar VpaidAdUnit = function (_VideoAdUnit) {\n  inherits(VpaidAdUnit, _VideoAdUnit);\n\n  /**\n   * Creates a {VpaidAdUnit}.\n   *\n   * @param {VastChain} vastChain - The {@link VastChain} with all the {@link VastResponse}\n   * @param {VideoAdContainer} videoAdContainer - container instance to place the ad\n   * @param {Object} [options] - Options Map. The allowed properties are:\n   * @param {Console} [options.logger] - Optional logger instance. Must comply to the [Console interface]{@link https://developer.mozilla.org/es/docs/Web/API/Console}.\n   * Defaults to `window.console`\n   * @param {boolean} [options.viewability] - if true it will pause the ad whenever is not visible for the viewer.\n   * Defaults to `false`\n   * @param {boolean} [options.responsive] - if true it will resize the ad unit whenever the ad container changes sizes\n   * Defaults to `false`\n   * Defaults to `window.console`\n   */\n\n\n  /** Ad unit type. Will be `VPAID` for VpaidAdUnit */\n  function VpaidAdUnit(vastChain, videoAdContainer) {\n    var _evtHandler;\n\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    classCallCheck(this, VpaidAdUnit);\n\n    var _this = possibleConstructorReturn(this, (VpaidAdUnit.__proto__ || Object.getPrototypeOf(VpaidAdUnit)).call(this, vastChain, videoAdContainer, options));\n\n    _this[_private$1] = {\n      evtHandler: (_evtHandler = {}, defineProperty(_evtHandler, adClickThru, function (url, id, playerHandles) {\n        if (playerHandles) {\n          if (_this.paused()) {\n            _this.resume();\n          } else {\n            var clickThroughUrl = typeof url === 'string' && url.length > 0 ? url : getClickThrough(_this.vastChain[0].ad);\n\n            _this.pause();\n            window.open(clickThroughUrl, '_blank');\n          }\n        }\n\n        _this.emit(clickThrough$2, {\n          adUnit: _this,\n          type: clickThrough$2\n        });\n      }), defineProperty(_evtHandler, adDurationChange, function () {\n        _this.emit(adProgress, {\n          adUnit: _this,\n          type: adProgress\n        });\n      }), defineProperty(_evtHandler, adError, function (payload) {\n        _this.error = vpaidGeneralError(payload);\n        _this.errorCode = _this.error.code;\n\n        _this[_protected].onErrorCallbacks.forEach(function (callback) {\n          return callback(_this.error);\n        });\n\n        _this[_protected].finish();\n\n        _this.emit(errorEvt$1, {\n          adUnit: _this,\n          type: errorEvt$1\n        });\n      }), defineProperty(_evtHandler, adImpression, function () {\n        _this.emit(impression$2, {\n          adUnit: _this,\n          type: impression$2\n        });\n      }), defineProperty(_evtHandler, adPaused, function () {\n        _this[_private$1].paused = true;\n        _this.emit(pause$2, {\n          adUnit: _this,\n          type: pause$2\n        });\n      }), defineProperty(_evtHandler, adPlaying, function () {\n        _this[_private$1].paused = false;\n        _this.emit(resume$2, {\n          adUnit: _this,\n          type: resume$2\n        });\n      }), defineProperty(_evtHandler, adRemainingTimeChange, function () {\n        _this.emit(adProgress, {\n          adUnit: _this,\n          type: adProgress\n        });\n      }), defineProperty(_evtHandler, adSkipped, function () {\n        _this.cancel();\n        _this.emit(skip$3, {\n          adUnit: _this,\n          type: skip$3\n        });\n      }), defineProperty(_evtHandler, adStarted, function () {\n        _this.emit(creativeView, {\n          adUnit: _this,\n          type: creativeView\n        });\n      }), defineProperty(_evtHandler, adUserAcceptInvitation, function () {\n        _this.emit(acceptInvitation, {\n          adUnit: _this,\n          type: acceptInvitation\n        });\n      }), defineProperty(_evtHandler, adUserClose, function () {\n        _this.emit(closeLinear$1, {\n          adUnit: _this,\n          type: closeLinear$1\n        });\n\n        _this[_protected].finish();\n      }), defineProperty(_evtHandler, adUserMinimize, function () {\n        _this.emit(adCollapse, {\n          adUnit: _this,\n          type: adCollapse\n        });\n      }), defineProperty(_evtHandler, adVideoComplete, function () {\n        _this.emit(complete$3, {\n          adUnit: _this,\n          type: complete$3\n        });\n\n        _this[_protected].finish();\n      }), defineProperty(_evtHandler, adVideoFirstQuartile, function () {\n        _this.emit(firstQuartile$2, {\n          adUnit: _this,\n          type: firstQuartile$2\n        });\n      }), defineProperty(_evtHandler, adVideoMidpoint, function () {\n        _this.emit(midpoint$2, {\n          adUnit: _this,\n          type: midpoint$2\n        });\n      }), defineProperty(_evtHandler, adVideoStart, function () {\n        _this[_private$1].paused = false;\n        _this.emit(start$3, {\n          adUnit: _this,\n          type: start$3\n        });\n      }), defineProperty(_evtHandler, adVideoThirdQuartile, function () {\n        _this.emit(thirdQuartile$2, {\n          adUnit: _this,\n          type: thirdQuartile$2\n        });\n      }), defineProperty(_evtHandler, adVolumeChange, function () {\n        var volume = _this.getVolume();\n\n        _this.emit(volumeChanged, {\n          adUnit: _this,\n          type: volumeChanged\n        });\n\n        if (volume === 0 && !_this[_private$1].muted) {\n          _this[_private$1].muted = true;\n          _this.emit(mute$2, {\n            adUnit: _this,\n            type: mute$2\n          });\n        }\n\n        if (volume > 0 && _this[_private$1].muted) {\n          _this[_private$1].muted = false;\n          _this.emit(unmute$2, {\n            adUnit: _this,\n            type: unmute$2\n          });\n        }\n      }), _evtHandler),\n      handleVpaidEvt: function handleVpaidEvt(event) {\n        for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n          args[_key - 1] = arguments[_key];\n        }\n\n        var handler = _this[_private$1].evtHandler[event];\n\n        if (handler) {\n          handler.apply(undefined, args);\n        }\n\n        _this.emit(event, {\n          adUnit: _this,\n          type: event\n        });\n      },\n      muted: false,\n      paused: true\n    };\n    _this.type = 'VPAID';\n    _this.creativeAd = null;\n\n\n    _this[_private$1].loadCreativePromise = loadCreative(vastChain, videoAdContainer);\n    return _this;\n  }\n\n  /**\n   * Starts the ad unit.\n   *\n   * @throws if called twice.\n   * @throws if ad unit is finished.\n   */\n\n\n  /** Reference to the Vpaid Creative ad unit. Will be null before the ad unit starts. */\n\n\n  createClass(VpaidAdUnit, [{\n    key: 'start',\n    value: function () {\n      var _ref = asyncToGenerator( /*#__PURE__*/regenerator.mark(function _callee2() {\n        var _this2 = this;\n\n        var adLoadedPromise, _iteratorNormalCompletion, _didIteratorError, _iteratorError, _iterator, _step, creativeEvt, videoElement, drawIcons;\n\n        return regenerator.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                this[_protected].throwIfFinished();\n\n                if (!this.isStarted()) {\n                  _context2.next = 3;\n                  break;\n                }\n\n                throw new Error('VpaidAdUnit already started');\n\n              case 3:\n                _context2.prev = 3;\n                _context2.next = 6;\n                return this[_private$1].loadCreativePromise;\n\n              case 6:\n                this.creativeAd = _context2.sent;\n                adLoadedPromise = waitFor$1(this.creativeAd, adLoaded);\n                _iteratorNormalCompletion = true;\n                _didIteratorError = false;\n                _iteratorError = undefined;\n                _context2.prev = 11;\n\n\n                for (_iterator = EVENTS[Symbol.iterator](); !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                  creativeEvt = _step.value;\n\n                  this.creativeAd.subscribe(this[_private$1].handleVpaidEvt.bind(this, creativeEvt), creativeEvt);\n                }\n\n                _context2.next = 19;\n                break;\n\n              case 15:\n                _context2.prev = 15;\n                _context2.t0 = _context2['catch'](11);\n                _didIteratorError = true;\n                _iteratorError = _context2.t0;\n\n              case 19:\n                _context2.prev = 19;\n                _context2.prev = 20;\n\n                if (!_iteratorNormalCompletion && _iterator.return) {\n                  _iterator.return();\n                }\n\n              case 22:\n                _context2.prev = 22;\n\n                if (!_didIteratorError) {\n                  _context2.next = 25;\n                  break;\n                }\n\n                throw _iteratorError;\n\n              case 25:\n                return _context2.finish(22);\n\n              case 26:\n                return _context2.finish(19);\n\n              case 27:\n                if (this.creativeAd[getAdIcons] && !this.creativeAd[getAdIcons]()) {\n                  this.icons = null;\n                }\n\n                handshake(this.creativeAd, '2.0');\n                initAd$1(this.creativeAd, this.videoAdContainer, this.vastChain);\n\n                _context2.next = 32;\n                return adLoadedPromise;\n\n              case 32:\n                if (this.videoAdContainer.isDestroyed()) {\n                  _context2.next = 48;\n                  break;\n                }\n\n                _context2.prev = 33;\n                videoElement = this.videoAdContainer.videoElement;\n\n\n                if (videoElement.muted) {\n                  this[_private$1].muted = true;\n                  this.setVolume(0);\n                } else {\n                  this.setVolume(videoElement.volume);\n                }\n\n                _context2.next = 38;\n                return callAndWait(this.creativeAd, startAd, adStarted);\n\n              case 38:\n                if (!this.icons) {\n                  _context2.next = 42;\n                  break;\n                }\n\n                drawIcons = function () {\n                  var _ref2 = asyncToGenerator( /*#__PURE__*/regenerator.mark(function _callee() {\n                    return regenerator.wrap(function _callee$(_context) {\n                      while (1) {\n                        switch (_context.prev = _context.next) {\n                          case 0:\n                            if (!_this2.isFinished()) {\n                              _context.next = 2;\n                              break;\n                            }\n\n                            return _context.abrupt('return');\n\n                          case 2:\n                            _context.next = 4;\n                            return _this2[_protected].drawIcons();\n\n                          case 4:\n\n                            if (_this2[_protected].hasPendingIconRedraws() && !_this2.isFinished()) {\n                              setTimeout(drawIcons, 500);\n                            }\n\n                          case 5:\n                          case 'end':\n                            return _context.stop();\n                        }\n                      }\n                    }, _callee, _this2);\n                  }));\n\n                  return function drawIcons() {\n                    return _ref2.apply(this, arguments);\n                  };\n                }();\n\n                _context2.next = 42;\n                return drawIcons();\n\n              case 42:\n\n                this[_protected].started = true;\n                _context2.next = 48;\n                break;\n\n              case 45:\n                _context2.prev = 45;\n                _context2.t1 = _context2['catch'](33);\n\n                this.cancel();\n\n              case 48:\n                return _context2.abrupt('return', this);\n\n              case 51:\n                _context2.prev = 51;\n                _context2.t2 = _context2['catch'](3);\n\n                this[_private$1].handleVpaidEvt(adError, _context2.t2);\n                throw _context2.t2;\n\n              case 55:\n              case 'end':\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[3, 51], [11, 15, 19, 27], [20,, 22, 26], [33, 45]]);\n      }));\n\n      function start$$1() {\n        return _ref.apply(this, arguments);\n      }\n\n      return start$$1;\n    }()\n\n    /**\n     * Resumes a previously paused ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     */\n\n  }, {\n    key: 'resume',\n    value: function resume$$1() {\n      this.creativeAd[resumeAd]();\n    }\n\n    /**\n     * Pauses the ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     */\n\n  }, {\n    key: 'pause',\n    value: function pause$$1() {\n      this.creativeAd[pauseAd]();\n    }\n\n    /**\n     * Returns true if the ad is paused and false otherwise\n     */\n\n  }, {\n    key: 'paused',\n    value: function paused() {\n      return this.isFinished() || this[_private$1].paused;\n    }\n\n    /**\n     * Sets the volume of the ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     *\n     * @param {number} volume - must be a value between 0 and 1;\n     */\n\n  }, {\n    key: 'setVolume',\n    value: function setVolume(volume) {\n      this.creativeAd[setAdVolume](volume);\n    }\n\n    /**\n     * Gets the volume of the ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     *\n     * @returns {number} - the volume of the ad unit.\n     */\n\n  }, {\n    key: 'getVolume',\n    value: function getVolume() {\n      return this.creativeAd[getAdVolume]();\n    }\n\n    /**\n     * Cancels the ad unit.\n     *\n     * @throws if ad unit is finished.\n     */\n\n  }, {\n    key: 'cancel',\n    value: function cancel() {\n      this[_protected].throwIfFinished();\n\n      this.creativeAd[stopAd]();\n\n      this[_protected].finish();\n    }\n\n    /**\n     * Returns the duration of the ad Creative or 0 if there is no creative.\n     *\n     * Note: if the user has engaged with the ad, the duration becomes unknown and it will return 0;\n     *\n     * @returns {number} - the duration of the ad unit.\n     */\n\n  }, {\n    key: 'duration',\n    value: function duration() {\n      if (!this.creativeAd) {\n        return 0;\n      }\n\n      var duration = this.creativeAd[getAdDuration]();\n\n      if (duration < 0) {\n        return 0;\n      }\n\n      return duration;\n    }\n\n    /**\n     * Returns the current time of the ad Creative or 0 if there is no creative.\n     *\n     * Note: if the user has engaged with the ad, the currentTime becomes unknown and it will return 0;\n     *\n     * @returns {number} - the current time of the ad unit.\n     */\n\n  }, {\n    key: 'currentTime',\n    value: function currentTime() {\n      if (!this.creativeAd) {\n        return 0;\n      }\n\n      var remainingTime = this.creativeAd[getAdRemainingTime]();\n\n      if (remainingTime < 0) {\n        return 0;\n      }\n\n      return this.duration() - remainingTime;\n    }\n\n    /**\n     * This method resizes the ad unit to fit the available space in the passed {@link VideoAdContainer}\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     *\n     * @returns {Promise} - that resolves once the unit was resized\n     */\n\n  }, {\n    key: 'resize',\n    value: function () {\n      var _ref3 = asyncToGenerator( /*#__PURE__*/regenerator.mark(function _callee3(width, height, viewmode) {\n        return regenerator.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return get$1(VpaidAdUnit.prototype.__proto__ || Object.getPrototypeOf(VpaidAdUnit.prototype), 'resize', this).call(this, width, height, viewmode);\n\n              case 2:\n                return _context3.abrupt('return', callAndWait(this.creativeAd, resizeAd, adSizeChange, width, height, viewmode));\n\n              case 3:\n              case 'end':\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function resize(_x2, _x3, _x4) {\n        return _ref3.apply(this, arguments);\n      }\n\n      return resize;\n    }()\n  }]);\n  return VpaidAdUnit;\n}(VideoAdUnit);\n\nvar createVideoAdUnit = function createVideoAdUnit(vastChain, videoAdContainer, options) {\n  var tracker = options.tracker,\n      type = options.type;\n\n  var adUnit = type === 'VPAID' ? new VpaidAdUnit(vastChain, videoAdContainer, options) : new VastAdUnit(vastChain, videoAdContainer, options);\n\n  Object.values(linearEvents).forEach(function (linearEvent) {\n    return adUnit.on(linearEvent, function (event) {\n      var evtType = event.type,\n          data = event.data;\n\n      var payload = {\n        data: data,\n        errorCode: adUnit.errorCode,\n        tracker: tracker\n      };\n\n      trackLinearEvent(evtType, vastChain, payload);\n    });\n  });\n\n  Object.values(nonLinearEvents).forEach(function (nonLinearEvent) {\n    return adUnit.on(nonLinearEvent, function (event) {\n      var payload = {\n        data: event.data,\n        tracker: tracker\n      };\n\n      trackNonLinearEvent(event.type, vastChain, payload);\n    });\n  });\n\n  return adUnit;\n};\n\nvar _this$4 = undefined;\n\nvar validate$2 = function validate(vastChain, videoAdContainer) {\n  if (!Array.isArray(vastChain) || vastChain.length === 0) {\n    throw new TypeError('Invalid vastChain');\n  }\n\n  if (!(videoAdContainer instanceof VideoAdContainer)) {\n    throw new TypeError('Invalid VideoAdContainer');\n  }\n};\n\nvar hasVpaidCreative = function hasVpaidCreative(ad) {\n  return Boolean(getInteractiveFiles(ad));\n};\n\nvar hasVastCreative = function hasVastCreative(ad, videoElement) {\n  var mediaFiles = getMediaFiles(ad);\n\n  if (mediaFiles) {\n    return mediaFiles.some(function (mediaFile) {\n      return canPlay(videoElement, mediaFile);\n    });\n  }\n\n  return false;\n};\n\nvar startAdUnit = function startAdUnit(adUnit, _ref) {\n  var onAdReady = _ref.onAdReady;\n  return new Promise(function (resolve, reject) {\n    adUnit.onError(reject);\n    adUnit.on('start', function () {\n      return resolve(adUnit);\n    });\n\n    onAdReady(adUnit);\n    adUnit.start();\n  });\n};\n\nvar tryToStartVpaidAd = function tryToStartVpaidAd(vastChain, videoAdContainer, options) {\n  if (!hasVpaidCreative(vastChain[0].ad)) {\n    throw new Error('No valid creative found in the passed VAST chain');\n  }\n\n  var adUnit = createVideoAdUnit(vastChain, videoAdContainer, _extends({}, options, {\n    type: 'VPAID'\n  }));\n\n  return startAdUnit(adUnit, options);\n};\n\nvar startVastAd = function startVastAd(vastChain, videoAdContainer, options) {\n  var adUnit = createVideoAdUnit(vastChain, videoAdContainer, _extends({}, options, {\n    type: 'VAST'\n  }));\n\n  return startAdUnit(adUnit, options);\n};\n\nvar startVideoAd = function () {\n  var _ref2 = asyncToGenerator( /*#__PURE__*/regenerator.mark(function _callee(vastChain, videoAdContainer, options) {\n    return regenerator.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            validate$2(vastChain, videoAdContainer);\n            _context.prev = 1;\n            _context.next = 4;\n            return tryToStartVpaidAd(vastChain, videoAdContainer, options);\n\n          case 4:\n            return _context.abrupt('return', _context.sent);\n\n          case 7:\n            _context.prev = 7;\n            _context.t0 = _context['catch'](1);\n\n            if (!hasVastCreative(vastChain[0].ad, videoAdContainer.videoElement)) {\n              _context.next = 11;\n              break;\n            }\n\n            return _context.abrupt('return', startVastAd(vastChain, videoAdContainer, options));\n\n          case 11:\n            throw _context.t0;\n\n          case 12:\n          case 'end':\n            return _context.stop();\n        }\n      }\n    }, _callee, _this$4, [[1, 7]]);\n  }));\n\n  return function startVideoAd(_x, _x2, _x3) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\nvar _this$5 = undefined;\n\n/**\n * Will try to start video ad in the passed {@link VastChain} and return the started VideoAdUnit.\n *\n * @memberof module:@mailonline/video-ad-sdk\n * @static\n * @throws if there is an error starting the ad or it times out (by throw I mean that it will reject promise with the error).\n * @param {VastChain} vastChain - The {@link VastChain} with all the {@link VastResponse}s.\n * @param {HTMLElement} placeholder - placeholder element that will contain the video ad.\n * @param {Object} [options] - Options Map. The allowed properties are:\n * @param {runWaterfall~onAdReady} options.onAdReady - will be called once the ad is ready with the ad unit.\n * @param {HTMLVideoElement} [options.videoElement] - optional videoElement that will be used to play the ad.\n * @param {Console} [options.logger] - Optional logger instance. Must comply to the [Console interface]{@link https://developer.mozilla.org/es/docs/Web/API/Console}.\n * Defaults to `window.console`\n * @param {boolean} [options.viewability] - if true it will pause the ad whenever is not visible for the viewer.\n * Defaults to `false`\n * @param {boolean} [options.responsive] - if true it will resize the ad unit whenever the ad container changes sizes.\n * Defaults to `false`\n * @param {number} [options.timeout] - timeout number in milliseconds. If set, the video ad will time out if it doesn't start within the specified time.\n * @param {TrackerFn} [options.tracker] - If provided it will be used to track the VAST events instead of the default {@link pixelTracker}.\n * @param {Object} [options.hooks] - Optional map with hooks to configure the behaviour of the ad.\n * @param {Function} [options.hooks.createSkipControl] - If provided it will be called to generate the skip control. Must return a clickable [HTMLElement](https://developer.mozilla.org/es/docs/Web/API/HTMLElement) that is detached from the DOM.\n * @returns {Promise.<VastAdUnit|VpaidAdUnit>} - The video ad unit.\n */\nvar run = function () {\n  var _ref = asyncToGenerator( /*#__PURE__*/regenerator.mark(function _callee(vastChain, placeholder, options) {\n    var videoAdContainer, timeout, adUnitPromise, timedOut, timeoutId, timeoutPromise, adUnit;\n    return regenerator.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            videoAdContainer = void 0;\n            _context.prev = 1;\n            timeout = options.timeout;\n\n\n            videoAdContainer = createVideoAdContainer(placeholder, options.videoElement);\n            adUnitPromise = startVideoAd(vastChain, videoAdContainer, options);\n\n\n            if (typeof timeout === 'number') {\n              timedOut = false;\n              timeoutId = void 0;\n              timeoutPromise = new Promise(function (resolve, reject) {\n                timeoutId = setTimeout(function () {\n                  var tracker = options.tracker;\n\n\n                  trackError(vastChain, {\n                    errorCode: 402,\n                    tracker: tracker\n                  });\n                  timedOut = true;\n                  reject(new Error('Timeout while starting the ad'));\n                }, options.timeout);\n              });\n\n\n              adUnitPromise = Promise.race([\n              // eslint-disable-next-line promise/prefer-await-to-then\n              adUnitPromise.then(function (newAdUnit) {\n                if (timedOut) {\n                  if (newAdUnit.isStarted()) {\n                    newAdUnit.cancel();\n                  }\n                } else {\n                  clearTimeout(timeoutId);\n                }\n\n                return newAdUnit;\n              }), timeoutPromise]);\n            }\n\n            _context.next = 8;\n            return adUnitPromise;\n\n          case 8:\n            adUnit = _context.sent;\n\n\n            adUnit.onFinish(function () {\n              videoAdContainer.destroy();\n            });\n\n            return _context.abrupt('return', adUnit);\n\n          case 13:\n            _context.prev = 13;\n            _context.t0 = _context['catch'](1);\n\n            if (videoAdContainer) {\n              videoAdContainer.destroy();\n            }\n\n            throw _context.t0;\n\n          case 17:\n          case 'end':\n            return _context.stop();\n        }\n      }\n    }, _callee, _this$5, [[1, 13]]);\n  }));\n\n  return function run(_x, _x2, _x3) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar _this$6 = undefined;\n\nvar fetch$1 = function () {\n  var _ref = asyncToGenerator( /*#__PURE__*/regenerator.mark(function _callee(endpoint) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var defaults$$1, fetchOptions, response, error;\n    return regenerator.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            defaults$$1 = {\n              credentials: 'include'\n            };\n            fetchOptions = Object.assign({}, defaults$$1, options);\n            _context.next = 4;\n            return window.fetch(endpoint, fetchOptions);\n\n          case 4:\n            response = _context.sent;\n\n            if (!(response.status >= 400)) {\n              _context.next = 9;\n              break;\n            }\n\n            error = new Error(response.statusText);\n\n\n            error.response = response;\n            throw error;\n\n          case 9:\n            return _context.abrupt('return', response);\n\n          case 10:\n          case 'end':\n            return _context.stop();\n        }\n      }\n    }, _callee, _this$6);\n  }));\n\n  return function fetch(_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar requested = Symbol('requested');\n\nvar markAdAsRequested = function markAdAsRequested(ad) {\n  ad[requested] = true;\n};\n\nvar hasAdBeenRequested = function hasAdBeenRequested(ad) {\n  return Boolean(ad[requested]);\n};\n\nvar _this$7 = undefined;\n\nvar validateChain = function validateChain(vastChain, _ref) {\n  var _ref$wrapperLimit = _ref.wrapperLimit,\n      wrapperLimit = _ref$wrapperLimit === undefined ? 5 : _ref$wrapperLimit;\n\n  if (vastChain.length > wrapperLimit) {\n    var error = new Error('Wrapper Limit reached');\n\n    error.code = 304;\n    throw error;\n  }\n};\n\nvar fetchAdXML = function () {\n  var _ref2 = asyncToGenerator( /*#__PURE__*/regenerator.mark(function _callee(adTag, options) {\n    var response, XML;\n    return regenerator.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            _context.next = 3;\n            return fetch$1(adTag, options);\n\n          case 3:\n            response = _context.sent;\n            _context.next = 6;\n            return response.text();\n\n          case 6:\n            XML = _context.sent;\n            return _context.abrupt('return', XML);\n\n          case 10:\n            _context.prev = 10;\n            _context.t0 = _context['catch'](0);\n\n            _context.t0.code = 502;\n\n            throw _context.t0;\n\n          case 14:\n          case 'end':\n            return _context.stop();\n        }\n      }\n    }, _callee, _this$7, [[0, 10]]);\n  }));\n\n  return function fetchAdXML(_x, _x2) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\nvar parseVastXml = function parseVastXml(xml) {\n  try {\n    return parseXml(xml);\n  } catch (error) {\n    error.code = 100;\n    throw error;\n  }\n};\n\nvar getAd = function getAd(parsedXML) {\n  try {\n    var ad = getFirstAd(parsedXML);\n\n    if (Boolean(ad)) {\n      markAdAsRequested(ad);\n\n      return ad;\n    }\n\n    throw new Error('No Ad');\n  } catch (error) {\n    error.code = 303;\n    throw error;\n  }\n};\n\nvar validateResponse = function validateResponse(_ref3, _ref4) {\n  var ad = _ref3.ad,\n      parsedXML = _ref3.parsedXML;\n  var _ref4$allowMultipleAd = _ref4.allowMultipleAds,\n      allowMultipleAds = _ref4$allowMultipleAd === undefined ? true : _ref4$allowMultipleAd,\n      _ref4$followAdditiona = _ref4.followAdditionalWrappers,\n      followAdditionalWrappers = _ref4$followAdditiona === undefined ? true : _ref4$followAdditiona;\n\n  if (!isWrapper(ad) && !isInline(ad)) {\n    var error = new Error('Invalid VAST, ad contains neither Wrapper nor Inline');\n\n    error.code = 101;\n    throw error;\n  }\n\n  if (hasAdPod(parsedXML) && !allowMultipleAds) {\n    var _error = new Error('Multiple ads are not allowed');\n\n    _error.code = 203;\n    throw _error;\n  }\n\n  if (isWrapper(ad) && !followAdditionalWrappers) {\n    var _error2 = new Error('To follow additional wrappers is not allowed');\n\n    _error2.code = 200;\n    throw _error2;\n  }\n};\n\nvar getOptions = function getOptions(vastChain, options) {\n  var parentAd = vastChain[0];\n  var parentAdIsWrapper = Boolean(parentAd) && isWrapper(parentAd.ad);\n  var wrapperOptions = parentAdIsWrapper ? getWrapperOptions(parentAd.ad) : {};\n\n  return _extends({}, wrapperOptions, options);\n};\n\n// eslint-disable-next-line jsdoc/check-tag-names\n/**\n * @function requestAd\n *\n * @memberof module:@mailonline/video-ad-sdk\n * @async\n * @static\n * @description Request the ad using the passed ad tag and returns an array with the [VAST responses]{@link VastResponse} needed to get an inline ad.\n *\n * @param {string} adTag - The VAST ad tag request url.\n * @param {Object} options - Options Map. The allowed properties are:\n * @param {number} [options.wrapperLimit] - Sets the maximum number of wrappers allowed in the {@link VastChain}.\n *  Defaults to `5`.\n * @param {boolean} [options.AllowMultipleAds] - Boolean to indicate whether adPods are allowed or not.\n *  Defaults to `true`.\n * @param {number} [options.timeout] - timeout number in milliseconds. If set, the request will timeout if it is not fulfilled before the specified time.\n * @param {VastChain} [vastChain] - Optional vastChain with the previous VAST responses.\n * @returns {Promise.<VastChain>} - Returns a Promise that will resolve with a VastChain with the newest VAST response at the beginning of the array.\n * If the {@link VastChain} had an error. The first VAST response of the array will contain an error and an errorCode entry.\n */\nvar requestAd = function () {\n  var _ref5 = asyncToGenerator( /*#__PURE__*/regenerator.mark(function _callee2(adTag, options) {\n    var vastChain = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n    var VASTAdResponse, opts, epoch, timeout, fetchPromise;\n    return regenerator.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            VASTAdResponse = {\n              ad: null,\n              errorCode: null,\n              parsedXML: null,\n              requestTag: adTag,\n              XML: null\n            };\n            opts = void 0;\n            epoch = void 0;\n            timeout = void 0;\n            _context2.prev = 4;\n\n            opts = getOptions(vastChain, options);\n            validateChain(vastChain, opts);\n\n            fetchPromise = fetchAdXML(adTag, opts);\n\n\n            if (typeof opts.timeout === 'number') {\n              timeout = opts.timeout;\n              epoch = Date.now();\n              fetchPromise = Promise.race([fetchPromise, new Promise(function (resolve, reject) {\n                setTimeout(function () {\n                  var error = new Error('RequestAd timeout');\n\n                  error.code = 301;\n                  reject(error);\n                }, timeout);\n              })]);\n            }\n\n            _context2.next = 11;\n            return fetchPromise;\n\n          case 11:\n            VASTAdResponse.XML = _context2.sent;\n\n            VASTAdResponse.parsedXML = parseVastXml(VASTAdResponse.XML);\n            VASTAdResponse.ad = getAd(VASTAdResponse.parsedXML);\n\n            validateResponse(VASTAdResponse, opts);\n\n            if (!isWrapper(VASTAdResponse.ad)) {\n              _context2.next = 18;\n              break;\n            }\n\n            if (epoch) {\n              timeout -= Date.now() - epoch;\n            }\n\n            return _context2.abrupt('return', requestAd(getVASTAdTagURI(VASTAdResponse.ad), _extends({}, opts, {\n              timeout: timeout\n            }), [VASTAdResponse].concat(toConsumableArray(vastChain))));\n\n          case 18:\n            return _context2.abrupt('return', [VASTAdResponse].concat(toConsumableArray(vastChain)));\n\n          case 21:\n            _context2.prev = 21;\n            _context2.t0 = _context2['catch'](4);\n\n            /* istanbul ignore if */\n            if (!Number.isInteger(_context2.t0.code)) {\n              _context2.t0.code = 900;\n            }\n\n            VASTAdResponse.errorCode = _context2.t0.code;\n            VASTAdResponse.error = _context2.t0;\n\n            return _context2.abrupt('return', [VASTAdResponse].concat(toConsumableArray(vastChain)));\n\n          case 27:\n          case 'end':\n            return _context2.stop();\n        }\n      }\n    }, _callee2, _this$7, [[4, 21]]);\n  }));\n\n  return function requestAd(_x3, _x4) {\n    return _ref5.apply(this, arguments);\n  };\n}();\n\nvar getNextPod = function getNextPod(currentPod, ads) {\n  var nextPodSequence = getPodAdSequence(currentPod) + 1;\n\n  return ads.find(function (ad) {\n    return getPodAdSequence(ad) === nextPodSequence;\n  }) || null;\n};\n\nvar getNextAd = function getNextAd(_ref, _ref2) {\n  var ad = _ref.ad,\n      parsedXML = _ref.parsedXML;\n  var _ref2$fallbackOnNoAd = _ref2.fallbackOnNoAd,\n      fallbackOnNoAd = _ref2$fallbackOnNoAd === undefined ? true : _ref2$fallbackOnNoAd,\n      _ref2$useAdBuffet = _ref2.useAdBuffet,\n      useAdBuffet = _ref2$useAdBuffet === undefined ? false : _ref2$useAdBuffet;\n\n  var ads = getAds(parsedXML);\n  var availableAds = ads.filter(function (adDefinition) {\n    return !hasAdBeenRequested(adDefinition);\n  });\n  var nextAd = null;\n\n  if (hasAdPod(parsedXML)) {\n    if (useAdBuffet) {\n      nextAd = availableAds.filter(function (adDefinition) {\n        return !isPodAd(adDefinition);\n      })[0];\n    }\n\n    if (!nextAd) {\n      nextAd = getNextPod(ad, availableAds);\n    }\n  } else if (availableAds.length > 0 && fallbackOnNoAd) {\n    nextAd = availableAds[0];\n  }\n\n  return nextAd;\n};\n\nvar validateChain$1 = function validateChain(VastChain) {\n  if (!Array.isArray(VastChain)) {\n    throw new TypeError('Invalid VAST chain');\n  }\n\n  if (VastChain.length === 0) {\n    throw new Error('No next ad to request');\n  }\n};\n\n// eslint-disable-next-line jsdoc/check-tag-names\n/**\n * @function requestNextAd\n *\n * @memberof module:@mailonline/video-ad-sdk\n * @async\n * @static\n * @description Requests the next ad in the VAST Chain.\n *\n * @param {VastChain} VastChain - Array of {@link VastResponse}.\n * @param {Object} options - Options Map. The allowed properties are:\n * @param {number} [options.wrapperLimit] - Sets the maximum number of wrappers allowed in the vastChain.\n *  Defaults to `5`.\n * @param {boolean} [options.AllowMultipleAds] - Boolean to indicate whether adPods are allowed or not.\n *  Defaults to `true`.\n * @param {tracker} [options.track] - optional function to track whatever errors occur during the loading.\n *  Defaults to `@mailonline/video-ad-tracker` track method.\n * @param {boolean} [options.useAdBuffet] - Specifies whether to use buffet ads from an ad pod if possible.\n *    If no buffet ad is available it will return the next ad in ad pod sequence.\n *    Set it to true if an ad from an adPod failed and you want to replace it with an ad from the ad buffet.\n *    Defaults to `false`.\n * @param {boolean} [options.fallbackOnNoAd] - tells the video player to select an ad from any stand-alone ads available.\n *    Note: if the {@link VastChain} contains an adPod this property will be ignored.\n *    Defaults to `true`.\n * @param {number} [options.timeout] - timeout number in milliseconds. If set, the request will timeout if it is not fulfilled before the specified time.\n *\n * @returns {Promise.<VastChain>}  - Returns a Promise that will resolve with a VastChain with the newest VAST response at the beginning of the array.\n * If the {@link VastChain} had an error. The first VAST response of the array will contain an error and an errorCode entry.\n */\nvar requestNextAd = function requestNextAd(VastChain, options) {\n  validateChain$1(VastChain);\n\n  var vastResponse = VastChain[0];\n  var nextAd = getNextAd(vastResponse, options);\n\n  if (Boolean(nextAd)) {\n    var newVastResponse = Object.assign({}, vastResponse, {\n      ad: nextAd\n    });\n    var newVastChain = [newVastResponse].concat(toConsumableArray(VastChain.slice(1)));\n\n    markAdAsRequested(nextAd);\n\n    if (isWrapper(nextAd)) {\n      return requestAd(getVASTAdTagURI(nextAd), options, newVastChain);\n    }\n\n    return Promise.resolve(newVastChain);\n  }\n\n  return requestNextAd(VastChain.slice(1), options);\n};\n\n/* eslint-disable filenames/match-regex */\nvar isIOS = function isIOS() {\n  return (/iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream\n  );\n};\n\nvar _this$8 = undefined;\n\nvar validateVastChain = function validateVastChain(vastChain, options) {\n  if (!vastChain || vastChain.length === 0) {\n    throw new Error('Invalid VastChain');\n  }\n\n  var lastVastResponse = vastChain[0];\n\n  if (Boolean(lastVastResponse.error)) {\n    throw lastVastResponse.error;\n  }\n\n  if (options.hooks && typeof options.hooks.validateVastResponse === 'function') {\n    options.hooks.validateVastResponse(vastChain);\n  }\n};\n\nvar callbackHandler = function callbackHandler(cb) {\n  return function () {\n    if (typeof cb === 'function') {\n      cb.apply(undefined, arguments);\n    }\n  };\n};\n\nvar getErrorCode = function getErrorCode(vastChain, error) {\n  return vastChain && vastChain[0] && vastChain[0].errorCode || error.code;\n};\nvar transformVastResponse = function transformVastResponse(vastChain, _ref) {\n  var hooks = _ref.hooks;\n\n  if (hooks && typeof hooks.transformVastResponse === 'function') {\n    return hooks.transformVastResponse(vastChain);\n  }\n\n  return vastChain;\n};\n\nvar waterfall = function () {\n  var _ref2 = asyncToGenerator( /*#__PURE__*/regenerator.mark(function _callee(fetchVastChain, placeholder, options, isCanceled) {\n    var vastChain, runEpoch, adUnit, opts, onAdStart, onError, onRunFinish, newEpoch, errorCode, tracker;\n    return regenerator.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            vastChain = void 0;\n            runEpoch = void 0;\n            adUnit = void 0;\n            opts = _extends({}, options);\n            onAdStart = opts.onAdStart, onError = opts.onError, onRunFinish = opts.onRunFinish;\n            _context.prev = 5;\n\n            if (typeof opts.timeout === 'number') {\n              runEpoch = Date.now();\n            }\n\n            _context.next = 9;\n            return fetchVastChain();\n\n          case 9:\n            vastChain = _context.sent;\n\n            if (!isCanceled()) {\n              _context.next = 13;\n              break;\n            }\n\n            onRunFinish();\n\n            return _context.abrupt('return');\n\n          case 13:\n\n            if (runEpoch) {\n              newEpoch = Date.now();\n\n\n              opts.timeout -= newEpoch - runEpoch;\n              runEpoch = newEpoch;\n            }\n\n            validateVastChain(vastChain, opts);\n\n            _context.next = 17;\n            return run(transformVastResponse(vastChain, opts), placeholder, _extends({}, opts));\n\n          case 17:\n            adUnit = _context.sent;\n\n            if (!isCanceled()) {\n              _context.next = 22;\n              break;\n            }\n\n            adUnit.cancel();\n            onRunFinish();\n\n            return _context.abrupt('return');\n\n          case 22:\n\n            adUnit.onError(onError);\n            adUnit.onFinish(onRunFinish);\n            onAdStart(adUnit);\n            _context.next = 37;\n            break;\n\n          case 27:\n            _context.prev = 27;\n            _context.t0 = _context['catch'](5);\n            errorCode = getErrorCode(vastChain, _context.t0);\n\n\n            if (Boolean(errorCode)) {\n              tracker = options.tracker;\n\n\n              trackError(vastChain, {\n                errorCode: errorCode,\n                tracker: tracker\n              });\n            }\n\n            onError(_context.t0);\n\n            if (!(vastChain && !isCanceled())) {\n              _context.next = 36;\n              break;\n            }\n\n            if (runEpoch) {\n              opts.timeout -= Date.now() - runEpoch;\n            }\n\n            waterfall(function () {\n              return requestNextAd(vastChain, opts);\n            }, placeholder, _extends({}, opts), isCanceled);\n\n            return _context.abrupt('return');\n\n          case 36:\n\n            onRunFinish();\n\n          case 37:\n          case 'end':\n            return _context.stop();\n        }\n      }\n    }, _callee, _this$8, [[5, 27]]);\n  }));\n\n  return function waterfall(_x, _x2, _x3, _x4) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\n/**\n * Will try to start one of the ads returned by the `adTag`. It will keep trying until it times out or it runs out of ads.\n *\n * @memberof module:@mailonline/video-ad-sdk\n * @static\n * @alias runWaterfall\n * @param {string} adTag - The VAST ad tag request url.\n * @param {HTMLElement} placeholder - placeholder element that will contain the video ad.\n * @param {Object} [options] - Options Map. The allowed properties are:\n * @param {HTMLVideoElement} [options.videoElement] - optional videoElement that will be used to play the ad.\n * @param {Console} [options.logger] - Optional logger instance. Must comply to the [Console interface]{@link https://developer.mozilla.org/es/docs/Web/API/Console}.\n * Defaults to `window.console`\n * @param {number} [options.wrapperLimit] - Sets the maximum number of wrappers allowed in the {@link VastChain}.\n *  Defaults to `5`.\n * @param {runWaterfall~onAdReady} [options.onAdReady] - will be called once the ad is ready with the ad unit.\n * @param {runWaterfall~onAdStart} [options.onAdStart] - will be called once the ad starts with the ad unit.\n * @param {runWaterfall~onError} [options.onError] - will be called if there is an error with the video ad with the error instance.\n * @param {runWaterfall~onRunFinish} [options.onRunFinish] - will be called whenever the ad run finishes.\n * @param {boolean} [options.viewability] - if true it will pause the ad whenever is not visible for the viewer.\n * Defaults to `false`\n * @param {boolean} [options.responsive] - if true it will resize the ad unit whenever the ad container changes sizes.\n * Defaults to `false`\n * @param {number} [options.timeout] - timeout number in milliseconds. If set, the video ad will time out if it doesn't start within the specified time.\n * @param {TrackerFn} [options.tracker] - If provided it will be used to track the VAST events instead of the default {@link pixelTracker}.\n * @param {Object} [options.hooks] - Optional map with hooks to configure the behaviour of the ad.\n * @param {Function} [options.hooks.createSkipControl] - If provided it will be called to generate the skip control. Must return a clickable [HTMLElement](https://developer.mozilla.org/es/docs/Web/API/HTMLElement) that is detached from the DOM.\n * @param {Function} [options.hooks.validateVastResponse] - If provided it will be called for each valid vast response. Must throw if there is a problem with the vast response. If the Error instance has an `errorCode` number then it will be tracked using the error macros in the Vast response. It will also call {@link runWaterfall~onError} with the thrown error.\n * @param {Function} [options.hooks.transformVastResponse] - If provided it will be called before building the adUnit allowing the modification of the vastResponse if needed.\n * @returns {Function} - Cancel function. If called it will cancel the ad run. {@link runWaterfall~onRunFinish} will still be called;\n */\nvar runWaterfall = function runWaterfall(adTag, placeholder, options) {\n  var canceled = false;\n  var adUnit = null;\n  var isCanceled = function isCanceled() {\n    return canceled;\n  };\n  var onAdStartHandler = callbackHandler(options.onAdStart);\n  var onAdStart = function onAdStart(newAdUnit) {\n    adUnit = newAdUnit;\n    onAdStartHandler(adUnit);\n  };\n  var opts = _extends({}, options, {\n    onAdReady: callbackHandler(options.onAdReady),\n    onAdStart: onAdStart,\n    onError: callbackHandler(options.onError),\n    onRunFinish: callbackHandler(options.onRunFinish)\n  });\n\n  if (options.videoElement && isIOS()) {\n    /*\n      It seems that if the video doesn't load synchronously inside a touchend or click event handler, the user gesture breaks on iOS and it won't allow a play.\n    */\n    options.videoElement.load();\n  }\n\n  waterfall(function () {\n    return requestAd(adTag, opts);\n  }, placeholder, opts, isCanceled);\n\n  return function () {\n    canceled = true;\n\n    if (adUnit && !adUnit.isFinished()) {\n      adUnit.cancel();\n    }\n  };\n};\n\n/**\n * @module @mailonline/video-ad-sdk\n * @description Video ad SDK to load and play HTML5 video ads.\n *\n */\n\nexport { run, runWaterfall, requestAd, requestNextAd };\n//# sourceMappingURL=main.esm.js.map\n","/* eslint-disable no-console, import/no-unassigned-import, import/no-unresolved */\nimport {runWaterfall} from '@mailonline/video-ad-sdk';\nimport './demo.css';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  const textArea = document.querySelector('#adTag');\n  const testBtn = document.querySelector('.vast-test-btn');\n  const videoElement = document.querySelector('.vast-media video');\n  const videoAdContainer = document.querySelector('.video-ad-container');\n  let adUnit;\n\n  const onAdReady = (newAdUnit) => {\n    adUnit = newAdUnit;\n    console.log('### onAdReady', adUnit);\n    const evtHandler = (evt) => console.log(`### ${evt.type}`, evt.adUnit);\n\n    [\n      'pause',\n      'resume',\n      'finish',\n      'impression',\n      'start',\n      'skip',\n      'firstQuartile',\n      'midpoint',\n      'thirdQuartile',\n      'complete'\n    ].forEach((evtType) => {\n      adUnit.on(evtType, evtHandler);\n    });\n  };\n  const requestAdRun = () => {\n    const adTag = textArea.value;\n    const src = videoElement.src;\n    const resumeContent = () => {\n      videoElement.play();\n\n      videoElement.removeEventListener('contentloadedmetadata', resumeContent);\n      videoElement.removeEventListener('canplay', resumeContent);\n    };\n    const onError = (evt) => {\n      console.log('### onError', evt);\n    };\n    const onRunFinish = (evt) => {\n      console.log('### onRunFinish', evt);\n      videoAdContainer.classList.remove('active');\n\n      if (videoElement.src === src) {\n        videoElement.play();\n      } else {\n        videoElement.addEventListener('contentloadedmetadata', resumeContent);\n        videoElement.addEventListener('canplay', resumeContent);\n        videoElement.src = src;\n        videoElement.load();\n      }\n    };\n\n    videoAdContainer.classList.add('active');\n    videoElement.pause();\n    videoElement.currentTime = 0;\n\n    console.log('### adTag', adTag);\n\n    runWaterfall(adTag, videoAdContainer, {\n      onAdReady,\n      onError,\n      onRunFinish,\n      timeout: 15000,\n      videoElement\n    });\n  };\n\n  textArea.addEventListener('change', () => {\n    const adTag = textArea.value;\n\n    if (adTag) {\n      testBtn.classList.add('active');\n      testBtn.addEventListener('click', requestAdRun);\n    } else {\n      testBtn.classList.remove('active');\n      testBtn.removeEventListener('click', requestAdRun);\n    }\n  });\n});\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n"],"sourceRoot":""}